<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>花指令与脱壳入门 | The Blog of Monoceros406</title><meta name="author" content="Monoceros406"><meta name="copyright" content="Monoceros406"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="花指令与脱壳入门做题[HNCTF 2022 WEEK2]e@sy_flower花指令 选中红色行号内容，P（编辑-&gt;函数-&gt;新建函数），可反编译 找到JUMPOUT爆红，编辑-&gt;修补程序-&gt;单字节更改 第一个字节改为$09$ 逆向得flag 咳(NewStarCTF2023)脱壳，简单逆向 12345678910111213#include &lt;cstdio&gt;#i">
<meta property="og:type" content="article">
<meta property="og:title" content="花指令与脱壳入门">
<meta property="og:url" content="https://monoceros406.github.io/2024/03/10/%E8%8A%B1%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%84%B1%E5%A3%B3%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="The Blog of Monoceros406">
<meta property="og:description" content="花指令与脱壳入门做题[HNCTF 2022 WEEK2]e@sy_flower花指令 选中红色行号内容，P（编辑-&gt;函数-&gt;新建函数），可反编译 找到JUMPOUT爆红，编辑-&gt;修补程序-&gt;单字节更改 第一个字节改为$09$ 逆向得flag 咳(NewStarCTF2023)脱壳，简单逆向 12345678910111213#include &lt;cstdio&gt;#i">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://monoceros406.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2024-03-10T02:58:54.000Z">
<meta property="article:modified_time" content="2024-03-10T03:39:24.066Z">
<meta property="article:author" content="Monoceros406">
<meta property="article:tag" content="逆向工程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://monoceros406.github.io/img/avatar.jpg"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="https://monoceros406.github.io/2024/03/10/%E8%8A%B1%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%84%B1%E5%A3%B3%E5%85%A5%E9%97%A8/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '花指令与脱壳入门',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-10 11:39:24'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="The Blog of Monoceros406" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">303</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://t.alcy.cc/ycy')"><nav id="nav"><span id="blog-info"><a href="/" title="The Blog of Monoceros406"><span class="site-name">The Blog of Monoceros406</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">花指令与脱壳入门</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-10T02:58:54.000Z" title="发表于 2024-03-10 10:58:54">2024-03-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-10T03:39:24.066Z" title="更新于 2024-03-10 11:39:24">2024-03-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="花指令与脱壳入门"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="花指令与脱壳入门"><a href="#花指令与脱壳入门" class="headerlink" title="花指令与脱壳入门"></a>花指令与脱壳入门</h1><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><h3 id="HNCTF-2022-WEEK2-e-sy-flower"><a href="#HNCTF-2022-WEEK2-e-sy-flower" class="headerlink" title="[HNCTF 2022 WEEK2]e@sy_flower"></a>[HNCTF 2022 WEEK2]e@sy_flower</h3><p><strong>花指令</strong></p>
<p>选中红色行号内容，P（编辑-&gt;函数-&gt;新建函数），可反编译</p>
<p>找到JUMPOUT爆红，编辑-&gt;修补程序-&gt;单字节更改 第一个字节改为$09$</p>
<p>逆向得flag</p>
<h3 id="咳-NewStarCTF2023"><a href="#咳-NewStarCTF2023" class="headerlink" title="咳(NewStarCTF2023)"></a>咳(NewStarCTF2023)</h3><p>脱壳，简单逆向</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">char</span> str[]=<span class="string">&quot;gmbh|D1ohsbuv2bu21ot1oQb332ohUifG2stuQ[HBMBYZ2fwf2~&quot;</span>;</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    len=<span class="built_in">strlen</span>(str);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">        str[i]--;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,str[i]);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="GFCTF-2021-wordy"><a href="#GFCTF-2021-wordy" class="headerlink" title="[GFCTF 2021]wordy"></a>[GFCTF 2021]wordy</h3><p><strong>花指令</strong></p>
<blockquote>
<p>There are moments in life when you miss someone so much that you just want to pick them from your dreams and hug them for real! Dream what you want to dream;go where you want to go;be what you want to be,because you have only one life and one chance to do all the things you want to do.<br>May you have enough happiness to make you sweet,enough trials to make you strong,enough sorrow to keep you human,enough hope to make you happy? Always put yourself in others’shoes.If you feel that it hurts you,it probably hurts the other person, too.</p>
</blockquote>
<p>发现花指令，exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x1135</span>,<span class="number">0x3100</span>):</span><br><span class="line">    <span class="keyword">if</span> (get_wide_byte(i)==<span class="number">0xeb</span>)<span class="keyword">and</span>(get_wide_byte(i+<span class="number">1</span>)==<span class="number">0xff</span>):</span><br><span class="line">        patch_byte(i,<span class="number">0x90</span>)</span><br></pre></td></tr></table></figure>

<p>反汇编发现没有flag，原来是jz走了…，patch为0x90，得flag</p>
<h3 id="HZNUCTF-2023-final-虽然他送了我玫瑰花"><a href="#HZNUCTF-2023-final-虽然他送了我玫瑰花" class="headerlink" title="[HZNUCTF 2023 final]虽然他送了我玫瑰花"></a>[HZNUCTF 2023 final]虽然他送了我玫瑰花</h3><p>花指令+自定义加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0x7F</span>,<span class="number">0x7E</span>,<span class="number">0x51</span>,<span class="number">0xCE</span>,<span class="number">0xFB</span>,<span class="number">0x4E</span>,<span class="number">0x7A</span>,<span class="number">0x24</span>,<span class="number">0xE8</span>,<span class="number">0xDF</span>,<span class="number">0x59</span>,<span class="number">0x71</span>,<span class="number">0x26</span>,<span class="number">0xCA</span>,<span class="number">0xE1</span>,<span class="number">0x6C</span>,<span class="number">0x86</span>,<span class="number">0x21</span>,<span class="number">0xcc</span>,<span class="number">0xf5</span>,<span class="number">0x28</span>,<span class="number">0x71</span>,<span class="number">0x14</span>,<span class="number">0xd8</span>,<span class="number">0xef</span>,<span class="number">0x6e</span>,<span class="number">0x77</span>,<span class="number">0x62</span>,<span class="number">0xFA</span>]</span><br><span class="line">org=[<span class="number">0</span>]*<span class="built_in">len</span>(enc)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decry</span>(<span class="params">opt,v</span>):</span><br><span class="line">    <span class="keyword">if</span> opt==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> v^<span class="number">0x19</span></span><br><span class="line">    <span class="keyword">if</span> opt==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> v-<span class="number">0x12</span></span><br><span class="line">    <span class="keyword">if</span> opt==<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> v+<span class="number">0x10</span></span><br><span class="line">    <span class="keyword">if</span> opt==<span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> v//<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> v^(v^~v)&amp;<span class="number">0x80</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">29</span>):</span><br><span class="line">    org[i]=decry(i%<span class="number">5</span>,enc[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(org)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(org[i]&amp;<span class="number">0x7f</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="MoeCTF-2022-Art"><a href="#MoeCTF-2022-Art" class="headerlink" title="[MoeCTF 2022]Art"></a>[MoeCTF 2022]Art</h3><p>UPX脱壳，DFS爆破，exp：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> enc[<span class="number">28</span>]=&#123;<span class="number">0x02</span>,<span class="number">0x18</span>,<span class="number">0x0F</span>,<span class="number">0xF8</span>,<span class="number">0x19</span>,<span class="number">0x04</span>,<span class="number">0x27</span>,<span class="number">0xD8</span>,<span class="number">0xEB</span>,<span class="number">0x00</span>,<span class="number">0x35</span>,<span class="number">0x48</span>,<span class="number">0x4D</span>,<span class="number">0x2A</span>,<span class="number">0x45</span>,<span class="number">0x6B</span>,<span class="number">0x59</span>,<span class="number">0x2E</span>,<span class="number">0x43</span>,<span class="number">0x01</span>,<span class="number">0x18</span>,<span class="number">0x5C</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0x09</span>,<span class="number">0xB5</span>,<span class="number">0x7D</span>&#125;,rec[<span class="number">28</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">27</span>;i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,rec[i]);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">32</span>;i&lt;<span class="number">128</span>;i++)</span><br><span class="line">        <span class="keyword">if</span>(((i%<span class="number">0x11</span>+rec[k+<span class="number">1</span>])^<span class="number">0x19</span>^i)==enc[k])&#123;</span><br><span class="line">            rec[k]=i;</span><br><span class="line">            <span class="built_in">dfs</span>(k<span class="number">-1</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    rec[<span class="number">27</span>]=enc[<span class="number">27</span>];</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">26</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="GKCTF-2021-QQQQT"><a href="#GKCTF-2021-QQQQT" class="headerlink" title="[GKCTF 2021]QQQQT"></a>[GKCTF 2021]QQQQT</h3><p>拿C++写的QT。查壳发现Enigma Vitual Box虚拟化，用EnigmaVBUnpacker脱壳。</p>
<p>丢IDA很抽象，从字符串入手，发现Base58表和密文，解密得。</p>
<h3 id="HZNUCTF-2023-final-signin"><a href="#HZNUCTF-2023-final-signin" class="headerlink" title="[HZNUCTF 2023 final]signin"></a>[HZNUCTF 2023 final]signin</h3><p>手修UPX特征，首先为区段UPX0和UPX1，一堆0后面是5Byte的版本号，之后4Byte为UPX Tag，改为‘UPX!’。</p>
<p>标准RC4解密。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input:42FD5561B9276FF5B68623A9EF1C049FD41687D65468BC02156D30084B614C5E</span><br><span class="line">From_Hex(&#x27;Auto&#x27;)</span><br><span class="line">RC4(&#123;&#x27;option&#x27;:&#x27;UTF8&#x27;,&#x27;string&#x27;:&#x27;justfortest&#x27;&#125;,&#x27;Latin1&#x27;,&#x27;Latin1&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="SWPUCTF-2023-秋季新生赛-Junk-Code"><a href="#SWPUCTF-2023-秋季新生赛-Junk-Code" class="headerlink" title="[SWPUCTF 2023 秋季新生赛]Junk Code"></a>[SWPUCTF 2023 秋季新生赛]Junk Code</h3><p>一堆花指令，修得真麻烦。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;NRQ@PC&#125;Vdn4tHV4Yi9cd#\\&#125;jsXz3LMuaaY0&#125;nj]`4a5&amp;WoB4glB7~u&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[i])^(i%<span class="number">9</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="MoeCTF-2021-clothes"><a href="#MoeCTF-2021-clothes" class="headerlink" title="[MoeCTF 2021]clothes"></a>[MoeCTF 2021]clothes</h3><p>Aspack壳，Aspack Stripper脱掉即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0x73</span>,<span class="number">0x45</span>,<span class="number">0x2B</span>,<span class="number">0x47</span>,<span class="number">0x57</span>,<span class="number">0x69</span>,<span class="number">0x53</span>,<span class="number">0x0D</span>,<span class="number">0x44</span>,<span class="number">0x4C</span>,<span class="number">0x2E</span>,<span class="number">0x2F</span>,<span class="number">0x05</span>,<span class="number">0x6A</span>,<span class="number">0x13</span>,<span class="number">0x4D</span>,<span class="number">0x57</span>,<span class="number">0x31</span>,<span class="number">0x4B</span>,<span class="number">0x22</span>,<span class="number">0x58</span>,<span class="number">0x06</span>,<span class="number">0x49</span>,<span class="number">0x71</span>,<span class="number">0x4C</span>,<span class="number">0x6A</span>,<span class="number">0x32</span>,<span class="number">0x64</span>,<span class="number">0x18</span>,<span class="number">0x45</span>]</span><br><span class="line">key=[<span class="number">0x1E</span>,<span class="number">0x2A</span>,<span class="number">0x4E</span>,<span class="number">0x24</span>,<span class="number">0x23</span>,<span class="number">0x0F</span>,<span class="number">0x28</span>,<span class="number">0x39</span>,<span class="number">0x71</span>,<span class="number">0x3C</span>,<span class="number">0x4F</span>,<span class="number">0x4C</span>,<span class="number">0x6E</span>,<span class="number">0x35</span>,<span class="number">0x22</span>,<span class="number">0x3E</span>,<span class="number">0x08</span>,<span class="number">0x02</span>,<span class="number">0x31</span>,<span class="number">0x7D</span>,<span class="number">0x2C</span>,<span class="number">0x36</span>,<span class="number">0x16</span>,<span class="number">0x04</span>,<span class="number">0x22</span>,<span class="number">0x1A</span>,<span class="number">0x53</span>,<span class="number">0x07</span>,<span class="number">0x73</span>,<span class="number">0x38</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(enc[i]^key[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://monoceros406.github.io">Monoceros406</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://monoceros406.github.io/2024/03/10/%E8%8A%B1%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%84%B1%E5%A3%B3%E5%85%A5%E9%97%A8/">https://monoceros406.github.io/2024/03/10/%E8%8A%B1%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%84%B1%E5%A3%B3%E5%85%A5%E9%97%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://monoceros406.github.io" target="_blank">The Blog of Monoceros406</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/">逆向工程</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/10/%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3%E4%B8%8E%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%9C%A8%E9%80%86%E5%90%91%E4%B8%AD%E5%BA%94%E7%94%A8/" title="约束求解与符号执行在逆向中应用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">约束求解与符号执行在逆向中应用</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/10/%E8%B5%B0%E8%BF%B7%E5%AE%AB%E4%B8%8E%E6%95%B0%E7%8B%AC%E9%80%86%E5%90%91%E9%A2%98%E7%9B%AE%E5%B0%8F%E7%BB%93/" title="走迷宫与数独逆向题目小结"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">走迷宫与数独逆向题目小结</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/11/16/Angr%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/" title="Angr做题笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-16</div><div class="title">Angr做题笔记</div></div></a></div><div><a href="/2023/10/29/Angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E7%AC%94%E8%AE%B0/" title="Angr符号执行笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-29</div><div class="title">Angr符号执行笔记</div></div></a></div><div><a href="/2024/01/13/Artfuscator%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" title="Artfuscator使用方法"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-13</div><div class="title">Artfuscator使用方法</div></div></a></div><div><a href="/2023/11/09/C-%E7%97%85%E6%AF%92%E6%8A%80%E6%9C%AF/" title="C++病毒技术"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-09</div><div class="title">C++病毒技术</div></div></a></div><div><a href="/2024/03/10/C-%E9%80%86%E5%90%91%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B/" title="C#逆向常见题型"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-10</div><div class="title">C#逆向常见题型</div></div></a></div><div><a href="/2024/01/28/CheatEngine%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" title="CheatEngine基本操作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-28</div><div class="title">CheatEngine基本操作</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Monoceros406</div><div class="author-info__description">智邮普创工作室安全组（退役）/Nepnep联合战队</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">303</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Monoceros406"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Monoceros406" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:monoceros406@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://monoceros406.github.io/atom.xml" target="_blank" title=""><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">哪里排版出锅了请告诉我QwQ  QQ:1295625063</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%8A%B1%E6%8C%87%E4%BB%A4%E4%B8%8E%E8%84%B1%E5%A3%B3%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">花指令与脱壳入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%81%9A%E9%A2%98"><span class="toc-number">1.1.</span> <span class="toc-text">做题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HNCTF-2022-WEEK2-e-sy-flower"><span class="toc-number">1.1.1.</span> <span class="toc-text">[HNCTF 2022 WEEK2]e@sy_flower</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%92%B3-NewStarCTF2023"><span class="toc-number">1.1.2.</span> <span class="toc-text">咳(NewStarCTF2023)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GFCTF-2021-wordy"><span class="toc-number">1.1.3.</span> <span class="toc-text">[GFCTF 2021]wordy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HZNUCTF-2023-final-%E8%99%BD%E7%84%B6%E4%BB%96%E9%80%81%E4%BA%86%E6%88%91%E7%8E%AB%E7%91%B0%E8%8A%B1"><span class="toc-number">1.1.4.</span> <span class="toc-text">[HZNUCTF 2023 final]虽然他送了我玫瑰花</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MoeCTF-2022-Art"><span class="toc-number">1.1.5.</span> <span class="toc-text">[MoeCTF 2022]Art</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GKCTF-2021-QQQQT"><span class="toc-number">1.1.6.</span> <span class="toc-text">[GKCTF 2021]QQQQT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HZNUCTF-2023-final-signin"><span class="toc-number">1.1.7.</span> <span class="toc-text">[HZNUCTF 2023 final]signin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SWPUCTF-2023-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B-Junk-Code"><span class="toc-number">1.1.8.</span> <span class="toc-text">[SWPUCTF 2023 秋季新生赛]Junk Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MoeCTF-2021-clothes"><span class="toc-number">1.1.9.</span> <span class="toc-text">[MoeCTF 2021]clothes</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/07/OpenSSL%E5%85%A5%E9%97%A8-%E6%9D%82%E5%87%91%E5%87%BD%E6%95%B0/" title="OpenSSL入门-杂凑函数">OpenSSL入门-杂凑函数</a><time datetime="2024-12-07T13:20:16.000Z" title="发表于 2024-12-07 21:20:16">2024-12-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/05/WindowsAPI%E7%BC%96%E7%A8%8B%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF-%E5%86%85%E6%A0%B8%E6%9E%9A%E4%B8%BE/" title="WindowsAPI编程核心技术-内核枚举">WindowsAPI编程核心技术-内核枚举</a><time datetime="2024-12-05T01:34:52.000Z" title="发表于 2024-12-05 09:34:52">2024-12-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/30/Windows%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8-%E5%AE%89%E5%85%A8%E8%BF%9B%E9%98%B6/" title="Windows驱动开发入门-安全进阶">Windows驱动开发入门-安全进阶</a><time datetime="2024-11-30T08:52:59.000Z" title="发表于 2024-11-30 16:52:59">2024-11-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/29/UEFI%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8-%E5%9B%BE%E5%BD%A2%E4%B8%8E%E6%96%87%E5%AD%97%E6%98%BE%E7%A4%BA/" title="UEFI编程入门-图形与文字显示">UEFI编程入门-图形与文字显示</a><time datetime="2024-11-29T00:55:25.000Z" title="发表于 2024-11-29 08:55:25">2024-11-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/28/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" title="机器学习入门">机器学习入门</a><time datetime="2024-11-28T07:06:20.000Z" title="发表于 2024-11-28 15:06:20">2024-11-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Monoceros406</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="docsearch-wrap"><div id="docsearch" style="display:none"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css/dist/style.min.css"/><script src="https://cdn.jsdelivr.net/npm/@docsearch/js/dist/umd/index.min.js"></script><script>(() => {
  docsearch(Object.assign({
    appId: '',
    apiKey: '',
    indexName: '',
    container: '#docsearch',
  }, null))

  const handleClick = () => {
    document.querySelector('.DocSearch-Button').click()
  }

  const searchClickFn = () => {
    btf.addEventListenerPjax(document.querySelector('#search-button > .search'), 'click', handleClick)
  }

  searchClickFn()
  window.addEventListener('pjax:complete', searchClickFn)
})()</script></div></div></body></html>