<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>算法竞赛笔记 | The Blog of Monoceros406</title><meta name="author" content="Monoceros406"><meta name="copyright" content="Monoceros406"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="算法竞赛笔记快速幂$\Theta(\log n)$ 1234567891011int fp(const int a,const int b,const int m)&amp;#123;	int ret&#x3D;1;	a%&#x3D;m;	while(b!&#x3D;0)&amp;#123;		if((b&amp;1)&#x3D;&#x3D;1)			ret&#x3D;(ret*a)%m;		a&#x3D;(a*a)%m,		b&gt;&gt;&#x3D;1;	&amp;#125;;	return">
<meta property="og:type" content="article">
<meta property="og:title" content="算法竞赛笔记">
<meta property="og:url" content="https://monoceros406.github.io/2023/10/15/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="The Blog of Monoceros406">
<meta property="og:description" content="算法竞赛笔记快速幂$\Theta(\log n)$ 1234567891011int fp(const int a,const int b,const int m)&amp;#123;	int ret&#x3D;1;	a%&#x3D;m;	while(b!&#x3D;0)&amp;#123;		if((b&amp;1)&#x3D;&#x3D;1)			ret&#x3D;(ret*a)%m;		a&#x3D;(a*a)%m,		b&gt;&gt;&#x3D;1;	&amp;#125;;	return">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://monoceros406.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2023-10-15T12:28:25.000Z">
<meta property="article:modified_time" content="2024-04-05T12:57:56.004Z">
<meta property="article:author" content="Monoceros406">
<meta property="article:tag" content="算法">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://monoceros406.github.io/img/avatar.jpg"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="https://monoceros406.github.io/2023/10/15/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '算法竞赛笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-05 20:57:56'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="The Blog of Monoceros406" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">326</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">30</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://t.alcy.cc/ycy')"><nav id="nav"><span id="blog-info"><a href="/" title="The Blog of Monoceros406"><span class="site-name">The Blog of Monoceros406</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">算法竞赛笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-15T12:28:25.000Z" title="发表于 2023-10-15 20:28:25">2023-10-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-05T12:57:56.004Z" title="更新于 2024-04-05 20:57:56">2024-04-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="算法竞赛笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="算法竞赛笔记"><a href="#算法竞赛笔记" class="headerlink" title="算法竞赛笔记"></a>算法竞赛笔记</h1><h2 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h2><p>$\Theta(\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">fp</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b,<span class="type">const</span> <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">1</span>;</span><br><span class="line">	a%=m;</span><br><span class="line">	<span class="keyword">while</span>(b!=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>((b&amp;<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">			ret=(ret*a)%m;</span><br><span class="line">		a=(a*a)%m,</span><br><span class="line">		b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="龟速乘"><a href="#龟速乘" class="headerlink" title="龟速乘"></a>龟速乘</h2><p>$O(\log m)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">sm</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b,<span class="type">const</span> <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(b!=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>((b&amp;<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">			ret=(ret+a)%m;</span><br><span class="line">		a=(a&lt;&lt;<span class="number">1</span>)%m,</span><br><span class="line">		b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><p>$\Omega(n\log n)\qquad\Theta(n\log n)\qquad O(n^2)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[N+<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">qs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> begin,<span class="type">const</span> <span class="type">int</span> end)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> k=a[(begin+end)&gt;&gt;<span class="number">1</span>],left=begin,right=end;</span><br><span class="line">	<span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">		<span class="keyword">while</span>((a[left]&lt;t)&amp;&amp;(left&lt;end))</span><br><span class="line">			left++;</span><br><span class="line">		<span class="keyword">while</span>((a[right]&gt;t)&amp;&amp;(right&gt;begin))</span><br><span class="line">			right--;</span><br><span class="line">		<span class="keyword">if</span>(left&lt;=right)</span><br><span class="line">			a[left]^=a[right]^=a[left]^=a[right],</span><br><span class="line">			left++,</span><br><span class="line">			right--;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(left&lt;end)</span><br><span class="line">		<span class="built_in">qs</span>(left,end);</span><br><span class="line">	<span class="keyword">if</span>(right&gt;begin)</span><br><span class="line">		<span class="built_in">qs</span>(begin,right);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="差分"><a href="#差分" class="headerlink" title="差分"></a>差分</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,m,a[N+<span class="number">1</span>],t1,t2,t3,f[N+<span class="number">1</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;t1,&amp;t2,&amp;t3);</span><br><span class="line">	f[t1]+=t3,</span><br><span class="line">	f[t2+<span class="number">1</span>]-=t3;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;n;f[i]+=f[i<span class="number">-1</span>],i++);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]+f[i]);</span><br></pre></td></tr></table></figure>

<h2 id="离散化"><a href="#离散化" class="headerlink" title="离散化"></a>离散化</h2><p>unique:$O(n)$<br>lower_bound:$O(\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memcpy</span>(b,a,<span class="built_in">sizeof</span>(a));</span><br><span class="line"><span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);</span><br><span class="line">m=<span class="built_in">unique</span>(b,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+m+<span class="number">1</span>,a[i])-b);</span><br></pre></td></tr></table></figure>

<h2 id="前缀和"><a href="#前缀和" class="headerlink" title="前缀和"></a>前缀和</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,m,a[N+<span class="number">1</span>],x,y;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;n;a[i]+=a[i<span class="number">-1</span>],i++);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,a[y]-a[x<span class="number">-1</span>]);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="高精度"><a href="#高精度" class="headerlink" title="高精度"></a>高精度</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN=...;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">bignum</span>&#123;</span><br><span class="line">	<span class="type">int</span> len,s[MAXN];</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="title">bignum</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">		len=<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">memset</span>(s,<span class="number">0</span>,<span class="built_in">sizeof</span>(s));</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	bignum <span class="keyword">operator</span>=(<span class="type">const</span> <span class="type">char</span>* num)&#123;</span><br><span class="line">		len=<span class="built_in">strlen</span>(num);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">			s[i]=num[len-i<span class="number">-1</span>]-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> bignum <span class="keyword">operator</span>=(<span class="type">const</span> <span class="type">int</span> num)&#123;</span><br><span class="line">		<span class="type">char</span> a[MAXN];</span><br><span class="line">		<span class="built_in">sprintf</span>(a,<span class="string">&quot;%d&quot;</span>,num);</span><br><span class="line">		*<span class="keyword">this</span>=a;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="title">bignum</span><span class="params">(<span class="type">const</span> <span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">		*<span class="keyword">this</span>=num;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="title">bignum</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* num)</span></span>&#123;</span><br><span class="line">		*<span class="keyword">this</span>=num;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	bignum <span class="keyword">operator</span>+(<span class="type">const</span> bignum &amp;a)&#123;</span><br><span class="line">		bignum c;</span><br><span class="line">		<span class="type">int</span> x=<span class="number">0</span>;</span><br><span class="line">		c.len=<span class="built_in">max</span>(len,a.len)+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;c.len;i++)</span><br><span class="line">			c.s[i]=s[i]+a.s[i]+x,</span><br><span class="line">			x=c.s[i]/<span class="number">10</span>,</span><br><span class="line">			c.s[i]%=<span class="number">10</span>;</span><br><span class="line">		<span class="keyword">if</span>(c.s[c.len<span class="number">-1</span>]==<span class="number">0</span>)</span><br><span class="line">			c.len--;</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> bignum <span class="keyword">operator</span>+=(<span class="type">const</span> bignum &amp;a)&#123;</span><br><span class="line">		*<span class="keyword">this</span>=*<span class="keyword">this</span>+a;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	bignum <span class="keyword">operator</span>*(<span class="type">const</span> bignum &amp;a)&#123;</span><br><span class="line">		bignum c;</span><br><span class="line">		c.len=len+a.len;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;a.len;j++)</span><br><span class="line">				c.s[i+j]+=s[i]*a.s[j],</span><br><span class="line">				c.s[i+j+<span class="number">1</span>]+=c.s[i+j]/<span class="number">10</span>,</span><br><span class="line">				c.s[i+j]%=<span class="number">10</span>;</span><br><span class="line">		<span class="keyword">if</span>(c.s[c.len<span class="number">-1</span>]==<span class="number">0</span>)</span><br><span class="line">			c.len--;</span><br><span class="line">		<span class="keyword">return</span> c;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> bignum <span class="keyword">operator</span>*=(<span class="type">const</span> bignum &amp;a)&#123;</span><br><span class="line">		*<span class="keyword">this</span>=*<span class="keyword">this</span>*a;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> bignum &amp;x)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(len!=x.len)</span><br><span class="line">			<span class="keyword">return</span> len&lt;x.len;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=len<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">			<span class="keyword">if</span>(s[i]!=x.s[i])</span><br><span class="line">				<span class="keyword">return</span> s[i]&lt;x.s[i];</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&gt;(<span class="type">const</span> bignum &amp;x)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> x&lt;*<span class="keyword">this</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;=(<span class="type">const</span> bignum &amp;x)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> !(*<span class="keyword">this</span>&gt;x);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&gt;=(<span class="type">const</span> bignum &amp;x)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> !(*<span class="keyword">this</span>&lt;x);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> bignum &amp;x)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> !((*<span class="keyword">this</span>&lt;x)||(*<span class="keyword">this</span>&gt;x));</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>!=(<span class="type">const</span> bignum &amp;x)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="built_in">return</span> (*<span class="keyword">this</span>&lt;x)||(*<span class="keyword">this</span>&gt;x);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream &amp;out,<span class="type">const</span> bignum &amp;num)&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=num.len<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		cout&lt;&lt;num.s[i];</span><br><span class="line">	<span class="keyword">return</span> out;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">inline</span> istream&amp; <span class="keyword">operator</span>&gt;&gt;(istream &amp;in,bignum &amp;a)&#123;</span><br><span class="line">	<span class="type">char</span> num[MAXN];</span><br><span class="line">	in&gt;&gt;num;</span><br><span class="line">	a=num;</span><br><span class="line">	<span class="keyword">return</span> in;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="莫队算法"><a href="#莫队算法" class="headerlink" title="莫队算法"></a>莫队算法</h2><p>$O(n^{\frac{3}{2}})$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">    <span class="type">int</span> l,r,id;</span><br><span class="line">&#125;qst[<span class="number">100001</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> data a,<span class="type">const</span> data b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.l/blck)==(b.l/blck)?a.r&lt;b.r:a.l&lt;b.l;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(++cnt[a[k]]==<span class="number">1</span>)</span><br><span class="line">        ans++;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dec</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(--cnt[a[k]]==<span class="number">0</span>)</span><br><span class="line">        ans--;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;q);</span><br><span class="line">    blck=<span class="built_in">sqrt</span>(n),</span><br><span class="line">    l=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;a[i++]=<span class="built_in">read</span>());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)</span><br><span class="line">        qst[i].l=<span class="built_in">read</span>(),</span><br><span class="line">        qst[i].r=<span class="built_in">read</span>(),</span><br><span class="line">        qst[i].id=i;</span><br><span class="line">    <span class="built_in">sort</span>(qst+<span class="number">1</span>,qst+q+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;qst[i].l)</span><br><span class="line">            <span class="built_in">dec</span>(l++);</span><br><span class="line">        <span class="keyword">while</span>(l&gt;qst[i].l)</span><br><span class="line">            <span class="built_in">add</span>(--l);</span><br><span class="line">        <span class="keyword">while</span>(r&lt;qst[i].r)</span><br><span class="line">            <span class="built_in">add</span>(++r);</span><br><span class="line">        <span class="keyword">while</span>(r&gt;qst[i].r)</span><br><span class="line">            <span class="built_in">dec</span>(r--);</span><br><span class="line">        <span class="keyword">if</span>(ans==qst[i].r-qst[i].l+<span class="number">1</span>)</span><br><span class="line">            tag[qst[i].id]=<span class="literal">true</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)</span><br><span class="line">        <span class="keyword">if</span>(tag[i]==<span class="literal">true</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Yes\n&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;No\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="分块"><a href="#分块" class="headerlink" title="分块"></a>分块</h2><p>$\Omega(1)\qquad O(\sqrt n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a&lt;b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">(<span class="type">const</span> <span class="type">int</span> p)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=l[pos[p]];i&lt;=r[pos[p]];i++)</span><br><span class="line">		tmp[i]=a[i];</span><br><span class="line">	<span class="built_in">sort</span>(tmp+l[pos[p]],tmp+r[pos[p]]+<span class="number">1</span>,cmp);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;<span class="comment">//修改后根据a重新对tmp排序</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y,<span class="type">const</span> <span class="type">int</span> v)</span></span>&#123;<span class="comment">//x~y加上v</span></span><br><span class="line">	<span class="keyword">if</span>(pos[x]==pos[y])&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=x;i&lt;=y;i++)</span><br><span class="line">			a[i]+=v;</span><br><span class="line">		<span class="built_in">reset</span>(x);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=x;i&lt;=r[pos[x]];i++)</span><br><span class="line">		a[i]+=v;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=l[pos[y]];i&lt;=y;i++)</span><br><span class="line">		a[i]+=v;</span><br><span class="line">	<span class="built_in">reset</span>(x);</span><br><span class="line">	<span class="built_in">reset</span>(y);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=pos[x]+<span class="number">1</span>;i&lt;pos[y];i++)</span><br><span class="line">		add[i]+=v;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fnd</span><span class="params">(<span class="type">const</span> <span class="type">int</span> p,<span class="type">const</span> <span class="type">int</span> v)</span></span>&#123;<span class="comment">//p所在块中&gt;=v个数</span></span><br><span class="line">	<span class="type">int</span> tl=l[p],tr=r[p],mid=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(tl&lt;=tr)&#123;</span><br><span class="line">		mid=(tl+tr)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(tmp[mid]&lt;v)</span><br><span class="line">			tl=mid+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			tr=mid<span class="number">-1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> r[p]-tl+<span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y,<span class="type">const</span> <span class="type">int</span> v)</span></span>&#123;<span class="comment">//统计x~y中&gt;=v的个数</span></span><br><span class="line">	<span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(pos[x]==pos[y])&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=x;i&lt;=y;i++)</span><br><span class="line">			<span class="keyword">if</span>(a[i]+add[pos[x]]&gt;=v)</span><br><span class="line">				cnt++;</span><br><span class="line">		<span class="keyword">return</span> cnt;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=x;i&lt;=r[pos[x]];i++)</span><br><span class="line">		<span class="keyword">if</span>(a[i]+add[pos[i]]&gt;=v)</span><br><span class="line">			cnt++;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=l[pos[y]];i&lt;=y;i++)</span><br><span class="line">		<span class="keyword">if</span>(a[i]+add[pos[i]]&gt;=v)</span><br><span class="line">			cnt++;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=pos[x]+<span class="number">1</span>;i&lt;pos[y];i++)</span><br><span class="line">		cnt+=<span class="built_in">fnd</span>(i,v-add[i]);</span><br><span class="line">	<span class="keyword">return</span> cnt;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;q);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">		tmp[i]=a[i];<span class="comment">//tmp排序后数组 a原数组</span></span><br><span class="line">	&#125;;</span><br><span class="line">	blk=<span class="built_in">sqrt</span>(n),</span><br><span class="line">	t=n/blk;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;i++)</span><br><span class="line">		l[i]=(i<span class="number">-1</span>)*blk+<span class="number">1</span>,</span><br><span class="line">		r[i]=i*blk;</span><br><span class="line">	<span class="keyword">if</span>(r[t]&lt;n)</span><br><span class="line">		l[t+<span class="number">1</span>]=r[t]+<span class="number">1</span>,</span><br><span class="line">		r[++t]=n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=l[i];j&lt;=r[i];j++)</span><br><span class="line">			pos[j]=i;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;i++)</span><br><span class="line">		<span class="built_in">sort</span>(tmp+l[i],tmp+r[i]+<span class="number">1</span>,cmp);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=q;i++)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d%d&quot;</span>,&amp;opr,&amp;t1,&amp;t2,&amp;t3);</span><br><span class="line">		<span class="keyword">switch</span>(opr[<span class="number">0</span>])&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;M&#x27;</span>:</span><br><span class="line">				<span class="built_in">modify</span>(t1,t2,t3);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">query</span>(t1,t2,t3));</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="尺取法"><a href="#尺取法" class="headerlink" title="尺取法"></a>尺取法</h2><h3 id="最长子区间和"><a href="#最长子区间和" class="headerlink" title="最长子区间和"></a>最长子区间和</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">l=r=<span class="number">1</span>,</span><br><span class="line">sum=<span class="number">0</span>,</span><br><span class="line">ans=n+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">	<span class="keyword">while</span>((r&lt;=n)&amp;&amp;(sum&lt;s))</span><br><span class="line">		sum+=a[r++];</span><br><span class="line">	<span class="keyword">if</span>(sum&lt;s)</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	ans=<span class="built_in">min</span>(ans,r-l),</span><br><span class="line">	sum-=a[l++];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(ans==n+<span class="number">1</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;0\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans);</span><br></pre></td></tr></table></figure>

<h2 id="三分法"><a href="#三分法" class="headerlink" title="三分法"></a>三分法</h2><h3 id="单峰函数极值"><a href="#单峰函数极值" class="headerlink" title="单峰函数极值"></a>单峰函数极值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> eps=<span class="number">1</span>e-(N<span class="number">-2</span>);</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">f</span><span class="params">(<span class="type">const</span> <span class="type">double</span> k)</span></span>&#123;</span><br><span class="line">	<span class="type">double</span> sum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;=n+<span class="number">1</span>;i++)</span><br><span class="line">		sum=sum*k+a[i];</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;;<span class="comment">//a系数</span></span><br><span class="line"><span class="keyword">while</span>(r-l&gt;eps)&#123;</span><br><span class="line">	lmid=l+(r-l)/<span class="number">3</span>,</span><br><span class="line">	rmid=r-(r-l)/<span class="number">3</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">f</span>(lmid)&lt;=<span class="built_in">f</span>(rmid))</span><br><span class="line">		l=lmid;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		r=rmid;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.5lf\n&quot;</span>,l);</span><br></pre></td></tr></table></figure>

<h2 id="最大公因数-最小公倍数"><a href="#最大公因数-最小公倍数" class="headerlink" title="最大公因数+最小公倍数"></a>最大公因数+最小公倍数</h2><h3 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h3><p>$$<br>\forall a,b\in \mathbb N,\gcd(a,b)\mathrm{lcm}(a,b)&#x3D;ab<br>$$</p>
<h3 id="九章算术·更相减损术"><a href="#九章算术·更相减损术" class="headerlink" title="九章算术·更相减损术"></a>九章算术·更相减损术</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \forall a,b\in \mathbb N,a\ge b,&amp;有\gcd(a,b)&#x3D;\gcd(b,a-b)&#x3D;\gcd(a,a-b)\\<br>        \forall a,b\in \mathbb N,&amp;有\gcd(2a,2b)&#x3D;2\gcd(a,b)<br>    }<br>\end{aligned}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(a!=b)</span><br><span class="line">        <span class="keyword">if</span>(a&gt;b)</span><br><span class="line">            a-=b;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            b-=a;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="欧几里得算法"><a href="#欧几里得算法" class="headerlink" title="欧几里得算法"></a>欧几里得算法</h3><p>$$<br>\forall a,b\in \mathbb N,b\ne 0,\gcd(a,b)&#x3D;\gcd(b,a\bmod b)<br>$$</p>
<p>$O(\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lcm</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a/<span class="built_in">gcd</span>(a,b)*b;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Lucas定理"><a href="#Lucas定理" class="headerlink" title="Lucas定理"></a>Lucas定理</h2><p>若$p\in\mathbb P$，则对于$\forall m\in\mathbb Z,1\leq m\leq n$，有：<br>$$<br>\mathrm{\large C}<em>n^m\equiv \mathrm{\large C}</em>{n\bmod p}^{m\bmod p}\mathrm{\large C}_{\lfloor\frac{n}{p}\rfloor}^{\lfloor\frac{m}{p}\rfloor}\pmod p<br>$$<br>$O(f(p)+g(n)\log n)$，$f(n)$为预处理组合数的复杂度，$g(n)$为单次求组合数的复杂度。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">icn</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(a&gt;tot)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=tot+<span class="number">1</span>;i&lt;=a;i++)</span><br><span class="line">			rec[i]=(rec[i<span class="number">-1</span>]*i)%p;</span><br><span class="line">		tot=a;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> rec[a];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpow</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">1</span>;</span><br><span class="line">	a%=p;</span><br><span class="line">	<span class="keyword">while</span>(b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>((b&amp;<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">			ret=(ret*a)%p;</span><br><span class="line">		a=(a*a)%p,</span><br><span class="line">		b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">fc</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(a&lt;b)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">icn</span>(a)*<span class="built_in">fpow</span>(<span class="built_in">icn</span>(b),p<span class="number">-2</span>)%p*<span class="built_in">fpow</span>(<span class="built_in">icn</span>(a-b),p<span class="number">-2</span>)%p;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lcs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">fc</span>(a%p,b%p)*<span class="built_in">lcs</span>(a/p,b/p)%p;</span><br><span class="line">&#125;;</span><br><span class="line">tot=<span class="number">0</span>,</span><br><span class="line">rec[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">lcs</span>(n,m));</span><br></pre></td></tr></table></figure>

<h2 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h2><p>设$m_1,m_2,\cdots,m_n\in\mathbb Z$两两互质，$\displaystyle m&#x3D;\prod_{i&#x3D;1}^n{m_i}, \ \displaystyle M_i&#x3D;\frac{m}{m_i}$，$t_i$是线性同余方程$\displaystyle M_it_i\equiv 1\pmod{m_i}$的一个解。对于任意的$a_1,a_2,\cdots,a_n\in \mathbb Z$，方程组<br>$$<br>\begin{cases}<br>    \displaylines{<br>        x\equiv a_1\pmod{m_1}\\<br>        x\equiv a_2\pmod{m_2}\\<br>        \qquad\qquad\vdots\\<br>        x\equiv a_n\pmod{m_n}<br>   }<br>\end{cases}<br>$$<br>有整数解，解为$\displaystyle x&#x3D;\sum_{i&#x3D;1}^n{a_iM_it_i}$。</p>
<h3 id="算法流程"><a href="#算法流程" class="headerlink" title="算法流程"></a>算法流程</h3><p>1、计算$\displaystyle m&#x3D;\prod_{i&#x3D;1}^n{m_i}$。<br>2、对于第$i$个方程：<br>3、计算$\displaystyle M_i&#x3D;\frac{m}{m_i}$。<br>4、计算$M_i^{-1}\pmod{m_i}$。<br>5、计算$c_i&#x3D;M_iM_i^{-1}$（不要对$m_i$取模）。<br>6、方程组的唯一解为：$\displaystyle x&#x3D;\left(\sum_{i&#x3D;1}^n{a_ic_i}\right)\bmod m$。  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> a,<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> b,<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> &amp;x,<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		x=<span class="number">1</span>,</span><br><span class="line">		y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">	y-=a/b*x;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">inv</span><span class="params">(<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> x=<span class="number">0</span>,y=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">exgcd</span>(a,b,x,y);</span><br><span class="line">	<span class="keyword">return</span> (x%b+b)%b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	br[i]=<span class="built_in">read</span>(),</span><br><span class="line">	ar[i]=<span class="built_in">read</span>(),</span><br><span class="line">	k*=br[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	ans=(ans+ar[i]*k/br[i]*<span class="built_in">inv</span>(k/br[i],br[i]))%k;</span><br></pre></td></tr></table></figure>

<h2 id="素数筛"><a href="#素数筛" class="headerlink" title="素数筛"></a>素数筛</h2><h3 id="Eratosthenes筛法"><a href="#Eratosthenes筛法" class="headerlink" title="Eratosthenes筛法"></a>Eratosthenes筛法</h3><p>$O(n\log\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> notprime[N+<span class="number">1</span>];</span><br><span class="line">notprime[<span class="number">0</span>]=notprime[<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(notprime[i]==<span class="literal">false</span>)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=i;j&lt;n/i;j++)</span><br><span class="line">			notprime[i*j]=<span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<h3 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h3><p>$O(n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> mindiv[N+<span class="number">1</span>],prime[N+<span class="number">1</span>],tot;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="keyword">if</span>(mindiv[i]==<span class="number">0</span>)&#123;</span><br><span class="line">		mindiv[i]=i,</span><br><span class="line">		prime[tot++]=i;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;prime[j]*i&lt;=n;j++)&#123;</span><br><span class="line">		mindiv[prime[j]*i]=prime[j];</span><br><span class="line">		<span class="keyword">if</span>(prime[j]==mindiv[i])</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h2><p>若$b,m\in\mathbb{Z},b\bot m$，并且$b\mid a$，则$\exist x\in\mathbb{Z},\frac{a}{b}\equiv ax\pmod m$。称$x$为 <strong>$b$的模$m$乘法逆元</strong> ，记为$b^{-1}\pmod m$。<br>1、当$p\in\mathbb{P}$时，$b^{p-2}&#x3D;b^{-1}\pmod p$。<br>2、求解同余方程$bx\equiv 1\pmod m$。  </p>
<h3 id="扩展欧几里得求逆元"><a href="#扩展欧几里得求逆元" class="headerlink" title="扩展欧几里得求逆元"></a>扩展欧几里得求逆元</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		x=<span class="number">1</span>,</span><br><span class="line">		y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;;</span><br><span class="line">	t=<span class="built_in">exgcd</span>(b,a%b,y,x),</span><br><span class="line">	y-=(a/b)*x;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">inv</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> md)</span></span>&#123;</span><br><span class="line">	<span class="built_in">exgcd</span>(a,md,x,y);</span><br><span class="line">	<span class="keyword">return</span> (x%md+md)%md;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="线性求逆元"><a href="#线性求逆元" class="headerlink" title="线性求逆元"></a>线性求逆元</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">	inv[i]=(<span class="type">long</span> <span class="type">long</span> <span class="type">int</span>)(p-p/i)*inv[p%i]%p;</span><br></pre></td></tr></table></figure>

<h3 id="快速幂求逆元"><a href="#快速幂求逆元" class="headerlink" title="快速幂求逆元"></a>快速幂求逆元</h3><p>$b\pmod p$的逆元为$b^{p-2}\pmod p$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">fp</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b,<span class="type">const</span> <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(b!=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>((b&amp;<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">			ret=(ret*a)%m;</span><br><span class="line">		a=(a*a)%m,</span><br><span class="line">		b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getinv</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">fp</span>(a,m<span class="number">-2</span>,m);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="高斯-约旦消元法"><a href="#高斯-约旦消元法" class="headerlink" title="高斯-约旦消元法"></a>高斯-约旦消元法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=i+<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">		jdg=<span class="built_in">rand</span>()%<span class="number">10000</span>+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>((jdg&amp;<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n+<span class="number">1</span>;k++)</span><br><span class="line">				<span class="built_in">swp</span>(map[i][k],map[j][k]);</span><br><span class="line">	&#125;;<span class="comment">//防止各种hack数据</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n+<span class="number">1</span>;j++)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;a[i][j]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	maxn=i;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=i+<span class="number">1</span>;j&lt;=n;j++)<span class="comment">//选出该列最大系数</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[j][i])&gt;<span class="built_in">fabs</span>(a[maxn][i]))</span><br><span class="line">			maxn=j;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n+<span class="number">1</span>;j++)</span><br><span class="line">		<span class="built_in">swp</span>(a[i][j],a[maxn][j]);</span><br><span class="line">	<span class="keyword">if</span>(a[i][i]==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">continue</span>;<span class="comment">//最大值等于0则说明该列都为0，肯定无解</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		<span class="keyword">if</span>(i!=j)&#123;</span><br><span class="line">			tmp=a[j][i]/a[i][i];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=i+<span class="number">1</span>;k&lt;=n+<span class="number">1</span>;k++)</span><br><span class="line">				a[j][k]-=a[i][k]*tmp;</span><br><span class="line">		&#125;;<span class="comment">//每一项都减去一个数（即加减消元）</span></span><br><span class="line">&#125;;<span class="comment">//输出的结果要记得除以该项系数，消去常数</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="keyword">if</span>(a[i][i]==<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i][n]!=<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;无解\n&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			flag=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">continue</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	ans[i]=map[i][n]/map[i][i];</span><br><span class="line">	<span class="keyword">if</span>(ans[i]==<span class="number">-0.00</span>)</span><br><span class="line">		ans[i]=<span class="number">0.00</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(flag==<span class="literal">true</span>)&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;无穷多实数解\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;x%d=%.2lf\n&quot;</span>,i+<span class="number">1</span>,ans[i]);</span><br></pre></td></tr></table></figure>

<h2 id="Bezout定理"><a href="#Bezout定理" class="headerlink" title="Bézout定理"></a>Bézout定理</h2><p>$\forall a,b\in\mathbb Z$，$\exist x,y\in\mathbb Z, \ ax+by&#x3D;\gcd(a,b)$</p>
<p>$ax+by&#x3D;c,x\in \mathbb Z^+,y\in \mathbb Z^+\Leftrightarrow\gcd(a,b)\mid c$</p>
<h3 id="推广"><a href="#推广" class="headerlink" title="推广"></a>推广</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        c&#x3D;&amp;\sum{A_i\times X_i}\\<br>        c_{\mathrm{min}}&#x3D;&amp;\gcd(A_i)<br>    }<br>\end{aligned}<br>$$</p>
<h2 id="线性同余方程"><a href="#线性同余方程" class="headerlink" title="线性同余方程"></a>线性同余方程</h2><h3 id="定理-1"><a href="#定理-1" class="headerlink" title="定理"></a>定理</h3><p>1、方程$ax+by&#x3D;c$与方程$\displaystyle ax\equiv c\pmod b$是等价的，有整数解的充要条件为$\gcd(a,b)\mid c$。  </p>
<p>根据定理 1，方程$ax+by&#x3D;c$，我们可以先用扩展欧几里得算法求出一组$x_0,y_0$，也就是$ax_0+by_0&#x3D;\gcd(a,b)$，然后两边同时除以$\gcd(a,b)$，再乘$c$。然后就得到了方程$\displaystyle a\frac{c}{\gcd(a,b)}x_0+b\frac{c}{\gcd(a,b)}y_0&#x3D;c$，然后我们就找到了方程的一个解。  </p>
<p>2、若$\gcd(a,b)&#x3D;1$，且$x_0$、$y_0$为方程$ax+by&#x3D;c$的一组解，则该方程的任意解可表示为：$x&#x3D;x_0+bt$，$y&#x3D;y_0-at$,且对$\forall t\in\mathbb Z$都成立。  </p>
<p>根据定理 2，可以求出方程的所有解。但在实际问题中，我们往往被要求求出一个最小整数解，也就是一个特解$\displaystyle x&#x3D;(x\bmod t+t)\bmod t$，其中$\displaystyle t&#x3D;\frac{b}{\gcd(a,b)}$。  </p>
<h3 id="最小整数解："><a href="#最小整数解：" class="headerlink" title="最小整数解："></a>最小整数解：</h3><p>$$<br>ax\equiv 1\pmod b<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//long long int</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		x=<span class="number">1</span>,</span><br><span class="line">		y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;;</span><br><span class="line">	res=<span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">	y-=a/b*x;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line">gcd=<span class="built_in">exgcd</span>(a,b,x,y),</span><br><span class="line">a/=gcd,</span><br><span class="line">b/=gcd,</span><br><span class="line">c/=gcd,</span><br><span class="line">x*=c,</span><br><span class="line">b=<span class="built_in">abs</span>(b);</span><br><span class="line"><span class="keyword">if</span>(a%b==<span class="number">0</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Impossible\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(x%b+b)%b);</span><br></pre></td></tr></table></figure>

<h3 id="同余基本性质"><a href="#同余基本性质" class="headerlink" title="同余基本性质"></a>同余基本性质</h3><p>1、$a_1,b_1,a_2,b_2\in\mathbb Z,m\in\mathbb{N^+}$，当$\displaystyle a_1\equiv b_1\pmod m,a_2\equiv b_2\pmod m$成立时，有$\displaystyle a_1\pm a_2\equiv b_1\pm b_2\pmod m$。  </p>
<p>2、$a_1,b_1,a_2,b_2\in\mathbb Z,m\in\mathbb{N^+}$，当$\displaystyle a_1\equiv b_1\pmod m,a_2\equiv b_2\pmod m$成立时，有$\displaystyle a_1a_2\equiv b_1b_2\pmod m$。  </p>
<p>3、$a,b,c\in\mathbb Z,m\in\mathbb {N^+}$，当$\displaystyle a+b\equiv c\pmod m$成立时，有$\displaystyle a\equiv c-b\pmod m$。  </p>
<p>4、$a,b\in\mathbb Z, \ k,m\in\mathbb{N^+}$，当$\displaystyle a\equiv b\pmod m$成立时，有$\displaystyle ak\equiv bk\pmod{mk}$。  </p>
<p>5、$a,b\in\mathbb Z, \ d,m\in\mathbb{N^+}, \ d\mid a, \ d\mid b, \ d\mid m$，则当$\displaystyle a\equiv b\pmod m$成立时，有$\displaystyle \frac{a}{d}\equiv\frac{b}{d}\quad\left(\bmod{\frac{m}{d}}\right)$。  </p>
<p>6、$a,b\in\mathbb Z, \ d,m\in\mathbb{N^+}, \ d\mid m$，则当$\displaystyle a\equiv b\pmod m$成立时，有$\displaystyle a\equiv b\pmod d$。  </p>
<p>7、$a,b\in\mathbb Z, \ d,m\in\mathbb{N^+}$，则当$\displaystyle a\equiv b\pmod m$成立时，有$\gcd(a,m)&#x3D;\gcd(b,m)$，则：<br>$$<br>\begin{cases}<br>    \displaylines{<br>        d\mid a &amp; :d\mid m, \ d\mid b\\<br>        d\mid b &amp; :d\mid m, \ d\mid a<br>    }<br>\end{cases}<br>$$</p>
<h2 id="二元一次不定方程"><a href="#二元一次不定方程" class="headerlink" title="二元一次不定方程"></a>二元一次不定方程</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b,<span class="type">int</span> &amp;tx,<span class="type">int</span> &amp;ty)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">		tx=<span class="number">1</span>,</span><br><span class="line">		ty=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;;</span><br><span class="line">	ans=<span class="built_in">exgcd</span>(b,a%b,ty,tx);</span><br><span class="line">	ty-=a/b*tx;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line">gcd=<span class="built_in">exgcd</span>(a,b,x,y);</span><br><span class="line"><span class="keyword">if</span>(c%gcd!=<span class="number">0</span>)&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">	<span class="keyword">continue</span>;</span><br><span class="line">&#125;;</span><br><span class="line">x*=c/gcd,</span><br><span class="line">y*=c/gcd,</span><br><span class="line">p=b/gcd,</span><br><span class="line">q=a/gcd;</span><br><span class="line"><span class="keyword">if</span>(x&lt;<span class="number">0</span>)<span class="comment">//将x提高到最小正整数 </span></span><br><span class="line">	k=<span class="built_in">ceil</span>((<span class="number">1.0</span>-x)/p),</span><br><span class="line">	x+=p*k,</span><br><span class="line">	y-=q*k;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//将x降低到最小正整数 </span></span><br><span class="line">	k=(x<span class="number">-1</span>)/p,</span><br><span class="line">	x-=p*k,</span><br><span class="line">	y+=q*k;</span><br><span class="line"><span class="keyword">if</span>(y&gt;<span class="number">0</span>)&#123;<span class="comment">//有正整数解</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,(y<span class="number">-1</span>)/q+<span class="number">1</span>);<span class="comment">//解的个数</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,x);<span class="comment">//x的最小正整数值</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,(y<span class="number">-1</span>)%q+<span class="number">1</span>);<span class="comment">//y的最小正整数值</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,x+(y<span class="number">-1</span>)/q*p);<span class="comment">//x的最大正整数值</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,y);<span class="comment">//y的最大正整数值</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;<span class="comment">//无正整数解</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,x);<span class="comment">//x的最小正整数值</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,y+q*(<span class="type">int</span>)<span class="built_in">ceil</span>((<span class="number">1.0</span>-y)/q));<span class="comment">//y的最小正整数值</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="矩阵乘法"><a href="#矩阵乘法" class="headerlink" title="矩阵乘法"></a>矩阵乘法</h2><p>设$A$是$n\times m$矩阵，$B$是$m\times p$矩阵，则$C&#x3D;A\times B$是$n\times p$矩阵，并且$\forall i\in[1,n]$，$\forall j\in[1,p]$：<br>$$<br>C_{i,j}&#x3D;\sum_{k&#x3D;1}^m{A_{i,k}\times B_{k,j}}<br>$$</p>
<h3 id="加速递推"><a href="#加速递推" class="headerlink" title="加速递推"></a>加速递推</h3><p>$$<br>f_n&#x3D;p\times f_{n-1}+q\times f_{n-2}<br>$$</p>
<p>求$\displaystyle f_n \bmod m$：<br>$$<br>\left[<br>    \begin{matrix}<br>    f_1&amp;f_2<br>   \end{matrix}<br>\right]<br>\times<br>\left[<br>    \begin{matrix}<br>    \displaylines{<br>           0&amp;q\\<br>        1&amp;p<br>    }<br>   \end{matrix}<br>\right]^{n-2}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> ret[<span class="number">2</span>];</span><br><span class="line">	<span class="built_in">memset</span>(ret,<span class="number">0</span>,<span class="built_in">sizeof</span>(ret));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">2</span>;j++)</span><br><span class="line">			ret[i]=(ret[i]+f[j]*a[j][i])%m;</span><br><span class="line">	<span class="built_in">memcpy</span>(f,ret,<span class="built_in">sizeof</span>(ret));</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mulself</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> ret[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">	<span class="built_in">memset</span>(ret,<span class="number">0</span>,<span class="built_in">sizeof</span>(ret));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">2</span>;j++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">0</span>;k&lt;<span class="number">2</span>;k++)</span><br><span class="line">				ret[i][j]=(ret[i][j]+a[i][k]*a[k][j])%m;</span><br><span class="line">	<span class="built_in">memcpy</span>(a,ret,<span class="built_in">sizeof</span>(ret));</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d%d&quot;</span>,&amp;p,&amp;q,&amp;f[<span class="number">0</span>],&amp;f[<span class="number">1</span>],&amp;n,&amp;m);</span><br><span class="line">	n-=<span class="number">2</span>,</span><br><span class="line">	a[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>,</span><br><span class="line">	a[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	a[<span class="number">0</span>][<span class="number">1</span>]=q,</span><br><span class="line">	a[<span class="number">1</span>][<span class="number">1</span>]=p;</span><br><span class="line">	<span class="keyword">while</span>(n!=<span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>==<span class="number">1</span>)</span><br><span class="line">			<span class="built_in">mul</span>();</span><br><span class="line">		<span class="built_in">mulself</span>();</span><br><span class="line">		n&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,f[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="博弈论-SG函数"><a href="#博弈论-SG函数" class="headerlink" title="博弈论+SG函数"></a>博弈论+SG函数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>游戏过程中面临的状态称为<strong>局面</strong> 。整局游戏第一个行动的称为<strong>先手</strong> 第二个行动的称为<strong>后手</strong> 。若在某一局面下无论采取何种行动，都会输掉游戏，则称该局面<strong>必败</strong> 。<strong>最优策略</strong> 指若在某一局面下存在何种行动，是的行动后对手面临必败局面，则优先采取该行动。同时，这样的局面被称为<strong>必胜</strong> 。  </p>
<h4 id="公平组合游戏ICG"><a href="#公平组合游戏ICG" class="headerlink" title="公平组合游戏ICG"></a>公平组合游戏ICG</h4><p>1、由两名玩家交替行动<br>2、在游戏进程的任意时刻，可以执行的合法行动与轮到哪名玩家无关。<br>3、不能行动的玩家判负  </p>
<h4 id="有向图游戏"><a href="#有向图游戏" class="headerlink" title="有向图游戏"></a>有向图游戏</h4><p>给定一个DAG，图中有一个唯一的起点，在起点上放有一枚棋子。两名玩家交替地把这枚棋子沿有向边进行移动，每次可以移动一步，无法移动者判负。任何一个ICG都可以转化为有向图游戏：把每个局面看成图中的一个节点，并且从每个局面向沿着合法行动能够到达的下一个局面连有向边。  </p>
<h4 id="Mex运算"><a href="#Mex运算" class="headerlink" title="Mex运算"></a>Mex运算</h4><p>设$S\in\mathbb N$。<br>$$<br>{\rm mex}(S)&#x3D;\min_{x\in\mathbb N,x\in S}{x}<br>$$</p>
<h4 id="SG函数"><a href="#SG函数" class="headerlink" title="SG函数"></a>SG函数</h4><p>在有向图游戏中，对于每个节点$x$，设从$x$出发共有$k$条有向边，分别到达节点$y_1,y_2,\cdots ,y_k$。  </p>
<p>$$<br>\operatorname{SG}(x)&#x3D;\operatorname{mex}({\operatorname{SG}(y_1),\operatorname{SG}(y_2),\cdots,\operatorname{SG}(y_k)})<br>$$</p>
<p>特别地，设整个有向图游戏$G$的起点$s$，有${\rm SG}(G)&#x3D;{\rm SG}(s)$。  </p>
<h4 id="有向图游戏的和"><a href="#有向图游戏的和" class="headerlink" title="有向图游戏的和"></a>有向图游戏的和</h4><p>设$G_1,G_2,\cdots ,G_m$是$m$个有向图游戏。定义有向图游戏$G$，它的行动规则是任选某个有向图游戏$G_i$，并在$G_i$上行动一步。$G$被称为有向图$G_1,G_2,\cdots ,G_m$的和。<br>$$<br>{\rm SG}(G)&#x3D;\bigoplus_{i&#x3D;1}^m{\rm SG}(G_m)<br>$$</p>
<h4 id="定理-2"><a href="#定理-2" class="headerlink" title="定理"></a>定理</h4><p>1、有向图游戏的某个局面必胜，当且仅当该局面对应节点的${\rm SG}()&gt;0$。  </p>
<p>2、有向图游戏的某个局面必败，当且仅当该局面对应节点的${\rm SG}()&#x3D;0$。  </p>
<h3 id="NIM博弈"><a href="#NIM博弈" class="headerlink" title="NIM博弈"></a>NIM博弈</h3><p>有任意堆物品，每堆物品的个数是任意的，双方轮流从中取物品，每一次只能从一堆物品中取部分或全部物品，最少取一件，取到最后一件物品的人获胜。  </p>
<p><strong>先手必胜当且仅当：</strong><br>$$<br>\bigoplus_{i&#x3D;1}^n{A_i}\ne 0<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;tmp);</span><br><span class="line">	ans^=tmp;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(ans==<span class="number">0</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;后手必胜\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;先手必胜\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="威佐夫博弈"><a href="#威佐夫博弈" class="headerlink" title="威佐夫博弈"></a>威佐夫博弈</h3><p>有两堆各若干的物品，两人轮流从其中一堆取至少一件物品，至多不限，或从两堆中同时取相同件物品，规定最后取完者胜利。  </p>
<p><strong>若两堆物品的初始值为$(x,y)$，且$x&lt;y$，则另$z&#x3D;y-x$；<br>记$\displaystyle w&#x3D;(\mathrm{int})\left(\frac{\sqrt{5}+1}{2}\times z\right)$；<br>若$w&#x3D;x$，则先手必败，否则先手必胜。</strong>  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;x,&amp;y);</span><br><span class="line"><span class="keyword">if</span>((<span class="type">int</span>)(((<span class="built_in">sqrt</span>(<span class="number">5</span>)+<span class="number">1</span>)/<span class="number">2</span>)*(<span class="built_in">max</span>(x,y)-<span class="built_in">min</span>(x,y)))==<span class="built_in">min</span>(x,y))</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;先手必败\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;先手必胜\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="巴什博奕"><a href="#巴什博奕" class="headerlink" title="巴什博奕"></a>巴什博奕</h3><p>A和B一块报数，每人每次报最少$1$个，最多报$4$个，看谁先报到$30$。  </p>
<p>第一次报数，A报$k$个数，那么B报$5-k$个数，那么B报数之后问题就变为，A和B一块报数，看谁先报到$25$了，进而变为$20,15,10,5$，当到$5$的时候，不管A怎么报数，最后一个数肯定是B报的，可以看出，作为后手的B在个游戏中是不会输的。  </p>
<p><strong>那么如果我们要报$n$个数，每次最少报一个，最多报$m$个，我们可以找到这么一个整数$k$和$r$，使$n&#x3D;k\times (m+1)+r$，代入上面的例子我们就可以知道，如果$r&#x3D;0$，那么先手必败；否则，先手必胜。</strong>  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(n%(m+<span class="number">1</span>)==<span class="number">0</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;后手必胜\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;先手必胜\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="斐波那契博弈"><a href="#斐波那契博弈" class="headerlink" title="斐波那契博弈"></a>斐波那契博弈</h3><p>有一堆物品，两人轮流取物品，先手最少取一个，至多无上限，但不能把物品取完，之后每次取的物品数不能超过上一次取的物品数的二倍且至少为一件，取走最后一件物品的人获胜。  </p>
<p><strong>先手胜当且仅当$n$不是斐波那契数（$n$为物品总数）</strong>  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">55</span>;</span><br><span class="line">f[<span class="number">1</span>]=f[<span class="number">2</span>]=<span class="number">1</span>,</span><br><span class="line">flag=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">3</span>;i&lt;=N;i++)</span><br><span class="line">	f[i]=f[i<span class="number">-1</span>]+f[i<span class="number">-2</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)</span><br><span class="line">	<span class="keyword">if</span>(f[i]==n)&#123;</span><br><span class="line">		flag=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;;</span><br><span class="line"><span class="keyword">if</span>(flag==<span class="literal">true</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;先手必败\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;先手必胜\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="算术基本定理"><a href="#算术基本定理" class="headerlink" title="算术基本定理"></a>算术基本定理</h2><p>$\forall N\in\mathbb N^+$能唯一分解为有限个质数的乘积，可写作：<br>$$<br>N&#x3D;p_1^{c_1}p_2^{c_2}\cdots p_m^{c_m}<br>$$<br>其中$\forall c_i\in \mathbb N^+,p_i\in \mathbb P$，且满足$p_1&lt;p_2&lt;\cdots &lt;p_m$</p>
<h3 id="推论"><a href="#推论" class="headerlink" title="推论"></a>推论</h3><p>$N$的正约数集合可写作：<br>$$<br>{ p_1^{b_1}p_2^{b_2}\cdots p_m^{b_m} },0\le b_i\le c_i<br>$$<br>$N$的正约数个数为：<br>$$<br>(c_1+1)(c_2+1)\cdots(c_m+1)&#x3D;\prod_{i&#x3D;1}^m{(c_i+1)}<br>$$<br>$N$的所有正约数的和为：<br>$$<br>(1+p_1+p_1^2+\cdots+p_1^{c_1})\cdots(1+p_m+p_m^2+\cdots+p_m^{c_m})&#x3D;\prod_{i&#x3D;1}^m{\sum_{j&#x3D;0}^{c_i}{(p_i)^j}}<br>$$</p>
<h2 id="因数"><a href="#因数" class="headerlink" title="因数"></a>因数</h2><h3 id="整除的性质"><a href="#整除的性质" class="headerlink" title="整除的性质"></a>整除的性质</h3><p>1、$a\mid b\Leftrightarrow -a\mid b\Leftrightarrow a\mid -b\Leftrightarrow |a|\mid |b|$  </p>
<p>2、$a\mid b, \ b\mid c\Rightarrow a\mid c$  </p>
<p>3、$a\mid b, \ a\mid c\Leftrightarrow\forall x,y\in\mathbb{Z},a\mid xb+yc$  </p>
<p>4、$a\mid b, b\mid a\Rightarrow b&#x3D;\pm a$  </p>
<p>5、$a\mid b\Leftrightarrow ma\mid mb, \ m\neq 0$  </p>
<p>6、$a\mid b\Rightarrow |a|\leq |b|, \ b\neq 0$  </p>
<p>7、$a\mid b\Leftrightarrow a\mid c, \ a\neq 0, \ b&#x3D;qa+c$  </p>
<h3 id="试除法"><a href="#试除法" class="headerlink" title="试除法"></a>试除法</h3><h4 id="质因数分解"><a href="#质因数分解" class="headerlink" title="质因数分解"></a>质因数分解</h4><p>$O(\sqrt n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=<span class="built_in">sqrt</span>(n);i++)</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">			prm[++cnt]=i,</span><br><span class="line">			chk[cnt]=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(n%i==<span class="number">0</span>)</span><br><span class="line">				n/=i,</span><br><span class="line">				chk[cnt]++;</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">if</span>(n&gt;<span class="number">1</span>)</span><br><span class="line">		prm[++cnt]=n,</span><br><span class="line">		chk[cnt]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,prm[i],chk[i]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="正约数集合"><a href="#正约数集合" class="headerlink" title="正约数集合"></a>正约数集合</h4><p>$O(\sqrt n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i*i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">		fct[++cnt]=i;</span><br><span class="line">		<span class="keyword">if</span>(i!=n/i)</span><br><span class="line">			fct[++cnt]=n/i;</span><br><span class="line">	&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,fct[i]);</span><br></pre></td></tr></table></figure>

<h3 id="倍数法"><a href="#倍数法" class="headerlink" title="倍数法"></a>倍数法</h3><p>$O(n\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; fct[];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n/i;j++)</span><br><span class="line">		fct[i*j].<span class="built_in">push_back</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;fct[i].<span class="built_in">size</span>();j++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,fct[i][j]);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="推论-1"><a href="#推论-1" class="headerlink" title="推论"></a>推论</h3><p>一个整数$N$的约数个数上界为$2\sqrt n$。  </p>
<p>$[1,N]$每个数的约数个数的总和$\approx N\log N$。  </p>
<h2 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h2><p>$[1,N]$中与$N$互质的数的个数被称为欧拉函数，记为$\varphi(N)$。  </p>
<p>若在算术基本定理中，$N&#x3D;p_1^{c_1}p_2^{c_2}\cdots p_m^{c_m}$，则：<br>$$<br>\varphi(N)&#x3D;N\times\frac{p_1-1}{p_1}\times\frac{p_2-1}{p_2}\times\cdots\times\frac{p_m-1}{p_m}&#x3D;N\times\prod_{p\mid N,p\in\mathbb P}{\left(1-\frac{1}{p}\right)}<br>$$</p>
<p><strong>质数分布密度：</strong> 对于一个足够大的$N\in\mathbb Z$，不超过$N$的质数大约有$\displaystyle \frac{N}{\ln N}$个。  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">phi</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans=n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i*i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">			ans=ans/i*(i<span class="number">-1</span>);</span><br><span class="line">			<span class="keyword">while</span>(n%i==<span class="number">0</span>)</span><br><span class="line">				n/=i;</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">if</span>(n&gt;<span class="number">1</span>)</span><br><span class="line">		ans=ans/n*(n<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="欧拉筛"><a href="#欧拉筛" class="headerlink" title="欧拉筛"></a>欧拉筛</h3><p>$O(n\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">euler</span><span class="params">(<span class="type">const</span> <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">		phi[i]=i;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">if</span>(phi[i]==i)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=i;j&lt;=n;j+=i)</span><br><span class="line">				phi[j]=phi[j]/i*(i<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>1、$\forall n&gt;1,[1,n]$中与$n$互质的数的和为$\displaystyle \frac{n\varphi(n)}{2}$。  </p>
<p>2、若$a\bot b$，则$\varphi(ab)&#x3D;\varphi(a)\varphi(b)$。  </p>
<p>3、若$f$是积性函数，且在算术基本定理中$\displaystyle n&#x3D;\prod_{i&#x3D;1}^m{p_i^{c_i}}$，则$\displaystyle f(n)&#x3D;\prod_{i&#x3D;1}^m{f(p_i^{c_i})}$。  </p>
<p>4、设$p\in\mathbb P$，若$p\mid n$且$p^2\mid n$，则$\displaystyle \varphi(n)&#x3D;\varphi\left(\frac{n}{p}\right)\times p$。  </p>
<p>5、设$p\in\mathbb P$，若$p\mid n$但$p^2\nmid n$，则$\displaystyle \varphi(n)&#x3D;\varphi\left(\frac{n}{p}\right)\times(p-1)$  </p>
<p>6、$\displaystyle \sum_{d\mid n}{\varphi(d)}&#x3D;n$  </p>
<h2 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h2><p>若$a,n\in\mathbb N^+,a\bot n$，则$\displaystyle a^{\varphi(n)}\equiv 1\pmod n$。  </p>
<h3 id="费马小定理"><a href="#费马小定理" class="headerlink" title="费马小定理"></a>费马小定理</h3><p>若$p\in\mathbb P$，则对任意$\displaystyle a\in\mathbb Z$，有$\displaystyle a^p\equiv a\pmod p$。  </p>
<h3 id="推论-2"><a href="#推论-2" class="headerlink" title="推论"></a>推论</h3><p>若$a,n\in\mathbb N^+,a\bot n$，则对$\forall b\in\mathbb N^+$，有$\displaystyle a^b\equiv a^{\displaystyle b\bmod\varphi(n)}\pmod n$。  </p>
<p>当$a,n$不一定$a\bot n$且$b&gt;\varphi(n)$时，有$\displaystyle a^b\equiv a^{\displaystyle b\bmod\varphi(n)+\varphi(n)}\pmod n$。  </p>
<h3 id="同余类与剩余系"><a href="#同余类与剩余系" class="headerlink" title="同余类与剩余系"></a>同余类与剩余系</h3><p>$\displaystyle \forall a\in[0,m-1],\forall x,y\in A&#x3D;{a+km}(k\in\mathbb{Z}),x\equiv y\pmod m,x\bmod m&#x3D;a$，$A$称为一个模$m$的<strong>同余类</strong> $\overline{a}$。  </p>
<p>模$m$的同余类一共有$m$个，分别为$\overline{0},\overline{1},\overline{2},\cdots,\overline{m-1}$。它们构成$m$的<strong>完全剩余系</strong>。  </p>
<p>$1\sim m$中与$m$互质的数代表的同余类共有$\varphi(m)$个，它们构成$m$的<strong>简化剩余系</strong> 。  </p>
<h2 id="排列组合"><a href="#排列组合" class="headerlink" title="排列组合"></a>排列组合</h2><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \mathrm{\large C}_n^m&#x3D;&amp;\frac{n!}{m!(n-m)!}&#x3D;<br>        \begin{pmatrix}<br>            n\\<br>            m<br>        \end{pmatrix}\\<br>        \mathrm{\large P}_n^m&#x3D;&amp;\frac{n!}{(n-m)!}<br>    }<br>\end{aligned}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">c[<span class="number">1</span>][<span class="number">0</span>]=c[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	c[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)</span><br><span class="line">		c[i][j]=c[i<span class="number">-1</span>][j]+c[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="组合数性质"><a href="#组合数性质" class="headerlink" title="组合数性质"></a>组合数性质</h3><p>1、<strong>对称恒等式：</strong><br>$$<br>\mathrm{\large C}<em>n^m&#x3D;\mathrm{\large C}<em>n^{n-m}<br>$$<br>2、<strong>加法公式：</strong><br>$$<br>\mathrm{\large C}<em>n^m&#x3D;\mathrm{\large C}</em>{n-1}^m+\mathrm{\large C}</em>{n-1}^{m-1}<br>$$<br>3、<br>$$<br>\sum</em>{i&#x3D;0}^n{\mathrm{\large C}<em>n^i}&#x3D;2^n<br>$$<br>4、<strong>吸收恒等式：</strong><br>$$<br>\mathrm{\large C}<em>n^k&#x3D;\frac{n}{k}\mathrm{\large C}</em>{n-1}^{k-1}<br>$$<br>5、<br>$$<br>\sum</em>{i&#x3D;0}^n{(-1)^i}\mathrm{\large C}<em>n^i&#x3D;[n&#x3D;0]<br>$$<br>6、<br>$$<br>\sum</em>{i&#x3D;0}^m{\mathrm{\large C}<em>n^i\mathrm{\large C}</em>{m}^{m-i}}&#x3D;\mathrm{\large C}<em>{m+n}^m<br>$$<br>7、<br>$$<br>\sum</em>{i&#x3D;0}^n{\mathrm{\large C}<em>n^i}^2&#x3D;\mathrm{\large C}</em>{2n}^n<br>$$<br>8、<br>$$<br>\sum_{i&#x3D;0}^n{i\mathrm{\large C}<em>n^i}&#x3D;n2^{n-1}<br>$$<br>9、<br>$$<br>\sum</em>{i&#x3D;0}^n{i^2\mathrm{\large C}<em>n^i}&#x3D;n(n+1)2^{n-2}<br>$$<br>10、<strong>上指标求和法：</strong><br>$$<br>\sum</em>{i&#x3D;0}^n\mathrm{\large C}<em>i^k&#x3D;\mathrm{\large C}</em>{n+1}^{k+1}, \ n,m\geq 0<br>$$<br>11、<br>$$<br>\mathrm{\large C}<em>n^r\mathrm{\large C}<em>r^k&#x3D;\mathrm{\large C}<em>n^k\mathrm{\large C}</em>{n-k}^{r-k}<br>$$<br>12、<br>$$<br>\sum</em>{i&#x3D;0}^n\mathrm{\large C}</em>{n-i}^i&#x3D;{\mathrm{\large Fib}}<em>{n+1}<br>$$<br>13、<br>$$<br>\sum</em>{l&#x3D;0}^n\mathrm{\large C}<em>l^k&#x3D;\mathrm{\large C}</em>{n+1}^{k+1}<br>$$<br>14、<strong>平行求和法：</strong><br>$$<br>\sum_{i&#x3D;1}^n\mathrm{\large C}<em>{k+i}^k&#x3D;\mathrm{\large C}</em>{k+n+1}^n<br>$$<br>15、<br>$$<br>{(x+y)}^k&#x3D;\sum_i{\mathrm{\large C}<em>k^ix^iy^{k-i}}, \ r\in\mathbb{N},\left|\frac{x}{y}\right|&lt;1<br>$$<br>16、<strong>上指标反转：</strong><br>$$<br>\mathrm{\large C}<em>n^m&#x3D;{(-1)}^m\mathrm{\large C}</em>{m-n-1}^n<br>$$<br>17、<strong>范德蒙德卷积：</strong><br>$$<br>\sum_i{\mathrm{\large C}<em>k^{m+i}\mathrm{\large C}<em>s^{n-i}}&#x3D;\mathrm{\large C}</em>{k+x}^{m+n}<br>$$<br>18、<br>$$<br>\sum</em>{-q\leq k\leq l}{\mathrm{\large C}</em>{l-k}^m\mathrm{\large C}<em>{q+k}^n}&#x3D;\mathrm{\large C}</em>{l+q+1}^{m+n+1}, \ l+q,m,n\geq 0<br>$$</p>
<h3 id="杨辉恒等式"><a href="#杨辉恒等式" class="headerlink" title="杨辉恒等式"></a>杨辉恒等式</h3><p>$$<br>\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^m\mathrm{\large C}<em>j^i&#x3D;\sum</em>{i&#x3D;1}\mathrm{\large C}_{m+1}^{i+1}<br>$$</p>
<h3 id="二项式定理"><a href="#二项式定理" class="headerlink" title="二项式定理"></a>二项式定理</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        (a+b)^n&#x3D;&amp;\sum_{k&#x3D;0}^n{\mathrm{\large C}<em>n^ka^kb^{n-k}}\\<br>        (ax+by)^k&#x3D;&amp;\sum</em>{i&#x3D;0}^k\mathrm{\large C}_k^ia^ib^{k-i}x^iy^{k-i}<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="多重集"><a href="#多重集" class="headerlink" title="多重集"></a>多重集</h3><p>$\displaystyle S&#x3D;\bigcup_{i&#x3D;1}^k, \ n&#x3D;\sum_{i&#x3D;1}^k{n_i}$。<br>$S$的全排列个数为：<br>$$<br>\frac{n!}{\displaystyle \prod_{i&#x3D;1}^k{n_i!}}<br>$$<br>从$S$中取出$r$个元素组成一个多重集，产生的不同多重集数量为：<br>$$<br>\begin{cases}<br>    \displaylines{<br>        \displaystyle \mathrm{\large C}<em>{k+r-1}^{k-1} &amp; :r\le n_i,\forall i\in [1,k]\\<br>        \displaystyle \mathrm{\large C}</em>{k+r-1}^{k-1}-\sum_{i&#x3D;1}^k{\mathrm{\large C}<em>{k+r-n_i-2}^{k-1}}+\sum</em>{1\le i&lt;j\le k}{\mathrm{\large C}<em>{k+r-n_i-n_j-3}^{k-1}}-\cdots +\cos{k\pi}\times \mathrm{\large C}</em>{\displaystyle k+r-\sum_{i&#x3D;1}^k{n_i}-(k+1)}^{k-1} &amp; :r\le n<br>    }<br>\end{cases}<br>$$</p>
<h3 id="圆排列"><a href="#圆排列" class="headerlink" title="圆排列"></a>圆排列</h3><p>$$<br>\mathrm{\large Q}^r_n&#x3D;\frac{\mathrm{\large P}^r_n}{r}<br>$$</p>
<h3 id="错排问题"><a href="#错排问题" class="headerlink" title="错排问题"></a>错排问题</h3><p>$1,2,\cdots,n$的错排问题，$i$不在第$i$个位置的排列方法。  </p>
<p>设$f_n$为$n$个不同元素的错排方案。  </p>
<p>$n$先不动，把另外的$n-1$个数错排，方案是：$f_{n-1}$，然后$n$和另外的$n-1$个每一个交换，共有$(n-1)f_{n-1}$种方案。  </p>
<p>$n$和其他的$n-1$个之一交换，其余的$n-2$个错排，共有$(n-1)f_{n-2}$种方案。  </p>
<p>$$<br>\begin{aligned}<br>    \displaylines{<br>        f_n&#x3D;&amp;(n-1)(f_{n-1}+f_{n-2})\\<br>        f_1&#x3D;&amp;0\\<br>        f_2&#x3D;&amp;1\\<br>        f_n&#x3D;&amp;n!\left(\sum_{i&#x3D;2}^n\cos i\pi\frac{1}{i!}\right)<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="Catalan数列"><a href="#Catalan数列" class="headerlink" title="Catalan数列"></a>Catalan数列</h3><p>给定$n$个$0$和$n$个$1$，它们按照某种顺序排成长度为$2n$的序列，满足任意前缀中$0$的个数都不少于$1$的个数的序列的数量为：<br>$$<br>{\mathrm{\large Cat}}<em>n&#x3D;\frac{\mathrm{\large C}</em>{2n}^n}{n+1}<br>$$</p>
<h4 id="推论-3"><a href="#推论-3" class="headerlink" title="推论"></a>推论</h4><p>1、$n$个左括号和$n$个右括号组成的合法括号序列的数量为${\mathrm{\large Cat}}_n$。  </p>
<p>2、$1,2,\cdots,n$经过一个栈，形成的合法出栈序列的数量为${\mathrm{\large Cat}}_n$。  </p>
<p>3、$n$个节点构成的不同二叉树的数量为${\mathrm{\large Cat}}_n$。  </p>
<p>4、在平面直角坐标系上，每一步只能向上或向右走，从$(0,0)$走到$(n,n)$并且除两个端点外不接触直线$y&#x3D;x$的路线数量为$2{\mathrm{\large Cat}}_{n-1}$。  </p>
<p>5、<strong>折线定理</strong>：给定$n$个$1$和$m$个$0$，组成一个字符串，要求在任一的前$k$个字符中，$1$的个数不能少于$0$的个数，字符串数：<br>$$<br>\mathrm{\large C}<em>{n+m}^m-\mathrm{\large C}</em>{n+m}^{m-1}<br>$$</p>
<h3 id="拉格朗日四平方和定理"><a href="#拉格朗日四平方和定理" class="headerlink" title="拉格朗日四平方和定理"></a>拉格朗日四平方和定理</h3><p>每个正整数均可表示为4个整数的平方和。  </p>
<h2 id="容斥原理"><a href="#容斥原理" class="headerlink" title="容斥原理"></a>容斥原理</h2><p>设$S$为一个集合，$S_1,S_2,\cdots ,A_n\subseteq S$。<br>$$<br>\displaylines{<br>    \left| \bigcup_{i&#x3D;1}^n{S_i}\right| &#x3D;\sum_{i&#x3D;1}^n{\vert S_i\vert}-\sum_{i&#x3D;1}^n{\vert S_i\cap S_j\vert }+\sum_{1\le i&lt;j&lt;k\le n}{\vert S_i\cap S_j\cap S_k\vert}+\cdots +\cos{(n+1)\pi}\left| \bigcap_{i&#x3D;1}^n{S_i}\right|\\<br>    \left| \bigcap_{i&#x3D;1}^n{S_i}\right| &#x3D;\sum_{i&#x3D;1}^n{\vert S_i\vert}-\sum_{i&#x3D;1}^n{\vert S_i\cap S_j\vert }+\sum_{1\le i&lt;j&lt;k\le n}{\vert S_i\cap S_j\cap S_k\vert}+\cdots +\cos{(n+1)\pi}\left| \bigcup_{i&#x3D;1}^n{S_i}\right|<br>}<br>$$</p>
<h3 id="加权形式"><a href="#加权形式" class="headerlink" title="加权形式"></a>加权形式</h3><p>设$S$是一个集合，$\forall x\in S$定义权函数$m(x)&gt;0$，$S_1,S_2,\cdots,S_n\subseteq S$。$\displaystyle \forall A\subseteq S,m(A)&#x3D;\sum_{i\in A}m(i), \ \displaystyle Q&#x3D;\bigcup_{i&#x3D;1}^n{i}$。<br>$$<br>\displaylines{<br>    m\left(\bigcup_{i&#x3D;1}^nS_i\right)&#x3D;\sum_{i&#x3D;1}^n\cos(i+1)\pi\sum_{K\subseteq Q,|K|&#x3D;i}m\left(\bigcap_{j\in K}S_i\right)\\<br>    m\left(\bigcap_{i&#x3D;1}^nS_i\right)&#x3D;\sum_{i&#x3D;1}^n\cos(i+1)\pi\sum_{K\subseteq Q,|K|&#x3D;i}m\left(\bigcup_{j\in K}S_i\right)<br>}<br>$$</p>
<h3 id="Mobius函数"><a href="#Mobius函数" class="headerlink" title="Mŏbíus函数"></a>Mŏbíus函数</h3><p>设$N\in\mathbb N^+$按照算术基本定理分解质因数为$N&#x3D;p_1^{c_1}p_2^{c_2}\cdots p_m^{c_m}$，定义函数：<br>$$<br>\mu(n)&#x3D;<br>\begin{cases}<br>    \displaylines{<br>        0 &amp; :\exist i\in[1,m],c_i&gt;1\\<br>          1 &amp; :m\equiv 0(\mod 2),\forall i\in[1,m],c_i&#x3D;1\\<br>           -1 &amp; :m\equiv 1(\mod 2),\forall i\in[1,m],c_i&#x3D;1<br>   }<br>\end{cases}<br>$$</p>
<h3 id="Jordan筛法公式"><a href="#Jordan筛法公式" class="headerlink" title="Jordan筛法公式"></a>Jordan筛法公式</h3><p>设$\displaystyle S_1,S_2,S_3,\cdots,S_n\subseteq S, \ Q&#x3D;\bigcup_{i&#x3D;1}^n{i}$，在$S$中所有恰属于$p$个集合的元素的权和为：<br>$$<br>M_n^p&#x3D;\sum_{i&#x3D;p}^n\cos(i-p)\pi C_i^p\sum_{K\subset Q,|K|&#x3D;k}m\left(\bigcap_{j\in K}S_j\right)<br>$$</p>
<h3 id="Sylvester公式"><a href="#Sylvester公式" class="headerlink" title="Sylvester公式"></a>Sylvester公式</h3><p>设$\displaystyle S_1,S_2,S_3,\cdots,S_n\subseteq S, \ Q&#x3D;\bigcup_{i&#x3D;1}^n{i}$，在$S$中不属于任何集合的元素的权和为：<br>$$<br>M_n^0&#x3D;m(S)+\sum_{K\subseteq Q}\cos |K|\pi m\left(\bigcap_{i\in K}S_i\right)<br>$$</p>
<h2 id="康托展开"><a href="#康托展开" class="headerlink" title="康托展开"></a>康托展开</h2><p>（树状数组优化）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;-x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> pos)</span></span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(pos&gt;<span class="number">0</span>)</span><br><span class="line">		ret+=tree[pos],</span><br><span class="line">		pos-=<span class="built_in">lowbit</span>(pos);</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> pos)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(pos&lt;=n)</span><br><span class="line">		tree[pos]++,</span><br><span class="line">		pos+=<span class="built_in">lowbit</span>(pos);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">cantor</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	ans=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(tree,<span class="number">0</span>,<span class="built_in">sizeof</span>(tree));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> j=n;j&gt;=<span class="number">1</span>;t[j--]=<span class="built_in">read</span>());</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		ans+=<span class="number">1ll</span>*fac[i<span class="number">-1</span>]*<span class="built_in">ask</span>(t[i]);</span><br><span class="line">		<span class="built_in">add</span>(t[i]);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> ans+<span class="number">1</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="逆康托展开"><a href="#逆康托展开" class="headerlink" title="逆康托展开"></a>逆康托展开</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> fac[]=&#123;...&#125;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;v,a;<span class="comment">//存放当前可选数、所求排列组合</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a&lt;b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decantor</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    tmp=<span class="built_in">read</span>()<span class="number">-1</span>;</span><br><span class="line">	v.<span class="built_in">clear</span>();</span><br><span class="line">	a.<span class="built_in">clear</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;v.<span class="built_in">push_back</span>(j++));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--)&#123;</span><br><span class="line">        t=x/fac[i<span class="number">-1</span>],</span><br><span class="line">        x=r=x%fac[i<span class="number">-1</span>];</span><br><span class="line">        <span class="built_in">sort</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">        a.<span class="built_in">push_back</span>(v.<span class="built_in">at</span>(t));</span><br><span class="line">        v.<span class="built_in">erase</span>(v.<span class="built_in">begin</span>()+t);</span><br><span class="line">    &#125;;</span><br><span class="line">    for_each(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>(),f);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Prufer序列"><a href="#Prufer序列" class="headerlink" title="Prüfer序列"></a>Prüfer序列</h2><h3 id="对树建立Prufer序列"><a href="#对树建立Prufer序列" class="headerlink" title="对树建立Prüfer序列"></a>对树建立Prüfer序列</h3><p>1、找到编号最小的度数为$1$的点。<br>2、删除该节点并在序列中添加与该节点相连的节点的编号。<br>3、重复$1,2$操作，直到整棵树只剩下两个节点。  </p>
<h4 id="线性构造"><a href="#线性构造" class="headerlink" title="线性构造"></a>线性构造</h4><p>指针指向编号最小的叶节点。每次删掉它之后，如果产生了新的叶节点且编号比指针指向的更小，则直接继续删掉，否则自增找到下一个编号最小的叶节点。  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tp</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)</span><br><span class="line">		fa[i]=<span class="built_in">read</span>(),</span><br><span class="line">		cnt[fa[i]]++;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++,j++)&#123;</span><br><span class="line">		<span class="keyword">while</span>(cnt[j]!=<span class="number">0</span>)</span><br><span class="line">			j++;</span><br><span class="line">		pr[i]=fa[j];</span><br><span class="line">		<span class="keyword">while</span>((i&lt;=n<span class="number">-2</span>)&amp;&amp;(--cnt[pr[i]]==<span class="number">0</span>)&amp;&amp;(pr[i]&lt;j))</span><br><span class="line">			pr[i+<span class="number">1</span>]=fa[pr[i]],</span><br><span class="line">			i++;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-2</span>;i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,pr[i]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="用Prufer序列重建树"><a href="#用Prufer序列重建树" class="headerlink" title="用Prüfer序列重建树"></a>用Prüfer序列重建树</h3><p>1、每次取出Prüfer序列中最前面的元素$u$。<br>2、在点集中找到编号最小的没有在Prüfer序列中出现的元素$v$。<br>3、给$u,v$连边然后分别删除。<br>4、最后在点集中剩下两个节点，给它们连边。  </p>
<h4 id="线性重建"><a href="#线性重建" class="headerlink" title="线性重建"></a>线性重建</h4><p>指针指向编号最小的度数为$1$的节点。每次将它与当前枚举到的Prüfer序列的点连接之后，如果产生了新的度数为$1$的节点且编号比指针指向的更小，则直接继续将它与下一个Prüfer序列的点连接，否则自增找到下一个编号最小的度数为$1$的节点。  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pt</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-2</span>;i++)</span><br><span class="line">		pr[i]=<span class="built_in">read</span>(),</span><br><span class="line">		cnt[pr[i]]++;</span><br><span class="line">	pr[n<span class="number">-1</span>]=n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++,j++)&#123;</span><br><span class="line">		<span class="keyword">while</span>(cnt[j]!=<span class="number">0</span>)</span><br><span class="line">			j++;</span><br><span class="line">		fa[j]=pr[i];</span><br><span class="line">		<span class="keyword">while</span>((i&lt;=n<span class="number">-1</span>)&amp;&amp;(--cnt[pr[i]]==<span class="number">0</span>)&amp;&amp;(pr[i]&lt;j))</span><br><span class="line">			fa[pr[i]]=pr[i+<span class="number">1</span>],</span><br><span class="line">			i++;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,fa[i]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h3><p>1、在构造完Prüfer序列后原树中会剩下两个结点，其中一个一定是编号最大的点$n$。  </p>
<p>2、每个结点在序列中出现的次数是其度数$-1$。（没有出现的就是叶结点）  </p>
<p>3、一棵$n$个节点的无根树唯一地对应了一个长度为$n-2$的数列，数列中的每个数都在$[1,n]$。  </p>
<p>4、$n$个点的无向完全图的生成树的计数：$n^{(n−2)}$，即$n$个点的有标号无根树的计数。  </p>
<p>5、$n$个节点的度依次为$d_1,d_2,\cdots,d_n$的无根树共有$\displaystyle \frac{(n-2)!}{\displaystyle \prod_{i&#x3D;1}^n{(d_i-1)!}}$个，因为此时Prüfer编码中的数字$i$恰好出现$d_i−1$次，$(n−2)!$是总排列数。  </p>
<p>6、$n$个点的有标号有根树的计数：<br>$$<br>n^{(n−2)}\times n&#x3D;n^{(n−1)}<br>$$</p>
<h3 id="图连通方案数"><a href="#图连通方案数" class="headerlink" title="图连通方案数"></a>图连通方案数</h3><p>一个$n$个点$m$条边的带标号无向图有$k$个连通块。设$s_i$表示每个连通块的数量。我们希望添加$k-1$条边使得整个图连通。方案数：<br>$$<br>n^{k-2}\prod_{i&#x3D;1}^k{s_i}<br>$$</p>
<h3 id="Cayley公式"><a href="#Cayley公式" class="headerlink" title="Cayley公式"></a>Cayley公式</h3><p>完全图$K_n$有$n^{n-2}$棵生成树。$n^{n-1}$棵有根树。  </p>
<h2 id="线性空间"><a href="#线性空间" class="headerlink" title="线性空间"></a>线性空间</h2><p><strong>线性空间</strong> 是一个关于以下两个运算封闭的向量集合：<br>1、向量加法$\overrightarrow a+\overrightarrow b$。<br>2、标量乘法（数乘运算）$k\overrightarrow a$。  </p>
<p>给定$\overrightarrow{a_1},\overrightarrow{a_2},\cdots ,\overrightarrow{a_k}$，若$\overrightarrow b$能由$\overrightarrow{a_1},\overrightarrow{a_2},\cdots ,\overrightarrow{a_k}$经过向量加法和标量乘法运算得出，则称$\overrightarrow b$能被$\overrightarrow{a_1},\overrightarrow{a_2},\cdots ,\overrightarrow{a_k}$<strong>表出</strong> 。   </p>
<p>$\overrightarrow{a_1},\overrightarrow{a_2},\cdots ,\overrightarrow{a_k}$能表出的所有向量构成一个线性空间，$\overrightarrow{a_1},\overrightarrow{a_2},\cdots ,\overrightarrow{a_k}$被称为这个线性空间的<strong>生成子集</strong> 。  </p>
<p>任意选出线性空间中的若干个向量，如果其中存在一个向量能被其他向量表出，则称这些向量<strong>线性相关</strong> ，否则称这些向量<strong>线性无关</strong> 。  </p>
<p>线性无关的生成子集（或线性空间的极大线性无关子集）被称为线性空间的<strong>基底</strong> （<strong>基</strong> ）。一个线性空间的所有基包含的向量个数都相等，这个数被称为线性空间的<strong>维数</strong> 。  </p>
<p>对于一个$n$行$m$列的矩阵，我们把它的每一行看作一个长度为$m$的向量（<strong>行向量</strong> ）。矩阵的$n$个行向量能够表出的所有向量构成一个一维线性空间，这个线性空间的维数称为矩阵的<strong>行秩</strong> 。矩阵的行秩一定等于列秩，它们都被称为矩阵的<strong>秩</strong> 。  </p>
<p>若$b\in\mathbb Z$能由$a_1,a_2,\cdots ,a_k\in\mathbb Z$经异或运算得出，则称$b$能被$a_1,a_2,\cdots ,a_k$<strong>表出</strong> 。  </p>
<p>$a_1,a_2,\cdots ,a_k$能表出的所有证书构成一个异或空间，$a_1,a_2,\cdots ,a_k$被称为这个异或空间的<strong>生成子集</strong> 。  </p>
<p>任意选出异或空间中的若干个整数，如果其中存在一个整数能被其他整数表出，则称这些整数<strong>线性相关</strong> ，否则称这些整数<strong>线性无关</strong> 。异或空间的<strong>基</strong> 就是异或空间中一个线性无关的生成子集（或异或空间的极大线性无关子集）。  </p>
<h3 id="线性基"><a href="#线性基" class="headerlink" title="线性基"></a>线性基</h3><p>若$b\in\mathbb Z$能由$a_1,a_2,\cdots ,a_k\in\mathbb Z$经异或运算得出，则称$b$能被$a_1,a_2,\cdots ,a_k$<strong>表出</strong> 。  </p>
<p>$a_1,a_2,\cdots ,a_k$能表出的所有证书构成一个异或空间，$a_1,a_2,\cdots ,a_k$被称为这个异或空间的<strong>生成子集</strong> 。  </p>
<p>任意选出异或空间中的若干个整数，如果其中存在一个整数能被其他整数表出，则称这些整数<strong>线性相关</strong> ，否则称这些整数<strong>线性无关</strong> 。异或空间的<strong>基</strong> 就是异或空间中一个线性无关的生成子集（或异或空间的极大线性无关子集）。  </p>
<h4 id="性质-2"><a href="#性质-2" class="headerlink" title="性质"></a>性质</h4><p>1、线性基的元素能相互异或得到原集合的元素的所有相互异或得到的值。<br>2、线性基是满足性质1的最小的集合。<br>3、线性基没有异或和为$0$的子集。<br>4、线性基中每个元素的异或方案唯一，也就是说，线性基中不同的异或组合异或出的数都是不一样的。<br>5、线性基中每个元素的二进制最高位互不相同。  </p>
<h4 id="构造"><a href="#构造" class="headerlink" title="构造"></a>构造</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">51</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">		<span class="keyword">if</span>((x&gt;&gt;i)==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(p[i]==<span class="number">0</span>)&#123;</span><br><span class="line">			p[i]=x;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		x^=p[i];</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	a[i]=<span class="built_in">read</span>();</span><br><span class="line">	<span class="built_in">add</span>(a[i]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="查询异或最大值"><a href="#查询异或最大值" class="headerlink" title="查询异或最大值"></a>查询异或最大值</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">query_min</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">51</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		ans=<span class="built_in">max</span>(ans,ans^p[i]);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="求可异或出的数的个数"><a href="#求可异或出的数的个数" class="headerlink" title="求可异或出的数的个数"></a>求可异或出的数的个数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">51</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">		<span class="keyword">if</span>((x&gt;&gt;i)==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(p[i]==<span class="number">0</span>)&#123;</span><br><span class="line">			p[i]=x,</span><br><span class="line">			cnt++;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		x^=p[i];</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	a[i]=<span class="built_in">read</span>();</span><br><span class="line">	<span class="built_in">add</span>(a[i]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(<span class="number">1LL</span>&lt;&lt;cnt)%md);</span><br></pre></td></tr></table></figure>

<h2 id="不等式"><a href="#不等式" class="headerlink" title="不等式"></a>不等式</h2><h3 id="均值不等式"><a href="#均值不等式" class="headerlink" title="均值不等式"></a>均值不等式</h3><p>$a_i\geq 0, \ \forall i\in[1,n]$<br><strong>平方平均数：</strong> $\displaystyle Q_n&#x3D;\sqrt{\frac{\displaystyle \sum_{i&#x3D;1}^n{a_i^2}}{n}}$<br><strong>算术平均数：</strong> $\displaystyle A_n&#x3D;\frac{\displaystyle \sum_{i&#x3D;1}^n{a_i}}{n}$<br><strong>几何平均数：</strong> $\displaystyle G_n&#x3D;\sqrt[n]{\prod_{i&#x3D;1}^na_i}$<br><strong>调和平均数：</strong> $\displaystyle H_n&#x3D;\frac{n}{\displaystyle \sum_{i&#x3D;1}^n{\frac{1}{a_i}}}$<br><strong>“调几算方”：</strong> $H_n\leq G_n\leq A_n\leq Q_n$<br><strong>取等条件：</strong> $a_i&#x3D;0, \ \forall i\in[1,n]\Rightarrow Q_n&#x3D;A_n&#x3D;G_n&#x3D;H_n$  </p>
<h3 id="Cauchy不等式"><a href="#Cauchy不等式" class="headerlink" title="Cauchy不等式"></a>Cauchy不等式</h3><p>$$<br>\sum_{i&#x3D;1}^n{a_i^2}\sum_{i&#x3D;1}^n{b_i^2}\geq{\left(\sum_{i&#x3D;1}^n{a_ib_i}\right)}^2<br>$$</p>
<h4 id="取等条件："><a href="#取等条件：" class="headerlink" title="取等条件："></a>取等条件：</h4><p>$$<br>a_i&#x3D;kb_i, \ i\in[1,n]<br>$$</p>
<h4 id="推论-4"><a href="#推论-4" class="headerlink" title="推论"></a>推论</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \frac{\displaystyle\sum_{i&#x3D;1}^na_i}{n}&amp;\leq\sqrt{\frac{\displaystyle\sum_{i&#x3D;1}^na_i^2}{n}}\\<br>        \sum_{i&#x3D;1}^n\frac{x_i^2}{y_i}&amp;\geq\frac{\displaystyle\left(\sum_{i&#x3D;1}^nx_i\right)^2}{\displaystyle\sum_{i&#x3D;1}^ny_i}<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="排列不等式"><a href="#排列不等式" class="headerlink" title="排列不等式"></a>排列不等式</h3><p>$\forall i,j\in[1,n], \ i,j\in\mathbb Z, \ i&lt;j, \ a_i\leq a_j, \ b_i\leq b_j$，$d_1,d_2,\cdots,d_n$是$1\sim n$的任意一个排列。<br>$$<br>\sum_{i&#x3D;1}^n{a_ib_{n-i+1}}\leq\sum_{i&#x3D;1}^n{a_ib_{d_i}}\leq\sum_{i&#x3D;1}^n{a_ib_i}<br>$$</p>
<h2 id="和式"><a href="#和式" class="headerlink" title="和式"></a>和式</h2><h3 id="和式处理"><a href="#和式处理" class="headerlink" title="和式处理"></a>和式处理</h3><p>设$K$是一个有限整数集合（指标集） 。<br><strong>分配率：</strong> $\displaystyle \sum_{k\in K}{ca_k}&#x3D;c\sum_{k\in K}{a_k}$  </p>
<p><strong>结合律：</strong> $\displaystyle \sum_{k\in K}{(a_k+b_k)}&#x3D;\sum_{k\in K}{a_k}+\sum_{k\in K}{b_k}$  </p>
<p><strong>交换律：</strong> $\displaystyle \sum_{k\in K}{a_k}&#x3D;\sum_{\pi(k)\in K}{a_{\pi(k)}}$  </p>
<h3 id="扰动法"><a href="#扰动法" class="headerlink" title="扰动法"></a>扰动法</h3><p>将头尾两项分离并试图得出一个关于$S$的方程的方法称为扰动法。<br>求等比数列的和$\displaystyle S&#x3D;\sum_{0\leq k&lt;n}{x^k}$：<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        S&#x3D; &amp; x^0-x^n+\sum_{1\leq k\leq n}{x^k}\\<br>        &#x3D; &amp; x^0-x^n+xS<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="交换求和顺序"><a href="#交换求和顺序" class="headerlink" title="交换求和顺序"></a>交换求和顺序</h3><p>$$<br>\sum_i\sum_j{a_{i,j}}[P(i,j)]&#x3D;\sum_j\sum_i{a_{i,j}}[P(i,j)]<br>$$</p>
<h3 id="三角求和"><a href="#三角求和" class="headerlink" title="三角求和"></a>三角求和</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>    &amp;\sum_{1\leq i\leq j\leq n}{a_ia_j}+\sum_{1\leq j\leq i\leq n}{a_ia_j}\\<br>    &#x3D;&amp;2S\\<br>    &#x3D;&amp;\left(\sum_{i&#x3D;1}^n{a_i}\right)\left(\sum_{j&#x3D;1}^n{a_j}\right)+\sum_{i&#x3D;1}^n{a_i^2}<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="换元"><a href="#换元" class="headerlink" title="换元"></a>换元</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        H_n&#x3D;&amp;\sum_{i&#x3D;1}^n{\frac{1}{i}}\\<br>        \sum_{1\leq j&lt;k\leq n}{\frac{1}{k-j}}&#x3D;&amp;\sum_{i&#x3D;1}^{n-1}{H_i}<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="下降幂"><a href="#下降幂" class="headerlink" title="下降幂"></a>下降幂</h3><p>$$<br>r^{\underline{k}}&#x3D;r(r-1)(r-2)\cdots(r-k+1)<br>$$</p>
<h3 id="二项式系数"><a href="#二项式系数" class="headerlink" title="二项式系数"></a>二项式系数</h3><p>$$<br>C_r^k&#x3D;<br>\begin{cases}<br>    \displaylines{<br>        \displaystyle \frac{r^{\underline{k}}}{k!} &amp; :k\geq 0\\<br>        0 &amp; :k&lt;0<br>    }<br>\end{cases}<br>$$</p>
<h2 id="生成函数"><a href="#生成函数" class="headerlink" title="生成函数"></a>生成函数</h2><h3 id="形式幂级数"><a href="#形式幂级数" class="headerlink" title="形式幂级数"></a>形式幂级数</h3><p>对于无限数列（缺项补0） ${f_0,f_1,\cdots}$，其对应的<strong>形式幂级数</strong> 为：<br>$$<br>F(x)&#x3D;\sum_{i\geq 0}{f_ix^i}<br>$$</p>
<h3 id="求导"><a href="#求导" class="headerlink" title="求导"></a>求导</h3><p>定义$f(x)$的导函数为$\displaystyle f’(x)&#x3D;\lim_{h\rightarrow 0}{\frac{f(x+h)-f(x)}{h}}$。   </p>
<p>求$k$次导函数得到的结果记为$f^{(k)}$。如果使用求导算子$D$ 也可以写成$D^kf$。<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        (x^{\alpha})’&#x3D;&amp;\alpha x^{\alpha -1}\\<br>        (\ln x)’&#x3D;&amp;\frac{1}{x}\\<br>        (e^x)’&#x3D;&amp;e^x<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="复杂函数求导"><a href="#复杂函数求导" class="headerlink" title="复杂函数求导"></a>复杂函数求导</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        (f+g)’&#x3D;&amp;f’+g’\\<br>        (fg)’&#x3D;&amp;f’g+fg’\\<br>        (f(g))’&#x3D;&amp;f’(g)g’<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="替代算子"><a href="#替代算子" class="headerlink" title="替代算子"></a>替代算子</h3><p>$$<br>\vartheta f(x)&#x3D;xf’(x)<br>$$</p>
<h3 id="常见幂级数"><a href="#常见幂级数" class="headerlink" title="常见幂级数"></a>常见幂级数</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \sum_{i\geq 0}{C_{i+k-1}^ix^i}&#x3D;&amp;\frac{1}{(1-x)^k}\\<br>        \ln\frac{1}{1-x}&#x3D;&amp;\sum_{i\geq 1}{\frac{x^i}{i}}\\<br>        e^x&#x3D;&amp;\sum_{i\geq 0}{\frac{x^i}{i!}}<br>    }<br>\end{aligned}<br>$$</p>
<h2 id="高阶差分"><a href="#高阶差分" class="headerlink" title="高阶差分"></a>高阶差分</h2><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \Delta f(x)&#x3D; &amp; f(x+1)-f(x)\\<br>        \Delta^2 f(x)&#x3D; &amp; \Delta f(x+1)-\Delta f(x)\\<br>        &#x3D; &amp; f(x+2)-2f(x+1)+f(x)\\<br>        \Delta^n f(x)&#x3D; &amp; \sum_i\mathrm{\large C}_n^i{(-1)}^{n-i}f(x+i)<br>    }<br>\end{aligned}<br>$$</p>
<h2 id="0-1分数规划"><a href="#0-1分数规划" class="headerlink" title="0&#x2F;1分数规划"></a>0&#x2F;1分数规划</h2><p>给定整数$a_1,a_2,\cdots ,a_n$以及$b_1,b_2,\cdots ,b_n$，求一组解$x_i,1\leq i\leq n,x_i\in{0,1}$，使下式最大化：<br>$$<br>\frac{\displaystyle \sum_{i&#x3D;1}^na_ix_i}{\displaystyle \sum_{i&#x3D;1}^nb_ix_i}<br>$$</p>
<p>$$<br>\displaylines{<br>    \sum_{i&#x3D;1}^n(a_i-Lb_i)x_i\geq 0\\<br>    \Downarrow\\<br>    \left(\sum_{i&#x3D;1}^na_ix_i\right)-L\sum_{i&#x3D;1}^nb_ix_i\geq 0\\<br>    \Downarrow\\<br>    \frac{\displaystyle \sum_{i&#x3D;1}^na_ix_i}{\displaystyle \sum_{i&#x3D;1}^nb_ix_i}\geq L<br>}<br>$$</p>
<p>$$<br>\begin{cases}<br>    \displaylines{<br>        \frac{\displaystyle \sum_{i&#x3D;1}^na_ix_i}{\displaystyle \sum_{i&#x3D;1}^nb_ix_i}\geq L &amp; :\displaystyle \exist {x_1,x_2,\cdots ,x_n},\sum_{i&#x3D;1}^n(a_i-Lb_i)x_i\geq 0\\<br>        \frac{\displaystyle \sum_{i&#x3D;1}^na_ix_i}{\displaystyle \sum_{i&#x3D;1}^nb_ix_i}&lt;L &amp; :\displaystyle \forall {x_1,x_2,\cdots ,x_n},\sum_{i&#x3D;1}^n(a_i-Lb_i)x_i&lt;0<br>    }<br>\end{cases}<br>$$</p>
<h3 id="二分法"><a href="#二分法" class="headerlink" title="二分法"></a>二分法</h3><p>二分一个$mid$然后判定图上是否存在一个环$S$  </p>
<p>使得$\displaystyle \frac{\displaystyle \sum_{i&#x3D;1}^ta_{v_i}}{\displaystyle \sum_{i&#x3D;1}^tb_{e_i}}&gt;mid$。  </p>
<p>即该环是否满足$\displaystyle \sum_{i&#x3D;1}^t(a_{v_i}-mid\times b_{e_i})&gt;0$。  </p>
<p>若是则$l&#x3D;mid$，否则$r&#x3D;mid$。  </p>
<p>但是这样在图中判定显然很麻烦，所以我们试着把上式两边同时乘$-1$。  </p>
<p>变成$\displaystyle \sum_{i&#x3D;1}^t(mid\times b_{e_i}-a_{v_i})&lt;0$。  </p>
<p>这样我们就把问题转化成了判定图中<strong>是否存在负环</strong>。  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">chk</span><span class="params">(<span class="type">const</span> <span class="type">double</span> val)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line">	<span class="built_in">memset</span>(vis,<span class="literal">true</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">	<span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">	q.<span class="built_in">clear</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		q.<span class="built_in">push_back</span>(i);</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop_front</span>();</span><br><span class="line">		vis[rec]=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=nxt[i])</span><br><span class="line">			<span class="keyword">if</span>(dis[ver[i]]&gt;dis[rec]+val*(<span class="type">double</span>)edge[i]-(<span class="type">double</span>)f[rec])&#123;</span><br><span class="line">				dis[ver[i]]=dis[rec]+val*(<span class="type">double</span>)edge[i]-(<span class="type">double</span>)f[rec];</span><br><span class="line">				<span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)&#123;</span><br><span class="line">					vis[ver[i]]=<span class="literal">true</span>;</span><br><span class="line">					<span class="keyword">if</span>((q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&amp;&amp;(dis[ver[i]]&lt;dis[q.<span class="built_in">front</span>()]))</span><br><span class="line">						q.<span class="built_in">push_front</span>(ver[i]);</span><br><span class="line">					<span class="keyword">else</span></span><br><span class="line">						q.<span class="built_in">push_back</span>(ver[i]);</span><br><span class="line">					cnt[ver[i]]++;</span><br><span class="line">					<span class="keyword">if</span>(cnt[ver[i]]==n+<span class="number">1</span>)</span><br><span class="line">						<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				&#125;;</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line">l=<span class="number">0</span>,r=...;</span><br><span class="line"><span class="keyword">while</span>(r-l&gt;EPS)&#123;</span><br><span class="line">	mid=(l+r)/<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">chk</span>(mid)==<span class="literal">true</span>)</span><br><span class="line">		l=mid,</span><br><span class="line">		ans=l;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		r=mid;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>,ans);</span><br></pre></td></tr></table></figure>

<h2 id="导数"><a href="#导数" class="headerlink" title="导数"></a>导数</h2><table>
<thead>
<tr>
<th align="left">函数</th>
<th align="center">原函数</th>
<th align="center">导函数</th>
</tr>
</thead>
<tbody><tr>
<td align="left">常函数</td>
<td align="center">$y&#x3D;C$</td>
<td align="center">$y’&#x3D;0$</td>
</tr>
<tr>
<td align="left">指数函数</td>
<td align="center">$y&#x3D;a^x\y&#x3D;e^x$</td>
<td align="center">$y’&#x3D;a^x\ln a\y’&#x3D;e^x$</td>
</tr>
<tr>
<td align="left">幂函数</td>
<td align="center">$y&#x3D;x^n$</td>
<td align="center">$y’&#x3D;nx^{n-1}$</td>
</tr>
<tr>
<td align="left">对数函数</td>
<td align="center">$y&#x3D;\log_ax\y&#x3D;\ln x$</td>
<td align="center">$\displaystyle y’&#x3D;\frac{1}{x\ln a}\y’&#x3D;\frac{1}{x}$</td>
</tr>
<tr>
<td align="left">正弦函数</td>
<td align="center">$y&#x3D;\sin x$</td>
<td align="center">$y’&#x3D;\cos x$</td>
</tr>
<tr>
<td align="left">余弦函数</td>
<td align="center">$y&#x3D;\cos x$</td>
<td align="center">$y’&#x3D;-\sin x$</td>
</tr>
<tr>
<td align="left">正切函数</td>
<td align="center">$y&#x3D;\tan x$</td>
<td align="center">$y’&#x3D;\sec^2x$</td>
</tr>
<tr>
<td align="left">余切函数</td>
<td align="center">$y&#x3D;\cot x$</td>
<td align="center">$y’&#x3D;-\csc^2x$</td>
</tr>
<tr>
<td align="left">正割函数</td>
<td align="center">$y&#x3D;\sec x$</td>
<td align="center">$y’&#x3D;\sec x\tan x$</td>
</tr>
<tr>
<td align="left">余割函数</td>
<td align="center">$y&#x3D;\csc x$</td>
<td align="center">$y’&#x3D;-\csc x\cot x$</td>
</tr>
<tr>
<td align="left">反正弦函数</td>
<td align="center">$y&#x3D;\arcsin x$</td>
<td align="center">$\displaystyle y’&#x3D;\frac{1}{\sqrt{1-x^2}}$</td>
</tr>
<tr>
<td align="left">反余弦函数</td>
<td align="center">$y&#x3D;\arccos x$</td>
<td align="center">$\displaystyle y’&#x3D;-\frac{1}{\sqrt{1-x^2}}$</td>
</tr>
<tr>
<td align="left">反正切函数</td>
<td align="center">$y&#x3D;\arctan x$</td>
<td align="center">$\displaystyle y’&#x3D;\frac{1}{1+x^2}$</td>
</tr>
<tr>
<td align="left">反余切函数</td>
<td align="center">$y&#x3D;\mathrm{arccot} \ x$</td>
<td align="center">$\displaystyle y’&#x3D;-\frac{1}{1+x^2}$</td>
</tr>
<tr>
<td align="left">双曲线函数</td>
<td align="center">$y&#x3D;\sh x$</td>
<td align="center">$y’&#x3D;\ch x$</td>
</tr>
</tbody></table>
<h3 id="四则运算"><a href="#四则运算" class="headerlink" title="四则运算"></a>四则运算</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        (u\pm v)’&#x3D;&amp;u’\pm v’\\<br>        (uv)’&#x3D;&amp;u’v+uv’\\<br>        \left(\frac{u}{v}\right)&#x3D;&amp;\frac{u’v-uv’}{v^2}<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="牛顿-莱布尼茨公式"><a href="#牛顿-莱布尼茨公式" class="headerlink" title="牛顿-莱布尼茨公式"></a>牛顿-莱布尼茨公式</h3><p>$$<br>\int_a^bf(x)\mathrm dx&#x3D;F(b)-F(a)&#x3D;\left.F(x)\right|_a^b<br>$$</p>
<h3 id="l’Hopital’s法则"><a href="#l’Hopital’s法则" class="headerlink" title="l’Hôpital’s法则"></a>l’Hôpital’s法则</h3><p>$$<br>\lim\frac{f(x)}{g(x)}&#x3D;\lim\frac{f’(x)}{g’(x)}<br>$$</p>
<h2 id="斐波那契数列"><a href="#斐波那契数列" class="headerlink" title="斐波那契数列"></a>斐波那契数列</h2><p>定义：$\mathrm{\large F}_0&#x3D;0,\mathrm{\large F}<em>1&#x3D;1,\mathrm{\large F}<em>n&#x3D;\mathrm{\large F}</em>{n-1}+\mathrm{\large F}</em>{n-2}$  </p>
<h3 id="卢卡斯数列"><a href="#卢卡斯数列" class="headerlink" title="卢卡斯数列"></a>卢卡斯数列</h3><p>定义：$\mathrm{\large L}_0&#x3D;2,\mathrm{\large L}<em>1&#x3D;1,\mathrm{\large L}<em>n&#x3D;\mathrm{\large L}</em>{n-1}+\mathrm{\large L}</em>{n-2}$  </p>
<h3 id="通项公式"><a href="#通项公式" class="headerlink" title="通项公式"></a>通项公式</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \mathrm{\large F}_n&#x3D;&amp;\frac{\left(\frac{1+\sqrt 5}{2}\right)^n-\left(\frac{1-\sqrt 5}{2}\right)^n}{\sqrt 5}&#x3D;\left[\frac{\left(\frac{1+\sqrt 5}{2}\right)^n}{\sqrt 5}\right]（比内公式）\\<br>        \mathrm{\large L}_n&#x3D;&amp;\left(\frac{1+\sqrt 5}{2}\right)^n+\left(\frac{1-\sqrt 5}{2}\right)^n\<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="矩阵形式"><a href="#矩阵形式" class="headerlink" title="矩阵形式"></a>矩阵形式</h3><p>$$<br>\displaylines{<br>    \begin{aligned}<br>        \left[<br>            \begin{matrix}<br>                \mathrm{\large F}<em>{n-1} &amp; \mathrm{\large F}<em>n<br>            \end{matrix}<br>        \right]<br>        &#x3D;&amp;<br>        \left[<br>            \begin{matrix}<br>                \mathrm{\large F}</em>{n-2} &amp; \mathrm{\large F}</em>{n-1}<br>            \end{matrix}<br>        \right]<br>        \times<br>        \left[<br>            \begin{matrix}<br>                0 &amp; 1\<br>                1 &amp; 1<br>            \end{matrix}<br>        \right]\<br>        P&#x3D;&amp;\left[<br>            \begin{matrix}<br>                0 &amp; 1\<br>                1 &amp; 1<br>            \end{matrix}<br>        \right]\<br>        \left[<br>            \begin{matrix}<br>                \mathrm{\large F}<em>n &amp; \mathrm{\large F}</em>{n+1}<br>            \end{matrix}<br>        \right]&#x3D;&amp;\left[<br>            \begin{matrix}<br>                \mathrm{\large F}_0 &amp; \mathrm{\large F}_1<br>            \end{matrix}<br>    \right]<br>    \times P^n<br>    \end{aligned}<br>}<br>$$</p>
<h3 id="快速倍增法"><a href="#快速倍增法" class="headerlink" title="快速倍增法"></a>快速倍增法</h3><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \mathrm{\large F}<em>{2k}&#x3D;&amp;\mathrm{\large F}<em>k(2\mathrm{\large F}</em>{k+1}-\mathrm{\large F}<em>k)\\<br>        \mathrm{\large F}</em>{2k+1}&#x3D;&amp;\mathrm{\large F}</em>{k+1}^2+\mathrm{\large F}_k^2<br>    }<br>\end{aligned}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; <span class="title">fib</span><span class="params">(<span class="type">const</span> <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="number">0</span>,<span class="number">1</span>&#125;;</span><br><span class="line">    pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; p=<span class="built_in">fib</span>(n&gt;&gt;<span class="number">1</span>);</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> c=p.first*(<span class="number">2</span>*p.second-p.first),d=p.first*p.rist+p.second*p.second;</span><br><span class="line">    <span class="keyword">if</span>(n&amp;<span class="number">1</span>==<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;d,c+d&#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;c,d&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="性质-3"><a href="#性质-3" class="headerlink" title="性质"></a>性质</h3><p>1、卡西尼性质：$\mathrm{\large F}<em>{n-1}\mathrm{\large F}</em>{n+1}-\mathrm{\large F}_n^2&#x3D;{(-1)}^n$  </p>
<p>2、附加性质：$\mathrm{\large F}<em>{n+k}&#x3D;\mathrm{\large F}<em>k\mathrm{\large F}</em>{n+1}+\mathrm{\large F}</em>{k-1}\mathrm{\large F}<em>n$（当$k&#x3D;n$时：$\mathrm{\large F}</em>{2n}&#x3D;\mathrm{\large F}<em>n(\mathrm{\large F}</em>{n+1}+\mathrm{\large F}_{n-1})$，且$\forall k\in\mathbb N,\mathrm{\large F}<em>n\mid \mathrm{\large F}</em>{nk}$）  </p>
<p>3、GCD性质：$\gcd(\mathrm{\large F}_m,\mathrm{\large F}<em>n)&#x3D;\mathrm{\large F}</em>{\gcd(m,n)}$  </p>
<h2 id="数列"><a href="#数列" class="headerlink" title="数列"></a>数列</h2><h3 id="等差数列（A-P-）"><a href="#等差数列（A-P-）" class="headerlink" title="等差数列（A.P.）"></a>等差数列（A.P.）</h3><h4 id="通项公式-1"><a href="#通项公式-1" class="headerlink" title="通项公式"></a>通项公式</h4><p>$$<br>\displaylines{<br>    a_n&#x3D;a_1+(n-1)d\\<br>    \begin{cases}<br>        a_1&#x3D;S_1 &amp; :n&#x3D;1\\<br>        a_n&#x3D;S_n-S_{n-1} &amp; :n\geq 2<br>    \end{cases}<br>}<br>$$</p>
<h4 id="等差中项"><a href="#等差中项" class="headerlink" title="等差中项"></a>等差中项</h4><p>$$<br>A&#x3D;\frac{a+b}{2}<br>$$</p>
<h4 id="前-n-项和"><a href="#前-n-项和" class="headerlink" title="前$n$项和"></a>前$n$项和</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        S_n&#x3D;&amp;n\frac{a_1+a_n}{2}\\<br>        S_{2n-1}&#x3D;&amp;(2n-1)a_n\\<br>        S_{2n+1}&#x3D;&amp;(2n+1)a_{n+1}<br>    }<br>\end{aligned}<br>$$</p>
<h4 id="性质-4"><a href="#性质-4" class="headerlink" title="性质"></a>性质</h4><p>1、$\forall a_m,a_n, \ a_n&#x3D;a_m+(n-m)d$  </p>
<p>2、$a_1+a_n&#x3D;a_2+a_{n-1}&#x3D;a_3+a_{n-2}&#x3D;\cdots &#x3D;a_k+a_{n-k+1},k\in\mathbb{N^+}$  </p>
<p>3、$m,n,p,q\in\mathbb{N^+}, \ m+n&#x3D;p+q$，有$a_m+a_n&#x3D;a_p+a_q$。  </p>
<p>4、$\forall k\in\mathbb{N^+}$，有$S_k,S_{2k}-S_k,\cdots ,S_{nk}-S_{(n-1)k}$成等差数列。  </p>
<h3 id="等比数列（G-P-）"><a href="#等比数列（G-P-）" class="headerlink" title="等比数列（G.P.）"></a>等比数列（G.P.）</h3><h4 id="等比中项"><a href="#等比中项" class="headerlink" title="等比中项"></a>等比中项</h4><p>$$<br>G^2&#x3D;ab<br>$$</p>
<h4 id="通项公式-2"><a href="#通项公式-2" class="headerlink" title="通项公式"></a>通项公式</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        a_n&#x3D;&amp;a_1q^{n-1}\\<br>        a_n&#x3D;&amp;S_n-S_{n-1},n\geq 2<br>    }<br>\end{aligned}<br>$$</p>
<h4 id="前-n-项和-1"><a href="#前-n-项和-1" class="headerlink" title="前$n$项和"></a>前$n$项和</h4><p>$$<br>S_n&#x3D;\begin{cases}<br>    \displaylines{<br>        \displaystyle\frac{a_1(1-q^n)}{1-q} &amp; :q\neq 1\\<br>        na_1 &amp; :q&#x3D;1<br>    }<br>\end{cases}<br>$$</p>
<h4 id="性质-5"><a href="#性质-5" class="headerlink" title="性质"></a>性质</h4><p>1、$m,n,p,q\in\mathbb{N^+}, \ m+n&#x3D;p+q$，则$a_ma_n&#x3D;a_pa_q$。  </p>
<p>2、在等比数列中，依次每$k$项之和仍成等比数列。  </p>
<p>3、$a_1a_n&#x3D;a_2a_{n-1}&#x3D;a_3a_{n-2}&#x3D;\cdots &#x3D;a_ka_{n-k+1}, \ k\in{1,2,\cdots,n}$  </p>
<p>4、$\forall a_m,a_n, \ a_n&#x3D;a_mq^{(n-m)}$  </p>
<h2 id="概率与数学期望"><a href="#概率与数学期望" class="headerlink" title="概率与数学期望"></a>概率与数学期望</h2><p>在概率论中，我们把一个随机试验的某种可能结果称为<strong>样本点</strong> ，把所有可能的结果构成的集合称为<strong>样本空间</strong> 。在一个给定的样本空间中，<strong>随机事件</strong> 就是样本空间的子集，即由若干个样本点构成的集合，<strong>随机变量</strong> 就是把样本点映射为实数的函数。随机变量分为离散型与连续型两种，离散型随机变量就是取值有限或可数的随机变量。  </p>
<h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p>设样本空间$\Omega$，$\forall A\in\Omega, \ \exist P(A)\in\mathbb{R}$，$A$为随机事件，满足：<br>1、$P(A)\geq 0$<br>2、$P(\Omega)&#x3D;1$<br>3、对于若干个两两互斥事件$A_1,A_2,\cdots$有$\displaystyle \sum_i P(A_i)&#x3D;P\left(\bigcup_i A_i\right)$。<br>则称$P(A)\in\mathbb R$为随机事件$A$发生的<strong>概率</strong> ，$0\leq P(A)\leq 1$。  </p>
<p>若随机变量$X$的取值有$x_1,x_2,\cdots$，一个随机事件可以表示为$X&#x3D;x_i$，其概率为$P(X&#x3D;x_i)&#x3D;p_i$，则称$\displaystyle E(x)&#x3D;\sum_i p_ix_i&#x3D;\sum_{\omega\in\Omega}X(\omega)P(\omega)$为随机变量$X$的<strong>数学期望</strong> ，数学期望是线性函数。  </p>
<h4 id="性质-6"><a href="#性质-6" class="headerlink" title="性质"></a>性质</h4><p>1、<strong>期望的线性性&amp;乘积的期望：</strong> $E(aX+bY)&#x3D;aE(X)+bE(Y)$  </p>
<p>2、<strong>全期望公式：</strong> 设$X,Y$是随机变量，$\displaystyle E(Y)&#x3D;\sum_iP(X&#x3D;x_i)E[Y\mid(X&#x3D;x_i)]$。  </p>
<h4 id="古典定义"><a href="#古典定义" class="headerlink" title="古典定义"></a>古典定义</h4><p>如果一个试验满足两条：<br>1、试验只有有限个基本结果；<br>2、试验的每个基本结果出现的可能性是一样的；  </p>
<p>这样的试验便是古典试验。对于古典试验中的事件$A$，它的概率定义为$\displaystyle P(A)&#x3D;\frac{m}{n}$，其中$n$表示该试验中所有可能出现的基本结果的总数目，$m$表示事件$A$包含的试验基本结果数。  </p>
<h4 id="统计定义"><a href="#统计定义" class="headerlink" title="统计定义"></a>统计定义</h4><p>如果在一定条件下，进行了$n$次试验，事件$A$发生了$N_A$次，如果随着$n$逐渐增大，频率$\displaystyle \frac{N_A}{n}$逐渐稳定在某一数值$p$附近，那么数值$p$称为事件$A$在该条件下发生的概率，记做$P(A)&#x3D;p$。  </p>
<h4 id="公理化定义"><a href="#公理化定义" class="headerlink" title="公理化定义"></a>公理化定义</h4><p>设$E$是随机试验，$S$是它的样本空间（事件空间的同义词）。对$E$的每一个事件$A$赋予一个实数，记为$P(A)$，称为事件$A$的概率。这里$P(A)$是一个从集合到实数的映射，$P(A)$满足以下公理：  </p>
<p><strong>非负性：</strong> 对于一个事件$A$，有概率$P(A)\in[0,1]$。  </p>
<p><strong>规范性：</strong> $P(S)&#x3D;1$。  </p>
<p><strong>可加性：</strong> 若$A\cap B&#x3D;\emptyset$，则$P(A\cup B)&#x3D;P(A)+P(b)$。  </p>
<p>由$(S,P)$构成的这样的一个系统称为一个<strong>概率空间</strong> 。  </p>
<h4 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h4><p><strong>广义加法公式：</strong> 对任意两个事件$A,B$，$P(A\cup B)&#x3D;P(A)+P(B)-P(A\cap B)$。  </p>
<p><strong>条件概率：</strong> 记$P(B\mid A)$表示在$A$事件发生的前提下，$B$事件发生的概率，则$\displaystyle P(B\mid A)&#x3D;\frac{P(AB)}{P(A)}$（其中$P(AB)$为事件$A$和事件$B$同时发生的概率）。  </p>
<p><strong>乘法公式：</strong> $P(AB)&#x3D;P(A)P(B\mid A)&#x3D;P(B)P(A\mid B)$  </p>
<p><strong>全概率公式：</strong> 若$\displaystyle \forall i,j, \ A_i\cap A_j&#x3D;\emptyset, \ \sum_{i&#x3D;1}^nA_i&#x3D;1$，则有$\displaystyle P(B)&#x3D;\sum_{i&#x3D;1}^nP(A_i)P(B\mid A_i)$。  </p>
<p><strong>贝叶斯定理：</strong> $\displaystyle P(B_i\mid A)&#x3D;\frac{P(B_i)P(A\mid B_i)}{\displaystyle \sum_{j&#x3D;1}^nP(B_j)P(A\mid B_j)}$  </p>
<h3 id="独立性"><a href="#独立性" class="headerlink" title="独立性"></a>独立性</h3><h4 id="随机事件的独立性"><a href="#随机事件的独立性" class="headerlink" title="随机事件的独立性"></a>随机事件的独立性</h4><p>我们称两个事件 <strong>$A,B$独立</strong> ，当$P(A\cap B)&#x3D;P(A)P(b)$。  </p>
<p>我们称若干个事件$A_i,i\in[1,n]$<strong>互相独立</strong> ，当对于其中任何一个子集，该子集中的事件同时发生的概率，等于其中每个事件发生概率的乘积。形式化地说：<br>$$<br>P\left(\bigcap_{E\in T}{E}\right)&#x3D;\prod_{E\in T}P(E), \ \forall T\subseteq\bigcup_{i&#x3D;1}^n{A_i}<br>$$</p>
<h4 id="随机变量的独立性"><a href="#随机变量的独立性" class="headerlink" title="随机变量的独立性"></a>随机变量的独立性</h4><p>$I(X)$表示随机变量$X$的取值范围。  </p>
<p>我们称两个随机变量 <strong>$X,Y$独立</strong> ，当$P[(X&#x3D;\alpha)\cap (Y&#x3D;\beta)]&#x3D;P(X&#x3D;\alpha)P(Y&#x3D;\beta), \ \forall\alpha\in I(X), \ \beta\in I(Y)$，即$(X,Y)$取任意一组值的概率，等于$X$和$Y$分别取对应值的概率乘积。  </p>
<p>我们称若干个随机变量$X_i, \ i\in[1,n]$<strong>互相独立</strong> ，当$(X_1,\cdots,X_n)$取任意一组值的概率，等于每个$X_i$分别取对应值的概率乘积。形式化地说：<br>$$<br>P\left(\bigcap_{i&#x3D;1}^nX_i&#x3D;F_i\right)&#x3D;\prod_{i&#x3D;1}^nP(X_i&#x3D;F_i), \ \forall F_i\in I(X_i), \ i\in [1,n]<br>$$</p>
<h3 id="事件的计算"><a href="#事件的计算" class="headerlink" title="事件的计算"></a>事件的计算</h3><p><strong>和事件：</strong> 相当于<strong>并集</strong> 。若干个事件中只要其中之一发生，就算发生了它们的和事件。  </p>
<p><strong>积事件：</strong> 相当于<strong>交集</strong> 。若干个事件必须全部发生，才算发生了它们的积事件。  </p>
<h2 id="取模运算"><a href="#取模运算" class="headerlink" title="取模运算"></a>取模运算</h2><h3 id="基本性质"><a href="#基本性质" class="headerlink" title="基本性质"></a>基本性质</h3><p>1、若$p\mid(a-b)$，则$\displaystyle a\equiv b\pmod p$。  </p>
<p>2、$\displaystyle a\bmod p&#x3D;b\bmod p$意味$\displaystyle a\equiv b\pmod p$。  </p>
<p>3、对称性：$\displaystyle a\equiv b\pmod p$等价于$\displaystyle b\equiv a\pmod p$。  </p>
<p>4、传递性：若$\displaystyle a\equiv b\pmod p, \ b\equiv c\pmod p$，则$\displaystyle a\equiv c\pmod p$。  </p>
<h3 id="运算法则"><a href="#运算法则" class="headerlink" title="运算法则"></a>运算法则</h3><p>1、<br>$$<br>(a+b)\bmod p&#x3D;(a\bmod p+b\bmod p)\bmod p<br>$$<br>2、<br>$$<br>(a-b)\bmod p&#x3D;(a\bmod p-b\bmod p)\bmod p<br>$$<br>3、<br>$$<br>(ab)\bmod p&#x3D;[(a\bmod p)(b\bmod p)]\bmod p<br>$$<br>4、<br>$$<br>a^b\bmod p&#x3D;\left[{(a\bmod p)}^b\right]\bmod p<br>$$<br>5、结合律<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        \left[(a+b)\bmod p+c\right]\bmod p&#x3D;&amp;[a+(b+c)\bmod p]\bmod p\\<br>        {[(ab)\bmod p]c}\bmod p&#x3D;&amp;{a[(bc)\bmod p]}\bmod p<br>    }<br>\end{aligned}<br>$$<br>6、交换律<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        (a+b)\bmod p&#x3D;&amp;(b+a)\bmod p\\<br>        (ab)\bmod p&#x3D;&amp;(ba)\bmod p<br>    }<br>\end{aligned}<br>$$<br>7、分配率<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        (a+b)\bmod p&#x3D;&amp;(a\bmod p+b\bmod p)\bmod p\\<br>        {[(a+b)\bmod p]c}\bmod p&#x3D;&amp;[(ac)\bmod p+(bc)\bmod p]\bmod p<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="重要定理"><a href="#重要定理" class="headerlink" title="重要定理"></a>重要定理</h3><p>1、若$\displaystyle a\equiv b\pmod p$，则$\displaystyle \forall c, \ a+c\equiv b+c\pmod p$。  </p>
<p>2、若$\displaystyle a\equiv b\pmod p$，则$\displaystyle \forall c, \ ac\equiv bc\pmod p$。  </p>
<p>3、若$\displaystyle a\equiv b\pmod p, \ c\equiv d\pmod p$，则$\displaystyle a+c\equiv b+d\pmod p, \ a-c\equiv b-d\pmod p, \ ac\equiv bd\pmod p$。  </p>
<h2 id="秦九韶算法"><a href="#秦九韶算法" class="headerlink" title="秦九韶算法"></a>秦九韶算法</h2><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        &amp;f(x)\\<br>        &#x3D;&amp;\sum_{i&#x3D;0}^na_ix^i\\<br>        &#x3D;&amp;\left(\sum_{i&#x3D;1}^na_ix^{i-1}\right)x+a_0\\<br>        &#x3D;&amp;\left[\left(\sum_{i&#x3D;2}^na_ix^{i-2}\right)x+a_1\right]x+a_0\\<br>        &amp;\qquad\qquad\qquad\vdots\\<br>        &#x3D;&amp;{\cdots[(a_nx+a_{n-1})x+a_{n-2}]x+\cdots +a_1}x+a_0<br>    }<br>\end{aligned}<br>$$</p>
<hr>
<p>$$<br>\begin{aligned}<br>    \displaylines{<br>        v_1&amp;&#x3D;a_nx+a_{n-1}\\<br>        v_2&amp;&#x3D;v_1x+a_{n-2}\\<br>        &amp;\qquad\vdots\\<br>        f(x)&#x3D;v_n&amp;&#x3D;v_{n-1}x+a_0<br>    }<br>\end{aligned}<br>$$</p>
<p>对于一个$n$次多项式，至多做$n$次乘法和$n$次加法。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> sum=a[n];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">	sum=(sum*k+a[i<span class="number">-1</span>])%P;</span><br></pre></td></tr></table></figure>

<h2 id="偏导数"><a href="#偏导数" class="headerlink" title="偏导数"></a>偏导数</h2><p>设函数$z&#x3D;f(x,y)$在点$(x_0,y_0)$的某一邻域内有定义，当$y$固定在$y_0$而$x$在$x_0$处有增量$\Delta x$时，相应地函数有增量$f(x_0+\Delta x,y_0)-f(x_0,y_0)$，如果$\displaystyle\lim_{\Delta x\rightarrow 0}\frac{f(x_0+\Delta x,y_0)-f(x_0,y_0)}{\Delta x}$存在，则称此极限为函数$z&#x3D;f(x,y)$在点$(x_0,y_0)$处对$x$的偏导数，记为$\displaystyle\left.\frac{\partial z}{\partial x}\right|<em>{x&#x3D;x_0, \ y&#x3D;y_0}$，$\displaystyle\left.\frac{\partial f}{\partial x}\right|</em>{x&#x3D;x_0, \ y&#x3D;y_0}$，$\displaystyle\left.z_x\right|_{x&#x3D;x_0, \ y&#x3D;y_0}$或$f_x(x_0,y_0)$。  </p>
<p>同理可定义函数$z&#x3D;f(x,y)$在点$(x_0,y_0)$处对$y$的偏导数，为$\displaystyle\lim_{\Delta y\rightarrow 0}\frac{f(x_0,y_0+\Delta y)-f(x_0,y_0)}{\Delta y}$，记为$\displaystyle\left.\frac{\partial z}{\partial y}\right|<em>{x&#x3D;x_0, \ y&#x3D;y_0}$，$\displaystyle\left.\frac{\partial f}{\partial y}\right|</em>{x&#x3D;x_0, \ y&#x3D;y_0}$，$\displaystyle\left.z_y\right|_{x&#x3D;x_0, \ y&#x3D;y_0}$或$f_y(x_0,y_0)$。  </p>
<p>如果函数$z&#x3D;(x,y)$在区域$D$内任意一点$(x,y)$处对$x$的偏导数都存在，那么这个偏导数就是$x$、$y$的函数，它就称为函数$z&#x3D;f(x,y)$对自变量$x$的偏导数，记作$\dfrac{\partial z}{\partial x}$，$\dfrac{\partial f}{\partial x}$，$z_x$或$f_x(x,y)$。  </p>
<p>同理可以定义函数$z&#x3D;f(x,y)$对自变量$y$的偏导数，记作$\dfrac{\partial z}{\partial y}$，$\dfrac{\partial f}{\partial y}$，$z_y$或$f_y(x,y)$。  </p>
<p>偏导数的概念可以推广到二元以上函数，如$u&#x3D;f(x,y,z)$在$(x,y,z)$处：<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        f_x(x,y,z)&#x3D;&amp;\lim_{\Delta x\rightarrow 0}\frac{f(x+\Delta x,y,z)-f(x,y,z)}{\Delta x}\\<br>        f_y(x,y,z)&#x3D;&amp;\lim_{\Delta y\rightarrow 0}\frac{f(x,y+\Delta y,z)-f(x,y,z)}{\Delta y}\\<br>        f_z(x,y,z)&#x3D;&amp;\lim_{\Delta z\rightarrow 0}\frac{f(x,y,z+\Delta z)-f(x,y,z)}{\Delta z}<br>    }<br>\end{aligned}<br>$$</p>
<h3 id="高阶偏导数"><a href="#高阶偏导数" class="headerlink" title="高阶偏导数"></a>高阶偏导数</h3><p>二阶及二阶以上的偏导数统称为高阶偏导数。函数$z&#x3D;f(x,y)$的二阶偏导数为：  </p>
<h4 id="纯偏导"><a href="#纯偏导" class="headerlink" title="纯偏导"></a>纯偏导</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \frac{\partial}{\partial x}\left(\frac{\partial z}{\partial x}\right)&#x3D;&amp;\frac{\partial^2z}{\partial x^2}&#x3D;f_{xx}(x,y),\\<br>        \frac{\partial}{\partial y}\left(\frac{\partial z}{\partial y}\right)&#x3D;&amp;\frac{\partial^2z}{\partial y^2}&#x3D;f_{yy}(x,y)<br>    }<br>\end{aligned}<br>$$</p>
<h4 id="混合偏导"><a href="#混合偏导" class="headerlink" title="混合偏导"></a>混合偏导</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \frac{\partial}{\partial y}\left(\frac{\partial z}{\partial x}\right)&#x3D;&amp;\frac{\partial^2z}{\partial x\partial y}&#x3D;f_{xy}(x,y),\\<br>        \frac{\partial}{\partial x}\left(\frac{\partial z}{\partial y}\right)&#x3D;&amp;\frac{\partial^2z}{\partial y\partial x}&#x3D;f_{yx}(x,y)<br>    }<br>\end{aligned}<br>$$</p>
<h2 id="Lagrange乘数法"><a href="#Lagrange乘数法" class="headerlink" title="Lagrange乘数法"></a>Lagrange乘数法</h2><h3 id="多元函数极值"><a href="#多元函数极值" class="headerlink" title="多元函数极值"></a>多元函数极值</h3><blockquote>
<p>求函数$f(x,y)&#x3D;3axy-x^3-y^3(a&gt;0)$的极值。</p>
</blockquote>
<p>解：<br>解方程组<br>$$<br>\begin{cases}<br>    \displaylines{<br>        f_x&#x3D;3ay-3x^2&#x3D;0\\<br>        f_y&#x3D;3ax-3y^2&#x3D;0<br>    }<br>\end{cases}<br>$$<br>驻点$(0,0),(a,a)$。<br>$$<br>A&#x3D;f_{xx}&#x3D;-6x, \ B&#x3D;f_{xy}&#x3D;3a, \ C&#x3D;f_{yy}&#x3D;-6y<br>$$<br>在点$(0,0)$处，$AC-B^2&#x3D;\left.(36xy-9x^2)\right|_{(0,0)}&#x3D;-9a^2&lt;0$<br>$\therefore f(0,0)$不是极值。<br>在点$(a,a)$处，$AC-B^2&#x3D;\left.(36xy-9a^2)\right|_{(a,a)}&#x3D;27a^2&gt;0$且$A&#x3D;-6a&lt;0$<br>$\therefore f(a,a)&#x3D;a^3$是极大值。  </p>
<h3 id="Lagrange乘数法-1"><a href="#Lagrange乘数法-1" class="headerlink" title="Lagrange乘数法"></a>Lagrange乘数法</h3><p>求函数$z&#x3D;f(x,y)$在条件$\varphi(x,y)&#x3D;0$下的可能极值点，先构造拉格朗日函数<br>$$<br>\displaylines{<br>    L(x,y,\lambda)&#x3D;f(x,y)+\lambda\varphi(x,y)\\<br>    \mathrm{s.t.}<br>    \begin{cases}<br>        L_x’&#x3D;f_x(x,y)+\lambda\varphi_x(x,y)&#x3D;0\\<br>        L_y’&#x3D;f_y(x,y)+\lambda\varphi_y(x,y)&#x3D;0\\<br>        L_{\lambda}’&#x3D;\varphi(x,y)&#x3D;0<br>    \end{cases}<br>}<br>$$<br>解出$x,y,\lambda$，其中$x,y$就是可能的极值点的坐标。</p>
<hr>
<blockquote>
<p>（温州高三一模）已知$x,y,z\in\mathbb R^+, \ x+y+z&#x3D;1$，则$\sqrt{xy}+\sqrt{xz}-y-z$的最大值为_。</p>
</blockquote>
<p>$$<br>\displaylines{<br>    f(x,y,z)&#x3D;\sqrt{xy}+\sqrt{xz}-y-z+\lambda(x+y+z-1)\\<br>    \begin{cases}<br>        f’(x)&#x3D;\dfrac{\sqrt y}{2\sqrt x}+\dfrac{\sqrt z}{2\sqrt x}+\lambda&#x3D;0\\<br>        f’(y)&#x3D;\dfrac{\sqrt x}{2\sqrt y}-1+\lambda&#x3D;0\\<br>        f’(z)&#x3D;\dfrac{\sqrt x}{2\sqrt z}-1+\lambda&#x3D;0<br>    \end{cases}<br>}<br>$$</p>
<p>由$f’(x)-f’(y)&#x3D;\dfrac{\sqrt y}{2\sqrt x}+\dfrac{\sqrt z}{2\sqrt x}-\dfrac{\sqrt x}{2\sqrt y}+1&#x3D;0$<br>$\therefore x+2y&#x3D;1$，原式化简为：$24y^2-12y+1&#x3D;0$<br>$$<br>\displaylines{<br>    y_1&#x3D;\frac{3-\sqrt 3}{12}\\<br>    y_2&#x3D;\frac{3+\sqrt 3}{12}<br>}<br>$$<br>$\therefore y&#x3D;z&#x3D;\dfrac{3-\sqrt 3}{12}$，带回$x+y+z&#x3D;1, \ x&#x3D;\dfrac{3+\sqrt 3}{6}$<br>$\therefore \sqrt{xy}+\sqrt{xz}-y-z$最大值为$\dfrac{\sqrt 3-1}{2}$。  </p>
<hr>
<blockquote>
<p>已知$5x^2y^2+y^4&#x3D;1, \ x,y\in\mathbb R$，则$x^2+y^2$的最小值是_。</p>
</blockquote>
<p>解：<br>设$a&#x3D;x^2, \ b&#x3D;y^2$，转为求$a+b$的最小值。<br>$$<br>\displaylines{<br>    f(a,b)&#x3D;a+b+\lambda(5ab+b^2-1)\\<br>    \begin{cases}<br>        f’(a)&#x3D;1+5\lambda b&#x3D;0\\<br>        f’(b)&#x3D;1+5\lambda a+2\lambda b&#x3D;0<br>    \end{cases}<br>}<br>$$<br>整理得：$5\lambda b&#x3D;5\lambda a+2\lambda b\Rightarrow 5b&#x3D;5a+2b\Rightarrow 3b&#x3D;5a$<br>$$<br>a&#x3D;\frac{3}{5}b, \ 3b^2+b^2&#x3D;1, \ b^2&#x3D;\frac{1}{4}, \ b&#x3D;\frac{1}{2}, \ a&#x3D;\frac{3}{10}<br>$$<br>$\therefore a+b&#x3D;\dfrac{4}{5}$  </p>
<h2 id="积分"><a href="#积分" class="headerlink" title="积分"></a>积分</h2><table>
<thead>
<tr>
<th align="center">积分</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">$\displaystyle\int\mathrm dx$</td>
<td align="center">$x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int x^n\mathrm dx$</td>
<td align="center">$\dfrac{x^{n+1}}{n+1}$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int\frac{\mathrm dx}{x}$</td>
<td align="center">$\ln x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int e^x\mathrm dx$</td>
<td align="center">$e^x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int a^x\mathrm dx$</td>
<td align="center">$\dfrac{a^x}{\ln a}$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int\sin x\mathrm dx$</td>
<td align="center">$-\cos x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int\cos x\mathrm dx$</td>
<td align="center">$\sin x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int\tan x\mathrm dx$</td>
<td align="center">$-\ln\cos x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int\cot x\mathrm dx$</td>
<td align="center">$\ln\sin x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int\frac{\mathrm dx}{\cos^2x}$</td>
<td align="center">$\tan x$</td>
</tr>
<tr>
<td align="center">$\displaystyle\int\frac{\mathrm dx}{\sin^2x}$</td>
<td align="center">$-\cot x$</td>
</tr>
</tbody></table>
<h2 id="海伦公式"><a href="#海伦公式" class="headerlink" title="海伦公式"></a>海伦公式</h2><p>$$<br>\displaylines{<br>    \begin{aligned}<br>        S&#x3D;&amp;\sqrt{p(p-a)(p-b)(b-c)}\\<br>        p&#x3D;&amp;\frac{a+b+c}{2}<br>    \end{aligned}<br>}<br>$$</p>
<h3 id="婆罗摩笈多公式"><a href="#婆罗摩笈多公式" class="headerlink" title="婆罗摩笈多公式"></a>婆罗摩笈多公式</h3><p>$$<br>\begin{aligned}<br>    S&#x3D;&amp;\sqrt{(s-a)(s-b)(s-c)(s-d)}\\<br>    s&#x3D;&amp;\frac{a+b+c+d}{2}<br>\end{aligned}<br>$$</p>
<h2 id="Floyd"><a href="#Floyd" class="headerlink" title="Floyd"></a>Floyd</h2><p>$O(n^3)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">  	dis[i][i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">			<span class="keyword">if</span>((i!=j)&amp;&amp;(j!=k)&amp;&amp;(k!=i))</span><br><span class="line">				dis[j][k]=<span class="built_in">min</span>(dis[j][k],dis[j][i]+dis[i][k]);</span><br></pre></td></tr></table></figure>

<h3 id="最小环"><a href="#最小环" class="headerlink" title="最小环"></a>最小环</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line"><span class="built_in">memset</span>(org,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(org));</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	dis[i][i]=org[i][i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">	t1=<span class="built_in">read</span>(),</span><br><span class="line">	t2=<span class="built_in">read</span>(),</span><br><span class="line">	t3=<span class="built_in">read</span>(),</span><br><span class="line">	dis[t1][t2]=<span class="built_in">min</span>(dis[t1][t2],t3),</span><br><span class="line">	dis[t2][t1]=<span class="built_in">min</span>(dis[t2][t1],t3),</span><br><span class="line">	org[t1][t2]=<span class="built_in">min</span>(org[t1][t2],t3),</span><br><span class="line">	org[t2][t1]=<span class="built_in">min</span>(org[t2][t1],t3);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k++)&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;k;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=i+<span class="number">1</span>;j&lt;k;j++)</span><br><span class="line">			ret=<span class="built_in">min</span>(ret,dis[i][j]+org[i][k]+org[k][j]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			dis[j][i]=dis[i][j]=<span class="built_in">min</span>(dis[i][j],dis[i][k]+dis[k][j]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(ret!=<span class="number">0x3f3f3f3f3f3f3f3f</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ret);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;No solution.\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="中继点计数"><a href="#中继点计数" class="headerlink" title="中继点计数"></a>中继点计数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	dis[i][i]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">	t1=<span class="built_in">read</span>(),</span><br><span class="line">	t2=<span class="built_in">read</span>(),</span><br><span class="line">	dis[t1][t2]=dis[t2][t1]=<span class="built_in">read</span>(),</span><br><span class="line">	cnt[t1][t2]=cnt[t2][t1]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">			<span class="keyword">if</span>((i!=j)&amp;&amp;(j!=k)&amp;&amp;(i!=k))&#123;</span><br><span class="line">				<span class="keyword">if</span>(dis[j][k]&gt;dis[j][i]+dis[i][k])&#123;</span><br><span class="line">					dis[j][k]=dis[j][i]+dis[i][k],</span><br><span class="line">					cnt[j][k]=cnt[j][i]*cnt[i][k];</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;;</span><br><span class="line">				<span class="keyword">if</span>(dis[j][k]==dis[j][i]+dis[i][k])</span><br><span class="line">					cnt[j][k]+=cnt[j][i]*cnt[i][k];</span><br><span class="line">			&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k++)</span><br><span class="line">			<span class="keyword">if</span>((i!=j)&amp;&amp;(j!=k)&amp;&amp;(i!=k)&amp;&amp;(dis[j][k]==dis[j][i]+dis[i][k]))</span><br><span class="line">				...</span><br></pre></td></tr></table></figure>

<h2 id="Kruskal"><a href="#Kruskal" class="headerlink" title="Kruskal"></a>Kruskal</h2><p>$O(m\log m)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> s,e,w;</span><br><span class="line">&#125;e[N+<span class="number">1</span>];</span><br><span class="line"><span class="built_in">sort</span>(e,e+n,cmp);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">find</span>(e[i].s)!=<span class="built_in">find</span>(e[i].e))&#123;</span><br><span class="line">		ans+=e[i].w;</span><br><span class="line">		<span class="built_in">unio</span>(e[i].s,e[i].e);</span><br><span class="line">	&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Dijkstra"><a href="#Dijkstra" class="headerlink" title="Dijkstra"></a>Dijkstra</h2><p>$O(m\log n)$</p>
<h3 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h3><p>$O(n^2)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> inf=<span class="number">1e8</span>,start=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> t1,t2,t3,a[N+<span class="number">1</span>][N+<span class="number">1</span>],dis[N+<span class="number">1</span>],rec,v,e;</span><br><span class="line"><span class="type">bool</span> check[N+<span class="number">1</span>];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;v,&amp;e);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=v;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=v;j++)</span><br><span class="line">		a[i][j]=i^j?inf:<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;e;i++)&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;t1,&amp;t2,&amp;t3);</span><br><span class="line">	a[t1][t2]=t3;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=v;i++)</span><br><span class="line">	dis[i]=a[start][i];</span><br><span class="line">check[start]=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=v<span class="number">-1</span>;i++)&#123;</span><br><span class="line">	minn=inf;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=v;j++)</span><br><span class="line">		<span class="keyword">if</span>((check[j]==<span class="literal">false</span>)&amp;&amp;(dis[j]&lt;minn))</span><br><span class="line">			minn=dis[rec=j];</span><br><span class="line">	check[rec]=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=v;j++)</span><br><span class="line">		dis[j]=<span class="built_in">min</span>(dis[j],dis[rec]+a[rec][j]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="最短路计数"><a href="#最短路计数" class="headerlink" title="最短路计数"></a>最短路计数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;,less&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; &gt;q;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line">	dis[<span class="number">1</span>]=<span class="number">0</span>,</span><br><span class="line">	ans[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(<span class="number">0</span>,<span class="number">1</span>));</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q.<span class="built_in">top</span>().second;</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(vis[rec]==<span class="literal">true</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		vis[rec]=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>(dis[ver[i]]&gt;dis[rec]+<span class="number">1</span>)&#123;</span><br><span class="line">				dis[ver[i]]=dis[rec]+<span class="number">1</span>,</span><br><span class="line">				ans[ver[i]]=ans[rec];</span><br><span class="line">				q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[ver[i]],ver[i]));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="keyword">if</span>(dis[ver[i]]==dis[rec]+<span class="number">1</span>)</span><br><span class="line">					ans[ver[i]]=(ans[ver[i]]+ans[rec])%<span class="number">100003</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="路径输出"><a href="#路径输出" class="headerlink" title="路径输出"></a>路径输出</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;,less&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; &gt;q;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dij</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> rec=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		dis[i]=map[start][i],</span><br><span class="line">		path[i]=<span class="number">-1</span>;</span><br><span class="line"> 	<span class="keyword">if</span>(vis[start]==<span class="literal">true</span>)</span><br><span class="line">		<span class="keyword">continue</span>;</span><br><span class="line">	vis[start]=<span class="literal">true</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[start],start));</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q.<span class="built_in">top</span>().second;</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		vis[rec]=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>((vis[ver[i]]==<span class="literal">false</span>)&amp;&amp;(dis[ver[i]]&gt;dis[rec]+edge[i]))&#123;</span><br><span class="line">				dis[ver[i]]=dis[rec]+edge[i],</span><br><span class="line">                path[ver[i]]=rec;</span><br><span class="line">				q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[ver[i]],ver[i]));</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prt</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br><span class="line">		p=i;</span><br><span class="line">		<span class="keyword">while</span>(path[p]!=<span class="number">-1</span>)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,path[p]);</span><br><span class="line">			p=path[p];</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="次短路径"><a href="#次短路径" class="headerlink" title="次短路径"></a>次短路径</h3><p>遍历所有最短路上的边，将其删除，再跑最短路，求出的最小值为次短路。如果相等，严格次短路为次小值。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> x,y,z;</span><br><span class="line">&#125;rec[];</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;,less&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;&gt;q[<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dij</span><span class="params">(<span class="type">const</span> <span class="type">int</span> id,<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">	q[id].<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[id][k],k));</span><br><span class="line">	dis[id][k]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(q[id].<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		ret=q[id].<span class="built_in">top</span>().second;</span><br><span class="line">		q[id].<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(vis[ret]==<span class="literal">true</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		vis[ret]=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[ret];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>((vis[ver[i]]==<span class="literal">false</span>)&amp;&amp;(dis[id][ver[i]]&gt;dis[id][ret]+edge[i]))&#123;</span><br><span class="line">				dis[id][ver[i]]=dis[id][ret]+edge[i];</span><br><span class="line">				q[id].<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[id][ver[i]],ver[i]));</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x7f</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line">	ans=min2=<span class="number">2100000000</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		rec[i].x=<span class="built_in">read</span>(),</span><br><span class="line">		rec[i].y=<span class="built_in">read</span>(),</span><br><span class="line">		rec[i].z=<span class="built_in">read</span>();</span><br><span class="line">		<span class="built_in">add</span>(rec[i].x,rec[i].y,rec[i].z);</span><br><span class="line">		<span class="built_in">add</span>(rec[i].y,rec[i].x,rec[i].z);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">dij</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">dij</span>(<span class="number">1</span>,n);</span><br><span class="line">	min1=dis[<span class="number">0</span>][n];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		t1=rec[i].x,</span><br><span class="line">		t2=rec[i].y;</span><br><span class="line">		<span class="keyword">if</span>(dis[<span class="number">0</span>][t1]+dis[<span class="number">1</span>][t2]&gt;dis[<span class="number">0</span>][t2]+dis[<span class="number">1</span>][t1])</span><br><span class="line">			<span class="built_in">swap</span>(t1,t2);</span><br><span class="line">		<span class="keyword">if</span>(dis[<span class="number">0</span>][t1]+dis[<span class="number">1</span>][t2]+rec[i].z==min1)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		ans=<span class="built_in">min</span>(ans,dis[<span class="number">0</span>][t1]+dis[<span class="number">1</span>][t2]+rec[i].z);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		t1=rec[i].x,</span><br><span class="line">		t2=rec[i].y;</span><br><span class="line">		<span class="keyword">if</span>(dis[<span class="number">0</span>][t1]+dis[<span class="number">1</span>][t2]&gt;dis[<span class="number">0</span>][t2]+dis[<span class="number">1</span>][t1])</span><br><span class="line">            t1^=t2^=t1^=t2;</span><br><span class="line">		<span class="keyword">if</span>(dis[<span class="number">0</span>][t1]+dis[<span class="number">1</span>][t2]+rec[i].z!=min1)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		min2=<span class="built_in">min</span>(min2,rec[i].z);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">min</span>(ans,min1+(min2&lt;&lt;<span class="number">1</span>)));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Prim"><a href="#Prim" class="headerlink" title="Prim"></a>Prim</h2><p>$O(n^2+m)$  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">prim</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line">	dis[start]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		minn=INF;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			<span class="keyword">if</span>((vis[j]==<span class="literal">false</span>)&amp;&amp;(dis[j]&lt;minn))</span><br><span class="line">				minn=dis[j],</span><br><span class="line">				rec=j;</span><br><span class="line">		ans+=minn,</span><br><span class="line">		vis[rec]=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			dis[j]=<span class="built_in">min</span>(dis[j],mp[rec][j]);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="堆优化"><a href="#堆优化" class="headerlink" title="堆优化"></a>堆优化</h3><p>$O((n+m)\log n)$  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;,less&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; &gt;q;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prim</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line">	dis[start]=<span class="number">0</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[start],start));</span><br><span class="line">	<span class="keyword">while</span>((q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&amp;&amp;(cnt&lt;n))&#123;</span><br><span class="line">		len=q.<span class="built_in">top</span>().first,</span><br><span class="line">		rec=q.<span class="built_in">top</span>().second;</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(vis[rec]==<span class="literal">true</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		vis[rec]=<span class="literal">true</span>,</span><br><span class="line">		cnt++,</span><br><span class="line">		sum+=len;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=nxt[i])</span><br><span class="line">			<span class="keyword">if</span>(dis[ver[i]]&gt;edge[i])&#123;</span><br><span class="line">				dis[ver[i]]=edge[i];</span><br><span class="line">				q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[ver[i]],ver[i]));</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(cnt==n)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,sum);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="SPFA"><a href="#SPFA" class="headerlink" title="SPFA"></a>SPFA</h2><p>$O(nm)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">fill</span>(dis+<span class="number">1</span>,dis+n+<span class="number">1</span>,<span class="number">2147483647</span>);</span><br><span class="line">	dis[start]=<span class="number">0</span>,</span><br><span class="line">	vis[start]=<span class="literal">true</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(start);</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		vis[rec]=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>(dis[ver[i]]&gt;dis[rec]+edge[i])&#123;</span><br><span class="line">				dis[ver[i]]=dis[rec]+edge[i];</span><br><span class="line">				<span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)&#123;</span><br><span class="line">					vis[ver[i]]=<span class="literal">true</span>;</span><br><span class="line">					q.<span class="built_in">push</span>(ver[i]);</span><br><span class="line">				&#125;;</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="判负环"><a href="#判负环" class="headerlink" title="判负环"></a>判负环</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> rec=<span class="number">0</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(start);</span><br><span class="line">	vis[start]=<span class="literal">true</span>,</span><br><span class="line">	dis[start]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		vis[rec]=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>(dis[ver[i]]&gt;dis[rec]+edge[i])&#123;</span><br><span class="line">				dis[ver[i]]=dis[rec]+edge[i],</span><br><span class="line">				<span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)&#123;</span><br><span class="line">					vis[ver[i]]=<span class="literal">true</span>;</span><br><span class="line">					q.<span class="built_in">push</span>(ver[i]);</span><br><span class="line">                    cnt[ver[i]]++;</span><br><span class="line">                    <span class="keyword">if</span>(cnt[ver[i]]&gt;=n+<span class="number">1</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">				&#125;;</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">spfa</span>(<span class="number">1</span>)==<span class="literal">true</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;有负环\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;无负环\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="SLF优化"><a href="#SLF优化" class="headerlink" title="SLF优化"></a>SLF优化</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">deque&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">...</span><br><span class="line">rec=q.<span class="built_in">front</span>();</span><br><span class="line">q.<span class="built_in">pop_front</span>();</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)&#123;</span><br><span class="line">	vis[ver[i]]=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">if</span>((q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&amp;&amp;(dis[ver[i]]&lt;dis[q.<span class="built_in">front</span>()]))</span><br><span class="line">		q.<span class="built_in">push_front</span>(ver[i]);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		q.<span class="built_in">push_back</span>(ver[i]);</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="LLL优化"><a href="#LLL优化" class="headerlink" title="LLL优化"></a>LLL优化</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">rec=q.<span class="built_in">front</span>();</span><br><span class="line">q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">if</span>(dis[rec]*cnt&gt;sum)&#123;</span><br><span class="line">	q.<span class="built_in">push</span>(p);</span><br><span class="line">	<span class="keyword">continue</span>;</span><br><span class="line">&#125;;</span><br><span class="line">sum-=dis[p],</span><br><span class="line">cnt--,</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)&#123;</span><br><span class="line">	vis[ver[i]]=<span class="literal">true</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(ver[i]);</span><br><span class="line">	cnt++;</span><br><span class="line">	sum+=dis[ver[i]];</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="Kosaraju"><a href="#Kosaraju" class="headerlink" title="Kosaraju"></a>Kosaraju</h2><p>$O(n+m)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    vis[k]=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">        <span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)</span><br><span class="line">            <span class="built_in">dfs</span>(ver[i]);</span><br><span class="line">    rec.<span class="built_in">push_back</span>(k);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rev_dfs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">    vis[k]=<span class="literal">true</span>,</span><br><span class="line">    mrk[k]=val;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=rev_head[k];i!=<span class="number">0</span>;i=rev_next[i])</span><br><span class="line">        <span class="keyword">if</span>(vis[rev_ver[i]]==<span class="literal">false</span>)</span><br><span class="line">            <span class="built_in">rev_dfs</span>(rev_ver[i],val);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kosaraju</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span>(vis[i]==<span class="literal">false</span>)</span><br><span class="line">            <span class="built_in">dfs</span>(i);</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">for</span>(vector&lt;<span class="type">int</span>&gt;::reverse_iterator it=rec.<span class="built_in">rbegin</span>();it!=rec.<span class="built_in">rend</span>();it++)</span><br><span class="line">        <span class="keyword">if</span>(vis[*it]==<span class="literal">false</span>)</span><br><span class="line">            <span class="built_in">rev_dfs</span>(*it,ret++);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">judge</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span>(mrk[i]==cnt<span class="number">-1</span>)</span><br><span class="line">            src=i,</span><br><span class="line">            sum++;</span><br><span class="line">    <span class="built_in">rev_dfs</span>(src,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">if</span>(vis[i]==<span class="literal">false</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Tarjan"><a href="#Tarjan" class="headerlink" title="Tarjan"></a>Tarjan</h2><p>给定无向连通图$G&#x3D;(V,E)$。</p>
<p>若对于$x\in V$，从图中删去节点$x$以及所有与$x$关联的边之后，$G$分裂成两个或两个以上不相连的子图，则称$x$为$G$的<strong>割点</strong> 。</p>
<p>若对于$e\in E$，从图中删去边$e$之后，$G$分裂成两个不相连的子图，则称$e$为$G$的<strong>桥</strong> 或<strong>割边</strong> 。</p>
<p>$O(n+m)$</p>
<h3 id="无向图割边"><a href="#无向图割边" class="headerlink" title="无向图割边"></a>无向图割边</h3><h4 id="割边判定定理"><a href="#割边判定定理" class="headerlink" title="割边判定定理"></a>割边判定定理</h4><p>无向边$(x,y)$是桥，当且仅当搜索树上存在$x$的一个子节点$y$，满足：<br>$$<br>dfn_x&lt;low_y<br>$$<br>桥一定是搜索树中的边，一个简单环中的边一定都不是桥。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	ver[++tot]=y,</span><br><span class="line">	next[tot]=head[x],</span><br><span class="line">	head[x]=tot;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> e)</span></span>&#123;</span><br><span class="line">	dfn[k]=low[k]=++nmb;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(dfn[ver[i]]==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">tarjan</span>(ver[i],i);</span><br><span class="line">			low[k]=<span class="built_in">min</span>(low[k],low[ver[i]]);</span><br><span class="line">			<span class="keyword">if</span>(dfn[k]&lt;low[ver[i]])<span class="comment">//割边判定法则：dfn[x]&lt;low[y]</span></span><br><span class="line">				vis[i]=vis[i^<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">if</span>(i!=(e^<span class="number">1</span>))<span class="comment">//成对变换</span></span><br><span class="line">				low[k]=<span class="built_in">min</span>(low[k],dfn[ver[i]]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line">tot=<span class="number">1</span>;<span class="comment">//2、3 4、5...</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">	t1=<span class="built_in">read</span>(),</span><br><span class="line">	t2=<span class="built_in">read</span>();</span><br><span class="line">	<span class="built_in">add</span>(t1,t2);</span><br><span class="line">	<span class="built_in">add</span>(t2,t1);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(dfn[i]==<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">tarjan</span>(i,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;tot;i+=<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">if</span>(vis[i]==<span class="literal">true</span>)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,ver[i^<span class="number">1</span>],ver[i]);</span><br></pre></td></tr></table></figure>

<h3 id="无向图割点"><a href="#无向图割点" class="headerlink" title="无向图割点"></a>无向图割点</h3><h4 id="割点判定法则"><a href="#割点判定法则" class="headerlink" title="割点判定法则"></a>割点判定法则</h4><p>若$x$不是搜索树的根节点（DFS的起点），则$x$是割点当且仅当搜索树上存在$x$的一个子节点$y$，满足：<br>$$<br>dfn_x\leq low_y<br>$$<br>特别地，若$x$是搜索树的根节点，则$x$是割点当且仅当搜索树上存在至少两个子节点$y_1,y_2$满足上述条件。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">	dfn[k]=low[k]=++nmb,</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(dfn[ver[i]]==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">tarjan</span>(ver[i]);</span><br><span class="line">			low[k]=<span class="built_in">min</span>(low[k],low[ver[i]])；</span><br><span class="line">			<span class="keyword">if</span>(dfn[k]&lt;=low[ver[i]])&#123;</span><br><span class="line">				cnt++;</span><br><span class="line">				<span class="keyword">if</span>((k!=<span class="number">1</span>)||(cnt&gt;<span class="number">1</span>))</span><br><span class="line">					chk[k]=<span class="literal">true</span>;</span><br><span class="line">			&#125;;<span class="comment">//割点判定法则：不是根节点：dfn[n]&lt;=low[y]</span></span><br><span class="line">		&#125;     <span class="comment">//              是根节点：至少存在2个满足</span></span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			low[k]=<span class="built_in">min</span>(low[k],dfn[ver[i]]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="LCA"><a href="#LCA" class="headerlink" title="LCA"></a>LCA</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;ques[];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start,<span class="type">const</span> <span class="type">int</span> last)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[start];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(ver[i]!=last)&#123;</span><br><span class="line">			<span class="built_in">dfs</span>(ver[i],start);</span><br><span class="line">			<span class="built_in">unio</span>(ver[i],start);</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;ques[start].<span class="built_in">size</span>();i++)</span><br><span class="line">		<span class="keyword">if</span>(vis[ques[start].<span class="built_in">at</span>(i).first]==<span class="literal">true</span>)</span><br><span class="line">			ans[ques[start].<span class="built_in">at</span>(i).second]=<span class="built_in">getf</span>(ques[start].<span class="built_in">at</span>(i).first);</span><br><span class="line">	vis[start]=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;s);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;fa[i]=i,i++);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">			t1=<span class="built_in">read</span>(),</span><br><span class="line">			t2=<span class="built_in">read</span>();</span><br><span class="line">			<span class="built_in">add</span>(t1,t2);</span><br><span class="line">			<span class="built_in">add</span>(t2,t1);</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		t1=<span class="built_in">read</span>(),</span><br><span class="line">		t2=<span class="built_in">read</span>();</span><br><span class="line">		ques[t1].<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(t2,i));</span><br><span class="line">		ques[t2].<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(t1,i));</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">dfs</span>(s,<span class="number">0</span>);</span><br><span class="line">	for_each(ans+<span class="number">1</span>,ans+m+<span class="number">1</span>,f);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Johnson"><a href="#Johnson" class="headerlink" title="Johnson"></a>Johnson</h2><p>$O(nm\log m)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis1,<span class="number">0x7f</span>,<span class="built_in">sizeof</span>(dis1));</span><br><span class="line">	dis1[start]=<span class="number">0</span>,</span><br><span class="line">	vis[start]=<span class="literal">true</span>,</span><br><span class="line">	q1.<span class="built_in">push</span>(start);</span><br><span class="line">	<span class="keyword">while</span>(q1.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q1.<span class="built_in">front</span>();</span><br><span class="line">		q1.<span class="built_in">pop</span>();</span><br><span class="line">		vis[rec]=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>(dis1[ver[i]]&gt;dis1[rec]+edge[i])&#123;</span><br><span class="line">				dis1[ver[i]]=dis1[rec]+edge[i];</span><br><span class="line">				<span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)&#123;</span><br><span class="line">					vis[ver[i]]=<span class="literal">true</span>;</span><br><span class="line">					q1.<span class="built_in">push</span>(ver[i]);</span><br><span class="line">					hal[ver[i]]++;</span><br><span class="line">					<span class="keyword">if</span>(hal[ver[i]]&gt;=n+<span class="number">1</span>)&#123;</span><br><span class="line">						flag=<span class="literal">true</span>;</span><br><span class="line">						<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">					&#125;;</span><br><span class="line">				&#125;;</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dij</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;dis2[i++]=INF);</span><br><span class="line">	dis2[start]=<span class="number">0</span>,</span><br><span class="line">	vis[start]=<span class="literal">false</span>;</span><br><span class="line">	q2.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis2[start],start));</span><br><span class="line">	<span class="keyword">while</span>(q2.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q2.<span class="built_in">top</span>().second;</span><br><span class="line">		q2.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(vis[rec]==<span class="literal">true</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		vis[rec]=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>(dis2[ver[i]]&gt;dis2[rec]+edge[i])&#123;</span><br><span class="line">				dis2[ver[i]]=dis2[rec]+edge[i];</span><br><span class="line">				<span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)</span><br><span class="line">					q2.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis2[ver[i]],ver[i]));</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		t1=<span class="built_in">read</span>(),</span><br><span class="line">		t2=<span class="built_in">read</span>(),</span><br><span class="line">		t3=<span class="built_in">read</span>();</span><br><span class="line">		<span class="keyword">if</span>(t1==t2)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">add</span>(t1,t2,t3);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;<span class="built_in">add</span>(<span class="number">0</span>,i++,<span class="number">0</span>));</span><br><span class="line">	<span class="built_in">spfa</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span>(flag==<span class="literal">true</span>)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=head[i];j!=<span class="number">0</span>;j=next[j])</span><br><span class="line">			edge[j]+=dis1[i]-dis1[ver[j]];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="built_in">dij</span>(i);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;dis[%d][%d]=%d\n&quot;</span>,i,j,dis2[j]+dis1[j]-dis1[i]);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="分层图"><a href="#分层图" class="headerlink" title="分层图"></a>分层图</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// M=m*(2+k*4) N=n+k*n</span></span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; ,less&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt; &gt;q;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">0x7f</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		t1=<span class="built_in">read</span>(),</span><br><span class="line">		t2=<span class="built_in">read</span>(),</span><br><span class="line">		t3=<span class="built_in">read</span>();</span><br><span class="line">		<span class="built_in">add</span>(t1,t2,t3);</span><br><span class="line">		<span class="built_in">add</span>(t2,t1,t3);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=k;j++)&#123;</span><br><span class="line">			<span class="built_in">add</span>(t1+n*j,t2+n*j,t3);</span><br><span class="line">			<span class="built_in">add</span>(t2+n*j,t1+n*j,t3);</span><br><span class="line">			<span class="built_in">add</span>(t1+n*(j<span class="number">-1</span>),t2+n*j,<span class="number">0</span>);</span><br><span class="line">			<span class="built_in">add</span>(t2+n*(j<span class="number">-1</span>),t2+n*j,<span class="number">0</span>);</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	dis[start]=<span class="number">0</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[start],start));</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q.<span class="built_in">top</span>().second;</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		<span class="keyword">if</span>(vis[rec]==<span class="literal">true</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		vis[rec]=<span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>((vis[ver[i]]==<span class="literal">false</span>)&amp;&amp;(dis[ver[i]]&gt;dis[rec]+edge[i]))&#123;</span><br><span class="line">				dis[ver[i]]=dis[rec]+edge[i];</span><br><span class="line">				q.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(-dis[ver[i]],ver[i]));</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;=k;i++)</span><br><span class="line">		ans=<span class="built_in">min</span>(ans,dis[end+n*i]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="差分约束系统"><a href="#差分约束系统" class="headerlink" title="差分约束系统"></a>差分约束系统</h2><p>把每个变量$X_i$看作有向图中的一个节点$i$，对于每个约束条件$X_i-X_j\leq c_k$，从节点$j$向节点$i$连一条长度为$c_k$的有向边。  </p>
<p>注意到如果$\displaystyle \bigcup_{i&#x3D;1}^n{a_i}$是一组解，那么$\displaystyle \forall \Delta, \ \bigcup_{i&#x3D;1}^n{a_i+\Delta}$显然也是一组解。所以不妨先求一组负数解，假设$\forall i, \ X_i\leq 0$，然后增加一个$0$号节点，令$X_0&#x3D;0$。这样一来，就多了$N$个形如$X_i-X_0\leq 0$的约束条件，应从节点$0$向每个节点$i$连一条长度为$0$的有向边。    </p>
<p>设$dist_0&#x3D;0$，以$0$为起点求单源最短路。若图中存在负环，则给定的差分约束系统无解。否则，$X_i&#x3D;dist_i$就是差分约束系统的一组解。  </p>
<p>约束条件形如$X_i-X_j\geq c_k$，从$j$到$i$连长度为$c_k$的有向边，改为计算单源最长路，若图中有正环则无解。也可以把约束条件转化成$X_j-X_i\leq -c_k$，按照单源最短路进行计算。  </p>
<p><strong>注意加入$0$点后多出$m$条边。</strong>  </p>
<p>(Bellman Ford)  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">		<span class="built_in">add_edge</span>(y,x,z);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="built_in">add</span>(<span class="number">0</span>,i,<span class="number">0</span>);</span><br><span class="line">	<span class="comment">// memset(dis,0x3f,sizeof(dis));</span></span><br><span class="line">	<span class="comment">// dis[1]=0;非负(可能出现inf)</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=head[j];k!=<span class="number">0</span>;k=next[k])</span><br><span class="line">				dis[ver[k]]=<span class="built_in">min</span>(dis[ver[k]],dis[j]+edge[k]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=head[i];j!=<span class="number">0</span>;j=next[j])</span><br><span class="line">			<span class="keyword">if</span>(dis[ver[j]]&gt;dis[i]+edge[j])&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;NO\n&quot;</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;;</span><br><span class="line">	<span class="comment">// for(register int i=1;i&lt;=n;i++)</span></span><br><span class="line">	<span class="comment">// minn=min(minn,dis[i]);</span></span><br><span class="line">	<span class="comment">// for(register int i=1;i&lt;=n;i++)</span></span><br><span class="line">	<span class="comment">// printf(“%d”,dis[i]-minn);整体平移除负</span></span><br><span class="line">	for_each(dis+<span class="number">1</span>,dis+n+<span class="number">1</span>,f);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="SPFA最长路径"><a href="#SPFA最长路径" class="headerlink" title="SPFA最长路径"></a>SPFA最长路径</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">const</span> <span class="type">int</span> start)</span></span>&#123;</span><br><span class="line">	queue&lt;<span class="type">int</span>&gt;q;</span><br><span class="line">	<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">	<span class="built_in">memset</span>(dis,<span class="number">-1</span>,<span class="built_in">sizeof</span>(dis));</span><br><span class="line">	<span class="built_in">memset</span>(in,<span class="number">0</span>,<span class="built_in">sizeof</span>(in));</span><br><span class="line">	vis[start]=<span class="literal">true</span>,</span><br><span class="line">	dis[start]=<span class="number">0</span>,</span><br><span class="line">	in[start]=<span class="number">1</span>;</span><br><span class="line">	q.<span class="built_in">push</span>(start);</span><br><span class="line">	<span class="keyword">while</span>(q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">		rec=q.<span class="built_in">front</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		vis[rec]=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[rec];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">			<span class="keyword">if</span>(dis[ver[i]]&lt;dis[rec]+edge[i])&#123;</span><br><span class="line">				dis[ver[i]]=dis[rec]+edge[i];</span><br><span class="line">				<span class="keyword">if</span>(vis[ver[i]]==<span class="literal">false</span>)&#123;</span><br><span class="line">					vis[ver[i]]=<span class="literal">true</span>;</span><br><span class="line">					q.<span class="built_in">push</span>(ver[i]);</span><br><span class="line">					in[ver[i]]++;</span><br><span class="line">					<span class="keyword">if</span>(in[ver[i]]&gt;n+<span class="number">1</span>)</span><br><span class="line">						<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				&#125;;</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">	u=<span class="built_in">read</span>(),</span><br><span class="line">	v=<span class="built_in">read</span>(),</span><br><span class="line">	w=<span class="built_in">read</span>();</span><br><span class="line">	<span class="built_in">add</span>(u,v,-w);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="built_in">add</span>(<span class="number">0</span>,i,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">spfa</span>(<span class="number">0</span>)==<span class="literal">true</span>)&#123;</span><br><span class="line">	for_each(dis+<span class="number">1</span>,dis+n+<span class="number">1</span>,f);</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;NO\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="树的直径"><a href="#树的直径" class="headerlink" title="树的直径"></a>树的直径</h2><p>$O(n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> last)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(deep[k]&gt;maxn)</span><br><span class="line">		maxn=deep[rec=k];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(ver[i]!=last)&#123;</span><br><span class="line">			deep[ver[i]]=deep[k]+<span class="number">1</span>;</span><br><span class="line">			<span class="built_in">dfs1</span>(ver[i],k);</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> last)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(deep[k]&gt;maxn)</span><br><span class="line">		maxn=deep[rec=k];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(ver[i]!=last)&#123;</span><br><span class="line">			deep[ver[i]]=deep[k]+<span class="number">1</span>,</span><br><span class="line">			fa[ver[i]]=k;</span><br><span class="line">			<span class="built_in">dfs2</span>(ver[i],k);</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfsk</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> last)</span></span>&#123;</span><br><span class="line">	maxdeep[k]=deep[k];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(ver[i]!=last)&#123;</span><br><span class="line">			deep[ver[i]]=deep[k]+<span class="number">1</span>;</span><br><span class="line">			<span class="built_in">dfsk</span>(ver[i],k);</span><br><span class="line">			maxdeep[k]=<span class="built_in">max</span>(maxdeep[k],maxdeep[ver[i]]);</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">dfs1</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">maxn=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">memset</span>(deep,<span class="number">0</span>,<span class="built_in">sizeof</span>(deep));</span><br><span class="line"><span class="built_in">dfs2</span>(rec,<span class="number">0</span>);</span><br><span class="line">cntr=rec;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=(deep[rec]+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;i++)</span><br><span class="line">	cntr=fa[cntr];</span><br><span class="line"><span class="built_in">memset</span>(deep,<span class="number">0</span>,<span class="built_in">sizeof</span>(deep));</span><br><span class="line"><span class="built_in">dfsk</span>(cntr,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	ans[i]=maxdeep[i]-deep[i];</span><br><span class="line"><span class="built_in">sort</span>(ans+<span class="number">1</span>,ans+n+<span class="number">1</span>,cmp);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=K+<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	maxans=<span class="built_in">max</span>(maxans,ans[i]+<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h2 id="无向图双连通分量"><a href="#无向图双连通分量" class="headerlink" title="无向图双连通分量"></a>无向图双连通分量</h2><p>若一张无向连通图不存在割点，则称为<strong>点双连通图</strong> 。若一张无向连通图不存在桥，则称它为<strong>边双连通图</strong> 。</p>
<p>无向图的极大点双连通子图被称为<strong>点双连通分量</strong> ，简记为<strong>v-DCC</strong> 。无向连通图的极大边双连通子图被称为<strong>边双连通分量</strong> ，简记为<strong>e-DCC</strong> 。二者统称为<strong>双连通分量</strong> ，简记为<strong>DCC</strong> 。</p>
<p>一个双连通子图$G’&#x3D;(V’,E’)$<strong>极大</strong> （$V’\subseteq V,E’\subseteq E$），是指$\nexists G’’&#x3D;(V’’,E’’)\supseteq G’,\ V’\subseteq V’’\subseteq V, \ E’\subseteq E’’\subseteq E$，$G’’$也是双连通子图。</p>
<h4 id="定理-3"><a href="#定理-3" class="headerlink" title="定理"></a>定理</h4><p>一张无向连通图是点双连通图，当且仅当满足下列两个条件之一：<br>1、图的顶点数不超过2。<br>2、图中任意两点都同事包含在至少一个简单环中。<br><strong>简单环</strong>指的是不自交的环。</p>
<p>一张无向连通图是边双连通图，当且仅当任意一条边都包含在至少一个简单环中。</p>
<h3 id="e-DCC"><a href="#e-DCC" class="headerlink" title="e-DCC"></a>e-DCC</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//省略Tarjan割边</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	color[k]=cnt;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>((color[ver[i]]==<span class="number">0</span>)&amp;&amp;(vis[i]==<span class="literal">false</span>))</span><br><span class="line">			<span class="built_in">dfs</span>(ver[i]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(color[i]==<span class="number">0</span>)&#123;</span><br><span class="line">		cnt++;</span><br><span class="line">		<span class="built_in">dfs</span>(i);</span><br><span class="line">	&#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,tot);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d=&gt;%d\n&quot;</span>,i,color[i]);</span><br></pre></td></tr></table></figure>

<h3 id="v-DCC"><a href="#v-DCC" class="headerlink" title="v-DCC"></a>v-DCC</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">stack&lt;<span class="type">int</span>&gt;stk;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;ans[];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> flag=<span class="number">0</span>;</span><br><span class="line">	dfn[k]=low[k]=++nmb;</span><br><span class="line">	stk.<span class="built_in">push</span>(k);</span><br><span class="line">	<span class="keyword">if</span>((k==rt)&amp;&amp;(head[k]==<span class="number">0</span>))&#123;</span><br><span class="line">		ans[++cnt].<span class="built_in">push_back</span>(k);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;<span class="comment">//孤立点</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(dfn[ver[i]]==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">tarjan</span>(ver[i]);</span><br><span class="line">			low[k]=<span class="built_in">min</span>(low[k],low[ver[i]]);</span><br><span class="line">			<span class="keyword">if</span>(dfn[k]&lt;=low[ver[i]])&#123;</span><br><span class="line">				flag++;</span><br><span class="line">				<span class="keyword">if</span>((k!=rt)||(flag&gt;<span class="number">1</span>))</span><br><span class="line">					chk[k]=<span class="literal">true</span>;</span><br><span class="line">				cnt++,</span><br><span class="line">                tmp=<span class="number">0</span>;</span><br><span class="line">				<span class="keyword">while</span>(tmp!=ver[i])&#123;</span><br><span class="line">					tmp=stk.<span class="built_in">top</span>();</span><br><span class="line">					stk.<span class="built_in">pop</span>();</span><br><span class="line">					ans[cnt].<span class="built_in">push_back</span>(tmp);</span><br><span class="line">				&#125;;</span><br><span class="line">				ans[cnt].<span class="built_in">push_back</span>(k);</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			low[k]=<span class="built_in">min</span>(low[k],dfn[ver[i]]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">	<span class="keyword">if</span>(dfn[i]==<span class="number">0</span>)&#123;</span><br><span class="line">		rt=i;</span><br><span class="line">		<span class="built_in">tarjan</span>(i);</span><br><span class="line">	&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;#%d:\n&quot;</span>,i);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;ans[i].<span class="built_in">size</span>();j++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,ans[i].<span class="built_in">at</span>(j));</span><br><span class="line">	<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="缩点"><a href="#缩点" class="headerlink" title="缩点"></a>缩点</h2><h3 id="e-DCC-1"><a href="#e-DCC-1" class="headerlink" title="e-DCC"></a>e-DCC</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addc</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	verc[++totc]=y,</span><br><span class="line">	nextc[totc]=headc[x],</span><br><span class="line">	headc[x]=totc;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line">totc=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;=tot;i++)</span><br><span class="line">	<span class="keyword">if</span>(color[ver[i]]!=color[ver[i^<span class="number">1</span>]])</span><br><span class="line">		<span class="built_in">addc</span>(color[ver[i]],color[ver[i^<span class="number">1</span>]]);</span><br><span class="line"><span class="comment">//点数=tot 边数（有重边）=totc/2</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;totc;i+=<span class="number">2</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,verc[i],verc[i^<span class="number">1</span>]);</span><br></pre></td></tr></table></figure>

<h3 id="v-DCC-1"><a href="#v-DCC-1" class="headerlink" title="v-DCC"></a>v-DCC</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">nmb=cnt;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(chk[i]==<span class="literal">true</span>)</span><br><span class="line">		idc[i]=++nmb;</span><br><span class="line">totc=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;ans[i].<span class="built_in">size</span>();j++)</span><br><span class="line">		<span class="keyword">if</span>(chk[ans[i].<span class="built_in">at</span>(j)]==<span class="literal">true</span>)&#123;</span><br><span class="line">			<span class="built_in">addc</span>(i,idc[ans[i].<span class="built_in">at</span>(j)]);</span><br><span class="line">			<span class="built_in">addc</span>(idc[ans[i].<span class="built_in">at</span>(j)],i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			color[ans[i].<span class="built_in">at</span>(j)]=i;</span><br><span class="line"><span class="comment">//缩点后点数=num 边数=totc/2</span></span><br><span class="line"><span class="comment">//1~cnt为原图v-DCC编号 &gt;cnt为原图割点</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>;i&lt;totc;i+=<span class="number">2</span>)</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>,verc[i^<span class="number">1</span>],ver[i]);</span><br></pre></td></tr></table></figure>

<h2 id="Hierholzer"><a href="#Hierholzer" class="headerlink" title="Hierholzer"></a>Hierholzer</h2><p>给定一张无向图，若存在一条从节点$S$到节点$T$的路径，恰好不重不漏地经过每条边一次（可以重复经过图中的节点），则称该路径为$S$到$T$的<strong>欧拉路</strong> 。  </p>
<p>特别地，若存在一条从节点$S$出发的路径，恰好不重不漏地经过每条边一次（可以重复经过图中的节点），最终回到起点$S$，则称该路径为<strong>欧拉回路</strong> 。存在欧拉回路的无向图被称为<strong>欧拉图</strong> 。</p>
<h3 id="欧拉图判定"><a href="#欧拉图判定" class="headerlink" title="欧拉图判定"></a>欧拉图判定</h3><p>一张无向图为欧拉图，当且仅当无向图连通，并且每个点的度数都是偶数。</p>
<h3 id="欧拉路存在性判定"><a href="#欧拉路存在性判定" class="headerlink" title="欧拉路存在性判定"></a>欧拉路存在性判定</h3><p>一张无向图中存在欧拉路，当且仅当无向图连通，并且图中恰好有两个节点的度数为奇数，其他节点的度数都是偶数。这两个度数为奇数的节点就是欧拉路的起点$S$和终点$T$。</p>
<hr>
<p>有向图：<br>$O(nm+m^2)$<br>路径输出：$O(n+m\log m)$  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;edge[];</span><br><span class="line">stack&lt;<span class="type">int</span>&gt;ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;a,<span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.first&lt;b.first;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=rec[k];i&lt;edge[k].<span class="built_in">size</span>();i=<span class="built_in">fmax</span>(i+<span class="number">1</span>,rec[k]))</span><br><span class="line">		<span class="keyword">if</span>(vis[edge[k].<span class="built_in">at</span>(i).second]==<span class="literal">false</span>)&#123;</span><br><span class="line">			vis[edge[k].<span class="built_in">at</span>(i).second]=<span class="literal">true</span>,</span><br><span class="line">			rec[k]=i+<span class="number">1</span>;</span><br><span class="line">			<span class="built_in">dfs</span>(edge[k].<span class="built_in">at</span>(i).first);</span><br><span class="line">		&#125;;</span><br><span class="line">	ans.<span class="built_in">push</span>(k);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">	t1=<span class="built_in">read</span>(),</span><br><span class="line">	t2=<span class="built_in">read</span>(),</span><br><span class="line">	out[t1]++,</span><br><span class="line">	in[t2]++;</span><br><span class="line">	edge[t1].<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(t2,i));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//欧拉路判定</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(out[i]!=in[i])&#123;</span><br><span class="line">		cnt++;</span><br><span class="line">		<span class="keyword">if</span>(in[i]+<span class="number">1</span>==out[i])</span><br><span class="line">			start=i;</span><br><span class="line">		<span class="keyword">if</span>(out[i]+<span class="number">1</span>==in[i])</span><br><span class="line">			ed=i;</span><br><span class="line">	&#125;;</span><br><span class="line"><span class="keyword">if</span>((cnt!=<span class="number">0</span>)&amp;&amp;(cnt!=<span class="number">2</span>))&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;No\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">if</span>(cnt==<span class="number">0</span>)</span><br><span class="line">	start=ed=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>((start==<span class="number">0</span>)||(ed==<span class="number">0</span>))&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;No\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//字典序最小</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="built_in">sort</span>(edge[i].<span class="built_in">begin</span>(),edge[i].<span class="built_in">end</span>(),cmp);</span><br><span class="line"></span><br><span class="line"><span class="built_in">dfs</span>(start);</span><br><span class="line"><span class="keyword">while</span>(ans.<span class="built_in">empty</span>()==<span class="literal">false</span>)&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,ans.<span class="built_in">top</span>());</span><br><span class="line">	ans.<span class="built_in">pop</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="有向图强连通分量"><a href="#有向图强连通分量" class="headerlink" title="有向图强连通分量"></a>有向图强连通分量</h2><p>给定一张有向图。若对于图中任意两个节点$x,y$，既存在从$x$到$y$的路径，也存在从$y$到$x$的路径，则称该有向图是<strong>强连通图</strong> 。</p>
<p>有向图的极大强连通子图被称为<strong>强连通分量</strong> 。简记为<strong>SCC</strong> 。</p>
<h3 id="SCC"><a href="#SCC" class="headerlink" title="SCC"></a>SCC</h3><h4 id="强连通分量判定法则"><a href="#强连通分量判定法则" class="headerlink" title="强连通分量判定法则"></a>强连通分量判定法则</h4><p>在追溯值得计算过程中，若从$x$回溯前，有$low_x&#x3D;dfn_x$成立，则栈中从$x$到栈顶的所有节点构成一个强连通分量。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    dfn[k]=low[k]=++cnt,</span><br><span class="line">    chk[k]=<span class="literal">true</span>;</span><br><span class="line">    stk.<span class="built_in">push</span>(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">        <span class="keyword">if</span>(dfn[ver[i]]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(ver[i]);</span><br><span class="line">            low[k]=<span class="built_in">min</span>(low[k],low[ver[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">if</span>(chk[ver[i]]==<span class="literal">true</span>)</span><br><span class="line">                low[k]=<span class="built_in">min</span>(low[k],dfn[ver[i]]);</span><br><span class="line">    <span class="keyword">if</span>(dfn[k]==low[k])&#123;<span class="comment">//SCC判定法则</span></span><br><span class="line">        <span class="type">int</span> tmp=<span class="number">0</span>;</span><br><span class="line">        col++,</span><br><span class="line">        rec[col]++;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            tmp=stk.<span class="built_in">top</span>();</span><br><span class="line">            stk.<span class="built_in">pop</span>();</span><br><span class="line">            rec[col]++,</span><br><span class="line">            color[tmp]=col,</span><br><span class="line">            chk[tmp]=<span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span>(tmp==k)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(dfn[i]==<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">tarjan</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=col;i++)</span><br><span class="line">	<span class="keyword">if</span>(rec[i]&gt;maxn)</span><br><span class="line">		maxn=rec[pos=i];</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,rec[pos]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(color[i]==pos)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,i);</span><br></pre></td></tr></table></figure>

<h3 id="缩点-1"><a href="#缩点-1" class="headerlink" title="缩点"></a>缩点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addc</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	verc[++totc]=y,</span><br><span class="line">	nextc[totc]=headc[x],</span><br><span class="line">	headc[x]=totc;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=head[i];j!=<span class="number">0</span>;j=next[j])</span><br><span class="line">		<span class="keyword">if</span>(color[i]!=color[ver[j]])</span><br><span class="line">			<span class="built_in">addc</span>(color[i],color[ver[j]]);</span><br></pre></td></tr></table></figure>

<h2 id="二分图"><a href="#二分图" class="headerlink" title="二分图"></a>二分图</h2><p>任意两条边都没有公共端点的边的集合被称为图的一组<strong>匹配</strong> 。在二分图中，包含边数最多的一组匹配被称为二分图的<strong>最大匹配</strong> 。  </p>
<p>对于任意一组匹配$S$（$S$是一个边集），属于$S$的边被称为<strong>匹配边</strong> ，不属于的边被称为<strong>非匹配边</strong> 。匹配边的端点被称为<strong>匹配点</strong> ，其他节点被称为<strong>非匹配点</strong> 。  </p>
<p>如果在二分图中存在一条连接两个非匹配点的路径$path$，使得非匹配边匹配边在$path$上交替出现，那么称$path$是匹配$S$的<strong>增广路</strong>。</p>
<h4 id="性质-推论"><a href="#性质-推论" class="headerlink" title="性质&amp;推论"></a>性质&amp;推论</h4><p>1、长度$len\bmod 2&#x3D;1$。<br>2、路径上第$1+2n$条边是非匹配边，第$2n$条边是匹配边。<br>3、二分图的一组匹配$S$是最大匹配，当且仅当图中不存在$S$的增广路。</p>
<h3 id="二分图判定"><a href="#二分图判定" class="headerlink" title="二分图判定"></a>二分图判定</h3><p>$O(n+m)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="type">bool</span> ret=<span class="literal">true</span>;</span><br><span class="line">	color[k]=val;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=nxt[i])&#123;</span><br><span class="line">		<span class="keyword">if</span>(color[k]==color[ver[i]])</span><br><span class="line">			ret=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span>((color[ver[i]]==<span class="number">0</span>)&amp;&amp;(<span class="built_in">dfs</span>(ver[i],<span class="number">3</span>-val)==<span class="literal">false</span>))</span><br><span class="line">			ret=<span class="literal">false</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="匈牙利算法"><a href="#匈牙利算法" class="headerlink" title="匈牙利算法"></a>匈牙利算法</h3><p>二分图最大权匹配<br>$O(nm)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt;g[];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;g[k].<span class="built_in">size</span>();i++)</span><br><span class="line">		<span class="keyword">if</span>(vis[g[k].<span class="built_in">at</span>(i)]==<span class="literal">false</span>)&#123;</span><br><span class="line">			vis[g[k].<span class="built_in">at</span>(i)]=<span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span>((rec[g[k].<span class="built_in">at</span>(i)]==<span class="number">-1</span>)||(<span class="built_in">dfs</span>(rec[g[k].<span class="built_in">at</span>(i)])==<span class="literal">true</span>))&#123;</span><br><span class="line">				rec[g[k].<span class="built_in">at</span>(i)]=k;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mag</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(rec,<span class="number">-1</span>,<span class="built_in">sizeof</span>(rec));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">dfs</span>(i)==<span class="literal">true</span>)</span><br><span class="line">			sum++;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;n,&amp;m,&amp;e);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=e;i++)</span><br><span class="line">		g[t1].<span class="built_in">push_back</span>(t2);</span><br><span class="line">	<span class="built_in">mag</span>();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,sum);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="染色"><a href="#染色" class="headerlink" title="染色"></a>染色</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">paint</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> col)</span></span>&#123;</span><br><span class="line">	color[k]=col;</span><br><span class="line">	<span class="keyword">for</span>(vector&lt;<span class="type">int</span>&gt;::iterator it=a[k].<span class="built_in">begin</span>();it!=a[k].<span class="built_in">end</span>();it++)</span><br><span class="line">		<span class="keyword">if</span>(color[*it]==<span class="number">0</span>)</span><br><span class="line">			<span class="built_in">paint</span>(*it,<span class="number">3</span>-col);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	<span class="keyword">if</span>(color[i]==<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">paint</span>(i,<span class="number">1</span>);</span><br><span class="line"><span class="comment">//---------------------------------------</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(vector&lt;<span class="type">int</span>&gt;::iterator it=a[k].<span class="built_in">begin</span>();it!=a[k].<span class="built_in">end</span>();it++)</span><br><span class="line">		<span class="keyword">if</span>(vis[*it]==<span class="literal">false</span>)&#123;</span><br><span class="line">			vis[*it]=<span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span>((rec[*it]==<span class="number">0</span>)||(<span class="built_in">dfs</span>(rec[*it])==<span class="literal">true</span>))&#123;</span><br><span class="line">				rec[*it]=k;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">hgr</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">      </span><br><span class="line">		<span class="keyword">if</span>(color[i]!=<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">      </span><br><span class="line">		<span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">dfs</span>(i)==<span class="literal">true</span>)</span><br><span class="line">			ret++;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="同余最短路"><a href="#同余最短路" class="headerlink" title="同余最短路"></a>同余最短路</h2><p>给定$m$个整数，求这$m$个整数能拼凑出多少的其他整数（这$m$个整数可以重复取）或给定$m$个整数，求这$m$个整数不能拼凑出的最小（最大）的整数（$\leq h$）。  </p>
<p>对于$\forall r\in[1,a_1)$建立一个点，对于每个点$u$连一条到$v&#x3D;(u+a_i)\bmod a_1, \ i\in[2,m]$的边，长度为$a_i$，从0开始跑最短路，可以到$\dfrac{h−dis_r}{a_1}+1$个整数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;a[<span class="number">1</span>];i++)</span><br><span class="line">		<span class="keyword">if</span>(dis[i]&lt;=k)</span><br><span class="line">			ret+=(k-dis[i])/a[<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;a[<span class="number">1</span>];i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">2</span>;j&lt;=n;j++)</span><br><span class="line">		<span class="built_in">add</span>(i,(i+a[j])%a[<span class="number">1</span>],a[j]);</span><br><span class="line"><span class="built_in">spfa</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">query</span>(h));<span class="comment">//能拼凑出其他整数（≤h）的数量</span></span><br></pre></td></tr></table></figure>

<h2 id="建图"><a href="#建图" class="headerlink" title="建图"></a>建图</h2><h3 id="按边建图"><a href="#按边建图" class="headerlink" title="按边建图"></a>按边建图</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> nl,nr,w;</span><br><span class="line">	set&lt;<span class="type">int</span>&gt;setl,setr;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;vecl,vecr;</span><br><span class="line">&#125;a[<span class="number">101</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	nmb=<span class="built_in">read</span>(),</span><br><span class="line">	a[nmb].w=<span class="built_in">read</span>(),</span><br><span class="line">	t1=<span class="built_in">read</span>(),</span><br><span class="line">	t2=<span class="built_in">read</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=t1;j++)&#123;</span><br><span class="line">		t3=<span class="built_in">read</span>();</span><br><span class="line">		a[nmb].setl.<span class="built_in">insert</span>(t3);</span><br><span class="line">		a[nmb].vecl.<span class="built_in">push_back</span>(t3);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=t2;j++)&#123;</span><br><span class="line">		t3=<span class="built_in">read</span>();</span><br><span class="line">		a[nmb].setr.<span class="built_in">insert</span>(t3);</span><br><span class="line">		a[nmb].vecr.<span class="built_in">push_back</span>(t3);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="keyword">if</span>(a[i].nl==<span class="number">0</span>)&#123;</span><br><span class="line">		a[i].nl=++tot;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;a[i].setl.<span class="built_in">size</span>();j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[a[i].vecl[j]].setr.<span class="built_in">count</span>(i)==<span class="number">1</span>)</span><br><span class="line">				a[a[i].vecl[j]].nr=a[i].nl;</span><br><span class="line">			<span class="keyword">if</span>(a[a[i].vecl[j]].setl.<span class="built_in">count</span>(i)==<span class="number">1</span>)</span><br><span class="line">				a[a[i].vecl[j]].nl=a[i].nl;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(a[i].nr==<span class="number">0</span>)&#123;</span><br><span class="line">		a[i].nr=++tot;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;a[i].setr.<span class="built_in">size</span>();j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[a[i].vecr[j]].setr.<span class="built_in">count</span>(i)==<span class="number">1</span>)</span><br><span class="line">				a[a[i].vecr[j]].nr=a[i].nr;</span><br><span class="line">			<span class="keyword">if</span>(a[a[i].vecr[j]].setl.<span class="built_in">count</span>(i)==<span class="number">1</span>)</span><br><span class="line">				a[a[i].vecr[j]].nl=a[i].nr;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="built_in">add</span>(a[i].nl,a[i].nr,a[i].w);</span><br><span class="line">	<span class="built_in">add</span>(a[i].nr,a[i].nl,a[i].w);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h2><p>$O(\alpha(n))$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> fa[N+<span class="number">1</span>],size[N+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;fa[i]=i,size[i++]=<span class="number">1</span>);</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;<span class="comment">//路径压缩</span></span><br><span class="line">	<span class="keyword">return</span> x==fa[x]?x:fa[x]=<span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">unio</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> ta=<span class="built_in">find</span>(a),tb=<span class="built_in">find</span>(b);</span><br><span class="line">	fa[ta]=tb;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">unio</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;<span class="comment">//按秩合并</span></span><br><span class="line">	<span class="type">int</span> ta=<span class="built_in">find</span>(a),tb=<span class="built_in">find</span>(b);</span><br><span class="line">	<span class="keyword">if</span>(size[ta]&gt;size[tb])</span><br><span class="line">		<span class="built_in">swap</span>(ta,tb);</span><br><span class="line">	size[tb]+=size[ta],</span><br><span class="line">	fa[ta]=tb,</span><br><span class="line">	size[ta]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="带权并查集"><a href="#带权并查集" class="headerlink" title="带权并查集"></a>带权并查集</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dis：x到fa[x]的边权和 size：树根集合大小</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	fa[i]=i,</span><br><span class="line">	size[i]=...;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(fa[x]==x)</span><br><span class="line">		<span class="keyword">return</span> x;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> root=<span class="built_in">find</span>(fa[x]);</span><br><span class="line">	dis[x]+=dis[fa[x]];</span><br><span class="line">	<span class="keyword">return</span> fa[x]=root;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">unio</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> ta=<span class="built_in">find</span>(a),tb=<span class="built_in">find</span>(b);</span><br><span class="line">	<span class="keyword">if</span>(ta==tb)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	fa[ta]=tb,</span><br><span class="line">	dis[ta]=size[tb],</span><br><span class="line">	size[tb]+=size[ta];</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h2><p>$O(\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[N+<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">const</span> <span class="type">int</span> t)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> t&amp;-t;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> pos,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(pos&lt;=N)</span><br><span class="line">		a[pos]+=val,</span><br><span class="line">		pos+=<span class="built_in">lowbit</span>(pos);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> pos)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(pos&gt;<span class="number">0</span>)</span><br><span class="line">		ret+=a[pos],</span><br><span class="line">		pos-=<span class="built_in">lowbit</span>(pos);</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="二维树状数组"><a href="#二维树状数组" class="headerlink" title="二维树状数组"></a>二维树状数组</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&amp;-x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ty=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x&lt;=n)&#123;</span><br><span class="line">		ty=y;</span><br><span class="line">		<span class="keyword">while</span>(ty&lt;=n)</span><br><span class="line">			tree[x][ty]+=val,</span><br><span class="line">			ty+=<span class="built_in">lowbit</span>(ty);</span><br><span class="line">		x+=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> res,ty;</span><br><span class="line">	res=ty=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(x&gt;<span class="number">0</span>)&#123;</span><br><span class="line">		ty=y;</span><br><span class="line">		<span class="keyword">while</span>(ty&gt;<span class="number">0</span>)</span><br><span class="line">			res+=tree[x][ty],</span><br><span class="line">			ty-=<span class="built_in">lowbit</span>(ty);</span><br><span class="line">		x-=<span class="built_in">lowbit</span>(x);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">////////////////////////////</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> md,<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=x;i&lt;=n;i+=<span class="built_in">lowbit</span>(i))</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=y;j&lt;=m;j+=<span class="built_in">lowbit</span>(j))</span><br><span class="line">            tree[md][i][j]+=val;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">const</span> <span class="type">int</span> md,<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=x;i&gt;<span class="number">0</span>;i-=<span class="built_in">lowbit</span>(i))</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=y;j&gt;<span class="number">0</span>;j-=<span class="built_in">lowbit</span>(j))</span><br><span class="line">            ret+=tree[md][i][j];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="逆序对"><a href="#逆序对" class="headerlink" title="逆序对"></a>逆序对</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--)&#123;</span><br><span class="line">    <span class="built_in">insert</span>(a[i],<span class="number">1</span>);</span><br><span class="line">    ans+=<span class="built_in">query</span>(a[i]<span class="number">-1</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="区间种类数"><a href="#区间种类数" class="headerlink" title="区间种类数"></a>区间种类数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> data a,<span class="type">const</span> data b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.r&lt;b.r;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&amp;-x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> pos,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(pos&lt;=n)</span><br><span class="line">        tree[pos]+=val,</span><br><span class="line">        pos+=<span class="built_in">lowbit</span>(pos);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> pos)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(pos&gt;<span class="number">0</span>)</span><br><span class="line">        ret+=tree[pos],</span><br><span class="line">        pos-=<span class="built_in">lowbit</span>(pos);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;a[i++]=<span class="built_in">read</span>());</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">        qst[i].l=<span class="built_in">read</span>(),</span><br><span class="line">        qst[i].r=<span class="built_in">read</span>(),</span><br><span class="line">        qst[i].n=i;</span><br><span class="line">    <span class="built_in">sort</span>(qst+<span class="number">1</span>,qst+m+<span class="number">1</span>,cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=next;j&lt;=qst[i].r;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(rec[a[j]]!=<span class="number">0</span>)</span><br><span class="line">                <span class="built_in">add</span>(rec[a[j]],<span class="number">-1</span>);</span><br><span class="line">            <span class="built_in">add</span>(j,<span class="number">1</span>);</span><br><span class="line">            rec[a[j]]=j;</span><br><span class="line">        &#125;;</span><br><span class="line">        next=qst[i].r+<span class="number">1</span>,</span><br><span class="line">        ans[qst[i].n]=<span class="built_in">sum</span>(qst[i].r)-<span class="built_in">sum</span>(qst[i].l<span class="number">-1</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h2><p>$O(\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,w,f;</span><br><span class="line">&#125;tree[N&lt;&lt;<span class="number">2</span>|<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;<span class="comment">//建树</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	tree[k].l=l,</span><br><span class="line">	tree[k].r=r;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].l==tree[k].r)&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;tree[k].w);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">build</span>(l,m,k&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">build</span>(m+<span class="number">1</span>,r,k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	tree[k].w=tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;<span class="comment">//懒惰标记下传</span></span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>].f+=tree[k].f,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].f+=tree[k].f,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>].w+=tree[k].f*(tree[k&lt;&lt;<span class="number">1</span>].r-tree[k&lt;&lt;<span class="number">1</span>].l+<span class="number">1</span>),</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w+=tree[k].f*(tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].r-tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].l+<span class="number">1</span>),</span><br><span class="line">	tree[k].f=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_point</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;<span class="comment">//单点修改</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(tree[k].l+tree.r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].l==tree[k].r)&#123;</span><br><span class="line">		tree[k].w+=k;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].f!=<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">pushdown</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=m)</span><br><span class="line">		<span class="built_in">add_point</span>(k&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">add_point</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	tree[k].w=tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask_point</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;<span class="comment">//单点询问</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(tree[k].l+tree[k].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].l==tree[k].r)&#123;</span><br><span class="line">		ret=tree[k].w;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].f!=<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">pushdown</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=m)</span><br><span class="line">		<span class="built_in">ask_point</span>(k&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">ask_point</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask_range</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;<span class="comment">//区间询问</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(tree[k].l+tree[k].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((tree[k].l&gt;=x)&amp;&amp;(tree[k].r&lt;=y))&#123;</span><br><span class="line">		ans+=tree[k].w;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].f!=<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">pushdown</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=m)</span><br><span class="line">		<span class="built_in">ask_range</span>(k&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">if</span>(y&gt;m)</span><br><span class="line">		<span class="built_in">ask_range</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_range</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;<span class="comment">//区间修改</span></span><br><span class="line">    <span class="type">int</span> m=(tree[k].l+tree[k].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((tree[k].l&gt;=x)&amp;&amp;(tree[k].r&lt;=y))&#123;</span><br><span class="line">		tree[k].w+=(tree[k].r-tree[k].l+<span class="number">1</span>)*tek,</span><br><span class="line">		tree[k].f+=tek;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].f!=<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">pushdown</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=m)</span><br><span class="line">		<span class="built_in">add_range</span>(k&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">if</span>(y&gt;m)</span><br><span class="line">		<span class="built_in">add_range</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	tree[k].w=tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="线段树2"><a href="#线段树2" class="headerlink" title="线段树2"></a>线段树2</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> w,add,mul;</span><br><span class="line">&#125;tree[<span class="number">400001</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	tree[k].mul=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">		tree[k].w=<span class="built_in">read</span>()%p;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">build</span>(l,m,k&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">build</span>(m+<span class="number">1</span>,r,k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	tree[k].w=(tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w)%p;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>].w=(tree[k&lt;&lt;<span class="number">1</span>].w*tree[k].mul+tree[k].add*(m-l+<span class="number">1</span>))%p,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w=(tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w*tree[k].mul+tree[k].add*(r-m))%p,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>].mul=(tree[k&lt;&lt;<span class="number">1</span>].mul*tree[k].mul)%p,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mul=(tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mul*tree[k].mul)%p,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>].add=(tree[k&lt;&lt;<span class="number">1</span>].add*tree[k].mul+tree[k].add)%p,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].add=(tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].add*tree[k].mul+tree[k].add)%p,</span><br><span class="line">	tree[k].mul=<span class="number">1</span>,</span><br><span class="line">	tree[k].add=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mul_range</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;<span class="comment">//区间乘</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((L&lt;=l)&amp;&amp;(R&gt;=r))&#123;</span><br><span class="line">		tree[k].w=(tree[k].w*val)%p,</span><br><span class="line">		tree[k].mul=(tree[k].mul*val)%p,</span><br><span class="line">		tree[k].add=(tree[k].add*val)%p;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">pushdown</span>(k,l,r);</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=m)</span><br><span class="line">		<span class="built_in">mul_range</span>(k&lt;&lt;<span class="number">1</span>,l,m);</span><br><span class="line">	<span class="keyword">if</span>(R&gt;m)</span><br><span class="line">		<span class="built_in">mul_range</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,m+<span class="number">1</span>,r);</span><br><span class="line">	tree[k].w=(tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w)%p;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_range</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;<span class="comment">//区间加</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((L&lt;=l)&amp;&amp;(R&gt;=r))&#123;</span><br><span class="line">		tree[k].add=(tree[k].add+val)%p,</span><br><span class="line">		tree[k].w=(tree[k].w+val*(r-l+<span class="number">1</span>))%p;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">pushdown</span>(k,l,r);</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=m)</span><br><span class="line">		<span class="built_in">add_range</span>(k&lt;&lt;<span class="number">1</span>,l,m);</span><br><span class="line">	<span class="keyword">if</span>(R&gt;m)</span><br><span class="line">		<span class="built_in">add_range</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,m+<span class="number">1</span>,r);</span><br><span class="line">	tree[k].w=(tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w)%p;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask_range</span><span class="params">(<span class="type">const</span> <span class="type">int</span> ,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;<span class="comment">//区间求和</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((L&lt;=l)&amp;&amp;(R&gt;=r))&#123;</span><br><span class="line">		ans=(ans+tree[k].w)%p;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">pushdown</span>(k,l,r);</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=m)</span><br><span class="line">		<span class="built_in">ask_range</span>(k&lt;&lt;<span class="number">1</span>,l,m);</span><br><span class="line">	<span class="keyword">if</span>(R&gt;m)</span><br><span class="line">        <span class="built_in">ask_range</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,m+<span class="number">1</span>,r);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="线段树优化建边"><a href="#线段树优化建边" class="headerlink" title="线段树优化建边"></a>线段树优化建边</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r;</span><br><span class="line">&#125;tree[];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> &amp;k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">int</span> md)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">		k=l;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	k=++cnt;</span><br><span class="line">	<span class="built_in">build</span>(tree[k].l,l,mid,md);</span><br><span class="line">	<span class="built_in">build</span>(tree[k].r,mid+<span class="number">1</span>,r,md);</span><br><span class="line">	<span class="keyword">if</span>(md==<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">add</span>(k,tree[k].l,<span class="number">0</span>);</span><br><span class="line">		<span class="built_in">add</span>(k,tree[k].r,<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">add</span>(tree[k].l,k,<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">add</span>(tree[k].r,k,<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> L,<span class="type">const</span> <span class="type">int</span> R,<span class="type">const</span> <span class="type">int</span> val,<span class="type">const</span> <span class="type">int</span> md,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((l&gt;=L)&amp;&amp;(r&lt;=R))&#123;</span><br><span class="line">		<span class="keyword">if</span>(md==<span class="number">1</span>)</span><br><span class="line">			<span class="built_in">add</span>(a,k,val);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">add</span>(k,a,val);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=mid)</span><br><span class="line">		<span class="built_in">modify</span>(tree[k].l,a,L,R,val,md,l,mid);</span><br><span class="line">	<span class="keyword">if</span>(R&gt;mid)</span><br><span class="line">		<span class="built_in">modify</span>(tree[k].r,a,L,R,val,md,mid+<span class="number">1</span>,r);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line">cnt=n;</span><br><span class="line"><span class="built_in">build</span>(root1,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line"><span class="built_in">build</span>(root2,<span class="number">1</span>,n,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">add</span>(u,v,w);<span class="comment">//u-&gt;v:w</span></span><br><span class="line"><span class="built_in">modify</span>(root1,u,l,r,w,<span class="number">1</span>,<span class="number">1</span>,n);<span class="comment">//u-&gt;[l,r]:w</span></span><br><span class="line"><span class="built_in">modify</span>(root2,v,l,r,w,<span class="number">2</span>,<span class="number">1</span>,n);<span class="comment">//[l,r]-&gt;v:w</span></span><br></pre></td></tr></table></figure>

<h2 id="扫描线"><a href="#扫描线" class="headerlink" title="扫描线"></a>扫描线</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data1</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,sum,len;</span><br><span class="line">&#125;tree[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">data2</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,h,mark;</span><br><span class="line">&#125;scanline[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp1</span><span class="params">(<span class="type">const</span> data2 a,<span class="type">const</span> data2 b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a.h&lt;b.h;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">cmp2</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a&lt;b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	tree[k].l=l,</span><br><span class="line">	tree[k].r=r;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].l==tree[k].r)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	<span class="built_in">build</span>(k&lt;&lt;<span class="number">1</span>,l,m);</span><br><span class="line">	<span class="built_in">build</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,m+<span class="number">1</span>,r);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>((a[tree[k].r+<span class="number">1</span>]&lt;=l)||(r&lt;=a[tree[k].l]))</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	<span class="keyword">if</span>((l&lt;=a[tree[k].l])&amp;&amp;(a[tree[k].r+<span class="number">1</span>]&lt;=r))&#123;</span><br><span class="line">		tree[k].sum+=val;</span><br><span class="line">		<span class="keyword">if</span>(tree[k].sum&gt;<span class="number">0</span>)</span><br><span class="line">			tree[k].len=a[tree[k].r+<span class="number">1</span>]-a[tree[k].l];</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			tree[k].len=tree[k&lt;&lt;<span class="number">1</span>].len+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].len;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">modify</span>(k&lt;&lt;<span class="number">1</span>,l,r,val);</span><br><span class="line">	<span class="built_in">modify</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,val);</span><br><span class="line">	<span class="keyword">if</span>(tree[k].sum&gt;<span class="number">0</span>)</span><br><span class="line">		tree[k].len=a[tree[k].r+<span class="number">1</span>]-a[tree[k].l];</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		tree[k].len=tree[k&lt;&lt;<span class="number">1</span>].len+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].len;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		t1=<span class="built_in">read</span>(),</span><br><span class="line">		t2=<span class="built_in">read</span>(),</span><br><span class="line">		t3=<span class="built_in">read</span>(),</span><br><span class="line">		t4=<span class="built_in">read</span>(),</span><br><span class="line">		scanline[i&lt;&lt;<span class="number">1</span>].l=scanline[(i&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>].l=t1,</span><br><span class="line">		scanline[i&lt;&lt;<span class="number">1</span>].r=scanline[(i&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>].r=t3,</span><br><span class="line">		scanline[(i&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>].h=t2,</span><br><span class="line">		scanline[i&lt;&lt;<span class="number">1</span>].h=t4,</span><br><span class="line">		scanline[(i&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>].mark=<span class="number">1</span>,</span><br><span class="line">		scanline[i&lt;&lt;<span class="number">1</span>].mark=<span class="number">-1</span>,</span><br><span class="line">		a[(i&lt;&lt;<span class="number">1</span>)<span class="number">-1</span>]=t1,</span><br><span class="line">		a[i&lt;&lt;<span class="number">1</span>]=t3;</span><br><span class="line">	<span class="built_in">sort</span>(scanline+<span class="number">1</span>,scanline+(n&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>,cmp1);</span><br><span class="line">	<span class="built_in">sort</span>(a+<span class="number">1</span>,a+(n&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>,cmp2);</span><br><span class="line">	<span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="built_in">unique</span>(a+<span class="number">1</span>,a+(n&lt;&lt;<span class="number">1</span>)+<span class="number">1</span>)-a<span class="number">-2</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;(n&lt;&lt;<span class="number">1</span>);i++)&#123;</span><br><span class="line">		<span class="built_in">modify</span>(<span class="number">1</span>,scanline[i].l,scanline[i].r,scanline[i].mark);</span><br><span class="line">		ans+=tree[<span class="number">1</span>].len*(scanline[i+<span class="number">1</span>].h-scanline[i].h);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="左偏树"><a href="#左偏树" class="headerlink" title="左偏树"></a>左偏树</h2><p>(TLEx1)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>((x==<span class="number">0</span>)||(y==<span class="number">0</span>))</span><br><span class="line">		<span class="keyword">return</span> x|y;</span><br><span class="line">	<span class="keyword">if</span>((val[x]&gt;val[y])||((val[x]==val[y])&amp;&amp;(x&gt;y)))</span><br><span class="line">		<span class="built_in">swap</span>(x,y);</span><br><span class="line">	ch[x][<span class="number">1</span>]=<span class="built_in">merge</span>(ch[x][<span class="number">1</span>],y),</span><br><span class="line">	fa[ch[x][<span class="number">1</span>]]=x;</span><br><span class="line">	<span class="keyword">if</span>(dis[ch[x][<span class="number">0</span>]]&lt;dis[ch[x][<span class="number">1</span>]])</span><br><span class="line">        ch[x][<span class="number">0</span>]^=ch[x][<span class="number">1</span>]^=ch[x][<span class="number">0</span>]^=ch[x][<span class="number">1</span>];</span><br><span class="line">	dis[x]=dis[ch[x][<span class="number">1</span>]]+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getf</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fa[x]==<span class="number">0</span>?x:<span class="built_in">getf</span>(fa[x]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pop</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	val[x]=<span class="number">-1</span>,</span><br><span class="line">	fa[ch[x][<span class="number">0</span>]]=fa[ch[x][<span class="number">1</span>]]=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">merge</span>(ch[x][<span class="number">0</span>],ch[x][<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;val[i++]=<span class="built_in">read</span>());</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		opr=<span class="built_in">read</span>(),</span><br><span class="line">		x=<span class="built_in">read</span>();</span><br><span class="line">		<span class="keyword">if</span>(opr==<span class="number">1</span>)&#123;</span><br><span class="line">			y=<span class="built_in">read</span>();</span><br><span class="line">			<span class="keyword">if</span>((val[x]==<span class="number">-1</span>)||(val[y]==<span class="number">-1</span>))</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			fx=<span class="built_in">getf</span>(x),</span><br><span class="line">			fy=<span class="built_in">getf</span>(y);</span><br><span class="line">			<span class="keyword">if</span>(fx==fy)</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			<span class="built_in">merge</span>(fx,fy);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">if</span>(val[x]==<span class="number">-1</span>)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;-1\n&quot;</span>);</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,val[<span class="built_in">getf</span>(x)]);</span><br><span class="line">				<span class="built_in">pop</span>(<span class="built_in">getf</span>(x));</span><br><span class="line">			&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="ST表"><a href="#ST表" class="headerlink" title="ST表"></a>ST表</h2><p>令$f_{i,j}&#x3D;\max{[i,i+2^j-1]}$。  </p>
<p>显然$f(i,0)&#x3D;a_i$。   </p>
<p>根据定义式，第二维就相当于倍增的时候“跳了$2^j-1$步”，依据倍增的思路，写出状态转移方程：$f_{i,j}&#x3D;\max{f_{i,j-1},f_{i+2^{j-1},j-1}}$。  </p>
<p>对于每个询问$[l,r]$，我们把它分成两部分：$f_{l,l+2^s-1}$与$f_{r-2^s+1,r}$，其中$s&#x3D;\lfloor\log_2(r-l+1)\rfloor$。两部分的结果的最大值就是回答。  </p>
<p>预处理：$\Theta(n\log n)$<br>查询：$\Theta(1)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> f[N][<span class="built_in">log</span>(N)];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> k=<span class="built_in">log</span>(r-l+<span class="number">1</span>)/<span class="built_in">log</span>(<span class="number">2</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>(f[l][k],f[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	f[i][<span class="number">0</span>]=a[i];</span><br><span class="line"><span class="type">int</span> t=<span class="built_in">log</span>(n)/<span class="built_in">log</span>(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=t;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=n-(<span class="number">1</span>&lt;&lt;i)+<span class="number">1</span>;j++)</span><br><span class="line">		f[j][i]=<span class="built_in">max</span>(f[j][i<span class="number">-1</span>],f[j+(<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>))][i<span class="number">-1</span>]);</span><br></pre></td></tr></table></figure>

<h2 id="珂朵莉树"><a href="#珂朵莉树" class="headerlink" title="珂朵莉树"></a>珂朵莉树</h2><p>$O(n\log\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r;</span><br><span class="line">	<span class="keyword">mutable</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> val;</span><br><span class="line">	<span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> data &amp;a)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> l&lt;a.l;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">data</span>(<span class="type">int</span> L,<span class="type">int</span> R=<span class="number">-1</span>,<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> Val=<span class="number">0</span>):<span class="built_in">l</span>(L),<span class="built_in">r</span>(R),<span class="built_in">val</span>(Val)&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;data&gt;s;</span><br><span class="line"><span class="keyword">inline</span> set&lt;data&gt;::<span class="function">iterator <span class="title">split</span><span class="params">(<span class="type">const</span> <span class="type">int</span> pos)</span></span>&#123;</span><br><span class="line">	set&lt;data&gt;::iterator it=s.<span class="built_in">lower_bound</span>(<span class="built_in">data</span>(pos));</span><br><span class="line">	<span class="keyword">if</span>((it!=s.<span class="built_in">end</span>())&amp;&amp;(it-&gt;l==pos))</span><br><span class="line">		<span class="keyword">return</span> it;</span><br><span class="line">	it--;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> tl=it-&gt;l,tr=it-&gt;r;</span><br><span class="line">	<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> tv=it-&gt;val;</span><br><span class="line">	s.<span class="built_in">erase</span>(it);</span><br><span class="line">	s.<span class="built_in">insert</span>(<span class="built_in">data</span>(tl,pos<span class="number">-1</span>,tv));</span><br><span class="line">	<span class="keyword">return</span> s.<span class="built_in">insert</span>(<span class="built_in">data</span>(pos,tr,tv)).first;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">assign</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> val)</span></span>&#123;<span class="comment">//区间推平</span></span><br><span class="line">	set&lt;data&gt;::iterator itr=<span class="built_in">split</span>(r+<span class="number">1</span>),itl=<span class="built_in">split</span>(l);</span><br><span class="line">	s.<span class="built_in">erase</span>(itl,itr);</span><br><span class="line">	s.<span class="built_in">insert</span>(<span class="built_in">data</span>(l,r,val));</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> val)</span></span>&#123;<span class="comment">//区间加</span></span><br><span class="line">	set&lt;data&gt;::iterator itr=<span class="built_in">split</span>(r+<span class="number">1</span>),itl=<span class="built_in">split</span>(l);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> set&lt;data&gt;::iterator it=itl;it!=itr;it++)</span><br><span class="line">		it-&gt;val+=val;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">kthele</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">int</span> k)</span></span>&#123;<span class="comment">//第k值</span></span><br><span class="line">	set&lt;data&gt;::iterator itr=<span class="built_in">split</span>(r+<span class="number">1</span>),itl=<span class="built_in">split</span>(l);</span><br><span class="line">	vector&lt;pair&lt;<span class="type">long</span> <span class="type">long</span> <span class="type">int</span>,<span class="type">int</span>&gt; &gt;vc;</span><br><span class="line">	vc.<span class="built_in">clear</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> set&lt;data&gt;::iterator it=itl;it!=itr;it++)</span><br><span class="line">		vc.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(it-&gt;val,it-&gt;r-it-&gt;l+<span class="number">1</span>));</span><br><span class="line">	<span class="built_in">sort</span>(vc.<span class="built_in">begin</span>(),vc.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> vector&lt;pair&lt;<span class="type">long</span> <span class="type">long</span> <span class="type">int</span>,<span class="type">int</span>&gt; &gt;::iterator it=vc.<span class="built_in">begin</span>();it!=vc.<span class="built_in">end</span>();it++)&#123;</span><br><span class="line">		k-=it-&gt;second;</span><br><span class="line">		<span class="keyword">if</span>(k&lt;=<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> it-&gt;first;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	set&lt;data&gt;::iterator itr=<span class="built_in">split</span>(r+<span class="number">1</span>),itl=<span class="built_in">split</span>(l);</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> set&lt;data&gt;::iterator it=itl;it!=itr;it++)</span><br><span class="line">		res=(res+(<span class="type">long</span> <span class="type">long</span> <span class="type">int</span>)(it-&gt;r-it-&gt;l+<span class="number">1</span>)*<span class="built_in">qpow</span>(it-&gt;val,x,y))%y;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	set&lt;data&gt;::iterator itr=<span class="built_in">split</span>(r+<span class="number">1</span>),itl=<span class="built_in">split</span>(l);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> set&lt;data&gt;::iterator it=itl;it!=itr;it++)</span><br><span class="line">		it-&gt;val^=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	set&lt;data&gt;::iterator itr=<span class="built_in">split</span>(r+<span class="number">1</span>),itl=<span class="built_in">split</span>(l);</span><br><span class="line">	<span class="type">int</span> rec=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> set&lt;data&gt;::iterator it=itl;it!=itr;it++)</span><br><span class="line">		<span class="keyword">if</span>(it-&gt;val==<span class="literal">true</span>)</span><br><span class="line">			rec+=it-&gt;r-it-&gt;l+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> rec;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cnt</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	set&lt;data&gt;::iterator itr=<span class="built_in">split</span>(r+<span class="number">1</span>),itl=<span class="built_in">split</span>(l);</span><br><span class="line">	<span class="type">int</span> tmp=<span class="number">0</span>,res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> set&lt;data&gt;::iterator it=itl;it!=itr;it++)</span><br><span class="line">		<span class="keyword">if</span>(it-&gt;val==<span class="literal">true</span>)</span><br><span class="line">			tmp+=it-&gt;r-it-&gt;l+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			res=<span class="built_in">max</span>(res,tmp),</span><br><span class="line">			tmp=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>(res,tmp);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		s.<span class="built_in">insert</span>(<span class="built_in">data</span>(i,i,a[i]));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="vector平衡树"><a href="#vector平衡树" class="headerlink" title="vector平衡树"></a>vector平衡树</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tree.<span class="built_in">insert</span>(<span class="built_in">lower_bound</span>(tree.<span class="built_in">begin</span>(),tree.<span class="built_in">end</span>(),t),t);<span class="comment">//插入t</span></span><br><span class="line">tree.<span class="built_in">erase</span>(<span class="built_in">lower_bound</span>(tree.<span class="built_in">begin</span>(),tree.<span class="built_in">end</span>(),t));<span class="comment">//删除t</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">lower_bound</span>(tree.<span class="built_in">begin</span>(),tree.<span class="built_in">end</span>(),t)-tree.<span class="built_in">begin</span>()+<span class="number">1</span>);<span class="comment">//查询t的排名</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,tree.<span class="built_in">at</span>(t<span class="number">-1</span>));<span class="comment">//查询排名为t的数</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,tree.<span class="built_in">at</span>(<span class="built_in">lower_bound</span>(tree.<span class="built_in">begin</span>(),tree.<span class="built_in">end</span>(),t)-tree.<span class="built_in">begin</span>()<span class="number">-1</span>));<span class="comment">//求t的前驱</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,tree.<span class="built_in">at</span>(<span class="built_in">upper_bound</span>(tree.<span class="built_in">begin</span>(),tree.<span class="built_in">end</span>(),t)-tree.<span class="built_in">begin</span>()));<span class="comment">//求t的后继 </span></span><br></pre></td></tr></table></figure>

<h2 id="可持久数组"><a href="#可持久数组" class="headerlink" title="可持久数组"></a>可持久数组</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,w;</span><br><span class="line">&#125;tree[<span class="number">40</span>*<span class="number">1000001</span>];</span><br><span class="line"><span class="type">int</span> n,m,a,b,c,d,root[<span class="number">1000001</span>],top,t[<span class="number">1000001</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	tree[++top]=tree[k];</span><br><span class="line">	<span class="keyword">return</span> top;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build_tree</span><span class="params">(<span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> begin,<span class="type">const</span> <span class="type">int</span> end)</span></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(begin+end)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	k=++top;</span><br><span class="line">	<span class="keyword">if</span>(begin==end)&#123;</span><br><span class="line">		tree[k].w=t[begin];</span><br><span class="line">		<span class="keyword">return</span> top;</span><br><span class="line">	&#125;;</span><br><span class="line">	tree[k].l=<span class="built_in">build_tree</span>(tree[k].l,begin,m);</span><br><span class="line">	tree[k].r=<span class="built_in">build_tree</span>(tree[k].r,m+<span class="number">1</span>,end);</span><br><span class="line">	<span class="keyword">return</span> k;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">update</span><span class="params">(<span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> begin,<span class="type">const</span> <span class="type">int</span> end,<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(begin+end)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	k=<span class="built_in">add</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(begin==end)&#123;</span><br><span class="line">		tree[k].w=val;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=m)</span><br><span class="line">		tree[k].l=<span class="built_in">update</span>(tree[k].l,begin,m,x,val);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		tree[k].r=<span class="built_in">update</span>(tree[k].r,m+<span class="number">1</span>,end,x,val);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> begin,<span class="type">const</span> <span class="type">int</span> end,<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> m=(begin+end)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(begin==end)</span><br><span class="line">		<span class="keyword">return</span> tree[k].w;</span><br><span class="line">	<span class="keyword">if</span>(x&lt;=m)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">query</span>(tree[k].l,begin,m,x);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">query</span>(tree[k].r,m+<span class="number">1</span>,end,x);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		t[i]=<span class="built_in">read</span>();</span><br><span class="line">	root[<span class="number">0</span>]=<span class="built_in">build_tree</span>(<span class="number">0</span>,<span class="number">1</span>,n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		a=<span class="built_in">read</span>(),</span><br><span class="line">        b=<span class="built_in">read</span>(),</span><br><span class="line">        c=<span class="built_in">read</span>();</span><br><span class="line">		<span class="keyword">if</span>(b==<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;d);</span><br><span class="line">			root[i]=<span class="built_in">update</span>(root[a],<span class="number">1</span>,n,c,d);<span class="comment">//版本a基础上将t_c修改为d</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">query</span>(root[a],<span class="number">1</span>,n,c));</span><br><span class="line">			root[i]=root[a];<span class="comment">//访问版本a中t_c的值，生成一样版本的对象应为a</span></span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="二叉堆"><a href="#二叉堆" class="headerlink" title="二叉堆"></a>二叉堆</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,opr,heap[<span class="number">1000001</span>],heap_size,a;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">put</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> now=heap_size,next;</span><br><span class="line">	heap[++heap_size]=k;</span><br><span class="line">	<span class="keyword">while</span>(now&gt;<span class="number">1</span>)&#123;</span><br><span class="line">		next=now&gt;&gt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(heap[next]&lt;=heap[now])</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		heap[next]^=heap[now]^=heap[next]^=heap[now],</span><br><span class="line">		now=next;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> heap[<span class="number">1</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delet</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> now=<span class="number">1</span>,next;</span><br><span class="line">	heap[<span class="number">1</span>]=heap[heap_size--];</span><br><span class="line">	<span class="keyword">while</span>(now&lt;&lt;<span class="number">1</span>&lt;=heap_size)&#123;</span><br><span class="line">		next=now&lt;&lt;<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(heap[next]&gt;heap[next+<span class="number">1</span>])</span><br><span class="line">			next|=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(heap[next]&gt;=heap[now])</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		heap[next]^=heap[now]^=heap[next]^=heap[now],</span><br><span class="line">		now=next;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="对顶堆"><a href="#对顶堆" class="headerlink" title="对顶堆"></a>对顶堆</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;,less&lt;<span class="type">int</span>&gt; &gt;q1;</span><br><span class="line">priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;,greater&lt;<span class="type">int</span>&gt; &gt;q2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">myabs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x&lt;<span class="number">0</span>?-x:x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">insrt</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((q2.<span class="built_in">size</span>()==<span class="number">0</span>)||(k&gt;q2.<span class="built_in">top</span>()))</span><br><span class="line">        q2.<span class="built_in">push</span>(k);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        q1.<span class="built_in">push</span>(k);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">refrsh</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">myabs</span>(q1.<span class="built_in">size</span>()-q2.<span class="built_in">size</span>())&gt;<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span>(q1.<span class="built_in">size</span>()&gt;q2.<span class="built_in">size</span>())&#123;</span><br><span class="line">            q2.<span class="built_in">push</span>(q1.<span class="built_in">top</span>());</span><br><span class="line">            q1.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            q1.<span class="built_in">push</span>(q2.<span class="built_in">top</span>());</span><br><span class="line">            q2.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getmid</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">refrsh</span>();</span><br><span class="line">    <span class="keyword">if</span>(q2.<span class="built_in">size</span>()&gt;q1.<span class="built_in">size</span>())</span><br><span class="line">        <span class="keyword">return</span> q2.<span class="built_in">top</span>();</span><br><span class="line">    <span class="keyword">return</span> q1.<span class="built_in">top</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(q1.<span class="built_in">empty</span>()==<span class="literal">false</span>)</span><br><span class="line">        q1.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">while</span>(q2.<span class="built_in">empty</span>()==<span class="literal">false</span>)</span><br><span class="line">        q2.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Huffman树"><a href="#Huffman树" class="headerlink" title="Huffman树"></a>Huffman树</h2><p>$$<br>\min\left\lbrace\sum w_il_i\right\rbrace<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> w,h;</span><br><span class="line">	<span class="keyword">friend</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> data a,<span class="type">const</span> data b)&#123;</span><br><span class="line">		<span class="keyword">return</span> (a.w&gt;b.w)||((a.w==b.w)&amp;&amp;(a.h&gt;b.h));</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;rec;</span><br><span class="line">priority_queue&lt;data&gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> data <span class="title">lnk</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">	data tmp;</span><br><span class="line">	tmp.w=a,</span><br><span class="line">	tmp.h=b;</span><br><span class="line">	<span class="keyword">return</span> tmp;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">lnk</span>(<span class="built_in">read</span>(),<span class="number">1</span>));</span><br><span class="line"><span class="keyword">while</span>((q.<span class="built_in">size</span>()<span class="number">-1</span>)%(k<span class="number">-1</span>)!=<span class="number">0</span>)</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">lnk</span>(<span class="number">0</span>,<span class="number">1</span>));</span><br><span class="line"><span class="keyword">while</span>(q.<span class="built_in">size</span>()&gt;=k)&#123;</span><br><span class="line">	maxh=<span class="number">-1</span>,</span><br><span class="line">	sumw=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=k;i++)&#123;</span><br><span class="line">		rec=q.<span class="built_in">top</span>();</span><br><span class="line">		q.<span class="built_in">pop</span>();</span><br><span class="line">		maxh=<span class="built_in">max</span>(maxh,rec.h),</span><br><span class="line">		sumw+=rec.w;</span><br><span class="line">	&#125;;</span><br><span class="line">	ans+=sumw;</span><br><span class="line">	q.<span class="built_in">push</span>(<span class="built_in">lnk</span>(sumw,maxh+<span class="number">1</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n%d\n&quot;</span>,ans,q.<span class="built_in">top</span>().h<span class="number">-1</span>);</span><br></pre></td></tr></table></figure>

<h2 id="树链剖分"><a href="#树链剖分" class="headerlink" title="树链剖分"></a>树链剖分</h2><p>$O(\log n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	size[k]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>(deep[ver[i]]==<span class="number">0</span>)&#123;</span><br><span class="line">			deep[ver[i]]=deep[k]+<span class="number">1</span>,</span><br><span class="line">			fa[ver[i]]=k;</span><br><span class="line">			<span class="comment">//a[ver[i]]=edge[i];（边权转点权）</span></span><br><span class="line">			<span class="built_in">dfs1</span>(ver[i]);</span><br><span class="line">			size[k]+=size[ver[i]];</span><br><span class="line">			<span class="keyword">if</span>(size[ver[i]]&gt;size[son[k]])</span><br><span class="line">				son[k]=ver[i];</span><br><span class="line">		&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> tp)</span></span>&#123;</span><br><span class="line">	id[k]=++nmb,</span><br><span class="line">	top[k]=tp,</span><br><span class="line">	wt[nmb]=a[k];</span><br><span class="line">	<span class="keyword">if</span>(son[k]==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	<span class="built_in">dfs2</span>(son[k],tp);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">		<span class="keyword">if</span>((ver[i]!=fa[k])&amp;&amp;(ver[i]!=son[k]))</span><br><span class="line">			<span class="built_in">dfs2</span>(ver[i],ver[i]);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	tree[k].l=l,</span><br><span class="line">	tree[k].r=r;</span><br><span class="line">	<span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">		tree[k].w=wt[l]%p;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">build</span>(k&lt;&lt;<span class="number">1</span>,l,m);</span><br><span class="line">	<span class="built_in">build</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,m+<span class="number">1</span>,r);</span><br><span class="line">	tree[k].w=(tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w)%p;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>].f+=tree[k].f,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].f+=tree[k].f,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>].w=(tree[k&lt;&lt;<span class="number">1</span>].w+tree[k].f*(tree[k&lt;&lt;<span class="number">1</span>].r-tree[k&lt;&lt;<span class="number">1</span>].l+<span class="number">1</span>))%p,</span><br><span class="line">	tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w=(tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w+tree[k].f*(tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].r-tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].l+<span class="number">1</span>))%p,</span><br><span class="line">	tree[k].f=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask_range</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> m=(tree[k].l+tree[k].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((tree[k].l&gt;=l)&amp;&amp;(tree[k].r&lt;=r))&#123;</span><br><span class="line">		ask_range_res=(ask_range_res+tree[k].w)%p;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].f!=<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">pushdown</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(l&lt;=m)</span><br><span class="line">		<span class="built_in">ask_range</span>(k&lt;&lt;<span class="number">1</span>,l,r);</span><br><span class="line">	<span class="keyword">if</span>(r&gt;m)</span><br><span class="line">		<span class="built_in">ask_range</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_range</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r,<span class="type">const</span> <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> m=(tree[k].l+tree[k].r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((tree[k].l&gt;=l)&amp;&amp;(tree[k].r&lt;=r))&#123;</span><br><span class="line">		tree[k].f+=v,</span><br><span class="line">		tree[k].w=(tree[k].w+v*(tree[k].r-tree[k].l+<span class="number">1</span>))%p;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].f!=<span class="number">0</span>)</span><br><span class="line">		<span class="built_in">pushdown</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(l&lt;=m)</span><br><span class="line">		<span class="built_in">add_range</span>(k&lt;&lt;<span class="number">1</span>,l,r,v);</span><br><span class="line">	<span class="keyword">if</span>(r&gt;m)</span><br><span class="line">		<span class="built_in">add_range</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,l,r,v);</span><br><span class="line">	tree[k].w=(tree[k&lt;&lt;<span class="number">1</span>].w+tree[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].w)%p;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">update_path</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> v)</span></span>&#123;<span class="comment">//将树从x到y结点最短路径上所有节点的值都加上z</span></span><br><span class="line">	v%=p;</span><br><span class="line">	<span class="keyword">while</span>(top[l]!=top[r])&#123;</span><br><span class="line">		<span class="keyword">if</span>(deep[top[l]]&lt;deep[top[r]])</span><br><span class="line">			l^=r^=l^=r;</span><br><span class="line">		<span class="built_in">add_range</span>(<span class="number">1</span>,id[top[l]],id[l],v);</span><br><span class="line">		l=fa[top[l]];</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(deep[l]&gt;deep[r])</span><br><span class="line">		l^=r^=l^=r;</span><br><span class="line">	<span class="built_in">add_range</span>(<span class="number">1</span>,id[l]<span class="comment">/*+1*/</span>,id[r],v);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query_path</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;<span class="comment">//求树从x到y结点最短路径上所有节点的值之和</span></span><br><span class="line">	<span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(top[l]!=top[r])&#123;</span><br><span class="line">		<span class="keyword">if</span>(deep[top[l]]&lt;deep[top[r]])</span><br><span class="line">			l^=r^=l^=r;</span><br><span class="line">		ask_range_res=<span class="number">0</span>;</span><br><span class="line">		<span class="built_in">ask_range</span>(<span class="number">1</span>,id[top[l]],id[l]);</span><br><span class="line">		ans=(ans+ask_range_res)%p,</span><br><span class="line">		l=fa[top[l]];</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(deep[l]&gt;deep[r])</span><br><span class="line">		l^=r^=l^=r;</span><br><span class="line">	ask_range_res=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">ask_range</span>(<span class="number">1</span>,id[l]<span class="comment">/*+1*/</span>,id[r]);</span><br><span class="line">	ans=(ans+ask_range_res)%p;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">update_subtree</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> v)</span></span>&#123;<span class="comment">//将以x为根节点的子树内所有节点值都加上z</span></span><br><span class="line">	<span class="built_in">add_range</span>(<span class="number">1</span>,id[k],id[k]+size[k]<span class="number">-1</span>,v);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">query_subtree</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;<span class="comment">//求以x为根节点的子树内所有节点值之和</span></span><br><span class="line">	ask_range_res=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">ask_range</span>(<span class="number">1</span>,id[k],id[k]+size[k]<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> ask_range_res;</span><br><span class="line">&#125;;</span><br><span class="line">deep[r]=fa[r]=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(r);</span><br><span class="line"><span class="built_in">dfs2</span>(r,r);</span><br><span class="line"><span class="built_in">build</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br></pre></td></tr></table></figure>

<h3 id="LCA-1"><a href="#LCA-1" class="headerlink" title="LCA"></a>LCA</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    size[k]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">        <span class="keyword">if</span>(deep[ver[i]]==<span class="number">0</span>)&#123;</span><br><span class="line">            fa[ver[i]]=k,</span><br><span class="line">            deep[ver[i]]=deep[k]+<span class="number">1</span>;</span><br><span class="line">            <span class="built_in">dfs1</span>(ver[i]);</span><br><span class="line">            size[k]+=size[ver[i]];</span><br><span class="line">            <span class="keyword">if</span>(size[son[k]]&lt;size[ver[i]])</span><br><span class="line">                son[k]=ver[i];</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> last)</span></span>&#123;</span><br><span class="line">    top[k]=last;</span><br><span class="line">    <span class="keyword">if</span>(son[k]==<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">    <span class="built_in">dfs2</span>(son[k],last);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=head[k];i!=<span class="number">0</span>;i=next[i])</span><br><span class="line">        <span class="keyword">if</span>((ver[i]!=son[k])&amp;&amp;(ver[i]!=fa[k]))</span><br><span class="line">            <span class="built_in">dfs2</span>(ver[i],ver[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lca</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(top[l]!=top[r])&#123;</span><br><span class="line">        <span class="keyword">if</span>(deep[top[l]]&lt;deep[top[r]])</span><br><span class="line">            l^=r^=l^=r;</span><br><span class="line">        l=fa[top[l]];</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span>(deep[l]&gt;deep[r])</span><br><span class="line">        l^=r^=l^=r;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;;</span><br><span class="line">deep[r]=fa[r]=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">dfs1</span>(r);</span><br><span class="line"><span class="built_in">dfs2</span>(r,r);</span><br></pre></td></tr></table></figure>

<h2 id="单调栈"><a href="#单调栈" class="headerlink" title="单调栈"></a>单调栈</h2><h3 id="最大子矩阵"><a href="#最大子矩阵" class="headerlink" title="最大子矩阵"></a>最大子矩阵</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a[n+<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;a[i++]=<span class="built_in">read</span>());</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n+<span class="number">1</span>;i++)</span><br><span class="line">	<span class="keyword">if</span>(a[i]&lt;s[top])&#123;</span><br><span class="line">		width=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(a[i]&lt;s[top])</span><br><span class="line">			width+=w[top],</span><br><span class="line">			ans=<span class="built_in">max</span>(ans,s[top]*width),</span><br><span class="line">			top--;</span><br><span class="line">		s[++top]=a[i],</span><br><span class="line">		w[top]=width+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		s[++top]=a[i],</span><br><span class="line">		w[top]=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br></pre></td></tr></table></figure>

<h2 id="单调队列"><a href="#单调队列" class="headerlink" title="单调队列"></a>单调队列</h2><h3 id="滑动窗口-区间最小"><a href="#滑动窗口-区间最小" class="headerlink" title="滑动窗口-区间最小"></a>滑动窗口-区间最小</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> val,pos;</span><br><span class="line">&#125;a[<span class="number">2000001</span>];</span><br><span class="line">deque&lt;data&gt;q;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	a[i].val=<span class="built_in">read</span>(),</span><br><span class="line">	a[i].pos=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="keyword">while</span>((q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&amp;&amp;(q.<span class="built_in">back</span>().val&gt;=a[i].val))</span><br><span class="line">		q.<span class="built_in">pop_back</span>();</span><br><span class="line">	q.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">	<span class="keyword">while</span>((q.<span class="built_in">empty</span>()==<span class="literal">false</span>)&amp;&amp;(q.<span class="built_in">front</span>().pos&lt;=i-m))</span><br><span class="line">		q.<span class="built_in">pop_front</span>();</span><br><span class="line">	ans[i]=q.<span class="built_in">front</span>().val;</span><br><span class="line">&#125;;</span><br><span class="line">for_each(ans,ans+n,f);</span><br></pre></td></tr></table></figure>

<h3 id="最大子序和"><a href="#最大子序和" class="headerlink" title="最大子序和"></a>最大子序和</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	sum[i]=sum[i<span class="number">-1</span>]+a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="keyword">if</span>(i&gt;=s)&#123;</span><br><span class="line">		<span class="keyword">while</span>((que.<span class="built_in">empty</span>()==<span class="literal">false</span>)&amp;&amp;(sum[i-s]&lt;sum[que.<span class="built_in">back</span>()]))</span><br><span class="line">			que.<span class="built_in">pop_back</span>();</span><br><span class="line">		que.<span class="built_in">push_back</span>(i-s);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>((que.<span class="built_in">empty</span>()==<span class="literal">false</span>)&amp;&amp;(que.<span class="built_in">front</span>()&lt;i-t))</span><br><span class="line">		que.<span class="built_in">pop_front</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="笛卡尔树"><a href="#笛卡尔树" class="headerlink" title="笛卡尔树"></a>笛卡尔树</h2><p>$O(n)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	tmp=top;</span><br><span class="line">	<span class="keyword">while</span>((tmp&gt;<span class="number">0</span>)&amp;&amp;(a[stk[tmp]]&gt;a[i]))</span><br><span class="line">		tmp--;</span><br><span class="line">	<span class="keyword">if</span>(tmp&gt;<span class="number">0</span>)</span><br><span class="line">		rson[stk[tmp]]=i;</span><br><span class="line">	<span class="keyword">if</span>(tmp&lt;top)</span><br><span class="line">		lson[i]=stk[tmp+<span class="number">1</span>];</span><br><span class="line">	stk[++tmp]=i,</span><br><span class="line">	top=tmp;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="替罪羊树"><a href="#替罪羊树" class="headerlink" title="替罪羊树"></a>替罪羊树</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> alpha=<span class="number">0.75</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> l,r,val,size,sh,wn;<span class="comment">//左右子树节点、该节点值、子树不同节点数、子树剩余节点数、该节点值相同个数</span></span><br><span class="line">&#125;tree[];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unfold</span><span class="params">(<span class="type">const</span> <span class="type">int</span>&amp; k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	<span class="built_in">unfold</span>(tree[k].l);</span><br><span class="line">	<span class="keyword">if</span>(tree[k].wn&gt;<span class="number">0</span>)</span><br><span class="line">		rt[++crt]=k;</span><br><span class="line">	<span class="built_in">unfold</span>(tree[k].r);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">updat</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	tree[k].size=tree[tree[k].l].size+tree[tree[k].r].size+tree[k].wn,</span><br><span class="line">	tree[k].sh=tree[tree[k].l].sh+tree[tree[k].r].sh+tree[k].wn;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rebuild</span><span class="params">(<span class="type">const</span> <span class="type">int</span> l,<span class="type">const</span> <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(l==r)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	tree[rt[mid]].l=<span class="built_in">rebuild</span>(l,mid),</span><br><span class="line">	tree[rt[mid]].r=<span class="built_in">rebuild</span>(mid+<span class="number">1</span>,r);</span><br><span class="line">	<span class="built_in">updat</span>(rt[mid]);</span><br><span class="line">	<span class="keyword">return</span> rt[mid];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">jdg</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].wn==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span>((<span class="type">double</span>)tree[k].size*<span class="built_in">alpha</span>&lt;(<span class="type">double</span>)<span class="built_in">max</span>(tree[tree[k].l].size,tree[tree[k].r].size))</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">if</span>((<span class="type">double</span>)tree[k].size*alpha&gt;(<span class="type">double</span>)tree[k].sh)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">balnc</span><span class="params">(<span class="type">int</span>&amp; k)</span></span>&#123;</span><br><span class="line">	crt=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">unfold</span>(k);</span><br><span class="line">	k=<span class="built_in">rebuild</span>(<span class="number">1</span>,crt+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addnw</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	tree[k].val=val,</span><br><span class="line">	tree[k].sh=tree[k].size=tree[k].wn=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insrt</span><span class="params">(<span class="type">int</span>&amp; k,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k==<span class="number">0</span>)&#123;</span><br><span class="line">		k=++cnt;</span><br><span class="line">		<span class="keyword">if</span>(root==<span class="number">0</span>)</span><br><span class="line">			root=<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">addnw</span>(k,val);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].val==val)</span><br><span class="line">		tree[k].wn++;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">if</span>(val&lt;tree[k].val)</span><br><span class="line">			<span class="built_in">insrt</span>(tree[k].l,val);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">insrt</span>(tree[k].r,val);</span><br><span class="line">	<span class="built_in">updat</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">jdg</span>(k)==<span class="literal">true</span>)</span><br><span class="line">		<span class="built_in">balnc</span>(k);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;<span class="comment">//插入节点val</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delt</span><span class="params">(<span class="type">int</span>&amp; k,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	tree[k].sh--;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].val==val)</span><br><span class="line">		tree[k].wn--;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">if</span>(val&lt;tree[k].val)</span><br><span class="line">			<span class="built_in">delt</span>(tree[k].l,val);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="built_in">delt</span>(tree[k].r,val);</span><br><span class="line">	<span class="built_in">updat</span>(k);</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">jdg</span>(k)==<span class="literal">true</span>)</span><br><span class="line">		<span class="built_in">balnc</span>(k);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;<span class="comment">//删除节点val</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rkat</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].l==tree[k].r)</span><br><span class="line">		<span class="keyword">return</span> tree[k].val;</span><br><span class="line">	<span class="keyword">if</span>(val&lt;=tree[tree[k].l].sh)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">rkat</span>(tree[k].l,val);</span><br><span class="line">	<span class="keyword">if</span>(val&lt;=tree[tree[k].l].sh+tree[k].wn)</span><br><span class="line">		<span class="keyword">return</span> tree[k].val;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">rkat</span>(tree[k].r,val-tree[tree[k].l].sh-tree[k].wn);</span><br><span class="line">&#125;;<span class="comment">//查询第val大</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rkdown</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>((tree[k].wn&gt;<span class="number">0</span>)&amp;&amp;(tree[k].val==val))</span><br><span class="line">		<span class="keyword">return</span> tree[tree[k].l].sh;</span><br><span class="line">	<span class="keyword">if</span>(val&lt;tree[k].val)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">rkdown</span>(tree[k].l,val);</span><br><span class="line">	<span class="keyword">return</span> tree[tree[k].l].sh+tree[k].wn+<span class="built_in">rkdown</span>(tree[k].r,val);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rkup</span><span class="params">(<span class="type">const</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>((tree[k].wn&gt;<span class="number">0</span>)&amp;&amp;(tree[k].val==val))</span><br><span class="line">		<span class="keyword">return</span> tree[tree[k].l].sh+tree[k].wn+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(val&lt;tree[k].val)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">rkup</span>(tree[k].l,val);</span><br><span class="line">	<span class="keyword">return</span> tree[tree[k].l].sh+tree[k].wn+<span class="built_in">rkup</span>(tree[k].r,val);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getrk</span><span class="params">(<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">rkdown</span>(root,val)+<span class="number">1</span>;</span><br><span class="line">&#125;;<span class="comment">//查询val的排名</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">prev</span><span class="params">(<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">rkat</span>(root,<span class="built_in">rkdown</span>(root,val));</span><br><span class="line">&#125;;<span class="comment">//询问val的前驱</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">nxt</span><span class="params">(<span class="type">const</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">rkat</span>(root,<span class="built_in">rkup</span>(root,val));</span><br><span class="line">&#125;;<span class="comment">//询问val的后继</span></span><br></pre></td></tr></table></figure>

<h3 id="可重"><a href="#可重" class="headerlink" title="可重"></a>可重</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">rkdown</span><span class="params">(<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].val==val)</span><br><span class="line">		<span class="keyword">if</span>(tree[k].wn==<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">return</span> tree[tree[k].l].sh;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">if</span>(tree[k].wn&gt;<span class="number">1</span>)</span><br><span class="line">				<span class="keyword">return</span> tree[tree[k].l].sh+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(val&lt;tree[k].val)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">rkdown</span>(tree[k].l,val);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">rkdown</span>(tree[k].r,val)+tree[tree[k].l].sh+tree[k].wn;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">rkup</span><span class="params">(<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> k,<span class="type">const</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> val)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(tree[k].val==val)</span><br><span class="line">		<span class="keyword">if</span>(tree[k].wn==<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">return</span> tree[tree[k].l].sh+<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">if</span>(tree[k].wn&gt;<span class="number">1</span>)</span><br><span class="line">				<span class="keyword">return</span> tree[tree[k].l].sh+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(val&lt;tree[k].val)</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">rkup</span>(tree[k].l,val);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">rkup</span>(tree[k].r,val)+tree[k].wn+tree[tree[k].l].sh;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">insrt</span>(root,INF);</span><br><span class="line"><span class="built_in">insrt</span>(root,-INF);</span><br></pre></td></tr></table></figure>

<h2 id="pb-ds-tree-平衡树"><a href="#pb-ds-tree-平衡树" class="headerlink" title="pb_ds tree 平衡树"></a>pb_ds tree 平衡树</h2><p>由于会出现重复元素，需要记录序数加以区分。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/tree_policy.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line">tree&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,null_type,less&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &gt;,rb_tree_tag,tree_order_statistics_node_update&gt;t;</span><br><span class="line"></span><br><span class="line">t.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(x,i));<span class="comment">//插入x</span></span><br><span class="line">t.<span class="built_in">erase</span>(t.<span class="built_in">lower_bound</span>(<span class="built_in">make_pair</span>(x,<span class="number">0</span>)));<span class="comment">//删除x</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,t.<span class="built_in">order_of_key</span>(<span class="built_in">make_pair</span>(x,<span class="number">0</span>))+<span class="number">1</span>);<span class="comment">//查询x的排名</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,*t.<span class="built_in">find_by_order</span>(x<span class="number">-1</span>));<span class="comment">//查询排名为x的数</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(*--t.<span class="built_in">lower_bound</span>(<span class="built_in">make_pair</span>(x,<span class="number">0</span>))).first);<span class="comment">//求x的前驱</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(*t.<span class="built_in">upper_bound</span>(<span class="built_in">make_pair</span>(x,<span class="number">0x3f3f3f3f3f3f3f3f</span>))).first);<span class="comment">//求x的后继 </span></span><br></pre></td></tr></table></figure>

<h2 id="Trie"><a href="#Trie" class="headerlink" title="Trie"></a>Trie</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tot=<span class="number">1</span>,trie[N+<span class="number">1</span>][<span class="number">26</span>];</span><br><span class="line"><span class="type">bool</span> end[N+<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=<span class="built_in">strlen</span>(str),p=<span class="number">1</span>,ch=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;str;i++)&#123;</span><br><span class="line">		ch=str[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(trie[p][ch]==<span class="number">0</span>)</span><br><span class="line">			trie[p][ch]=++tot;</span><br><span class="line">		p=trie[p][ch];</span><br><span class="line">	&#125;;</span><br><span class="line">	end[p]=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">search</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> len=<span class="built_in">strlen</span>(str),p=<span class="number">1</span>,ch=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">		ch=str[i]-<span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">		p=trie[p][ch];</span><br><span class="line">		<span class="keyword">if</span>(p==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> end[p];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Ԗ-Hash"><a href="#Ԗ-Hash" class="headerlink" title="Ԗ-Hash"></a>Ԗ-Hash</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">string s;</span><br><span class="line"><span class="type">int</span> len;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> hash[N+<span class="number">1</span>];</span><br><span class="line"><span class="built_in">getline</span>(cin,s);</span><br><span class="line">len=s.<span class="built_in">length</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=len;i++)</span><br><span class="line">	hash[i]=(hash[i<span class="number">-1</span>]*<span class="number">131</span>+s[i])%<span class="number">1000000000007</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,hash[len]);</span><br></pre></td></tr></table></figure>

<h2 id="KMP模式匹配"><a href="#KMP模式匹配" class="headerlink" title="KMP模式匹配"></a>KMP模式匹配</h2><p>$O(n+m)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="built_in">strlen</span>(a),<span class="comment">//模式串</span></span><br><span class="line">m=<span class="built_in">strlen</span>(b);<span class="comment">//文本串</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">	a[i]=a[i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=m;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">	b[i]=b[i<span class="number">-1</span>];</span><br><span class="line">a[<span class="number">0</span>]=b[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">2</span>,j=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">	<span class="keyword">while</span>((j&gt;<span class="number">0</span>)&amp;&amp;(a[i]!=a[j+<span class="number">1</span>]))</span><br><span class="line">		j=next[j];</span><br><span class="line">	<span class="keyword">if</span>(a[i]==a[j+<span class="number">1</span>])</span><br><span class="line">		j++;</span><br><span class="line">	next[i]=j;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>;i&lt;=m;i++)&#123;</span><br><span class="line">	<span class="keyword">while</span>((j&gt;<span class="number">0</span>)&amp;&amp;((j==n)||(b[i]!=a[j+<span class="number">1</span>])))</span><br><span class="line">		j=next[j];</span><br><span class="line">	<span class="keyword">if</span>(b[i]==a[j+<span class="number">1</span>])</span><br><span class="line">		j++;</span><br><span class="line">	f[i]=j;</span><br><span class="line">	<span class="keyword">if</span>(f[i]==n)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,i-n+<span class="number">1</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="最小表示法"><a href="#最小表示法" class="headerlink" title="最小表示法"></a>最小表示法</h2><p>当字符串$S$中可以选定一个位置$i$满足$S_{i\cdots n}+S_{1\cdots i-1}&#x3D;T$则称$S$与$T$<strong>循环同构</strong> 。<br>字符串$S$的<strong>最小表示</strong> 为与$S$循环同构的所有字符串中字典序最小的字符串。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[<span class="number">2</span>N];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> t=<span class="number">1</span>;t&lt;=n;t++)</span><br><span class="line">	a[t]=a[n+t]=<span class="built_in">read</span>();</span><br><span class="line"><span class="keyword">while</span>((i&lt;=n)&amp;&amp;(j&lt;=n))&#123;</span><br><span class="line">	k=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>((k&lt;n)&amp;&amp;(a[i+k]==a[j+k]))</span><br><span class="line">		k++;</span><br><span class="line">	<span class="keyword">if</span>(k==n)</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">if</span>(a[i+k]&gt;a[j+k])&#123;</span><br><span class="line">		i+=k+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(i==j)</span><br><span class="line">			i++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		j+=k+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(i==j)</span><br><span class="line">			j++;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line">for_each(a+<span class="built_in">min</span>(i,j),a+n+<span class="number">1</span>,f);</span><br><span class="line">for_each(a+<span class="number">1</span>,a+<span class="built_in">min</span>(i,j),f);</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="线性DP"><a href="#线性DP" class="headerlink" title="线性DP"></a>线性DP</h2><h3 id="LIS"><a href="#LIS" class="headerlink" title="LIS"></a>LIS</h3><p>最长上升子序列。给定一个长度为$N$的数列$A$，求数值单调递增的子序列的长度最长是多少。$A$的任意子序列$B$可表示为$B&#x3D;{A_{k_1},A_{k_2},\cdots,A_{k_p}}$，其中$k_1&lt;k_2&lt;\cdots &lt;k_p$。  </p>
<p>$F_i$表示以$A_i$为结尾的“最长上升子序列”的长度。<br>$$<br>\displaylines{<br>    F_i&#x3D;\max_{0\leq j&lt;i,A_j&lt;A_i}NaN\\<br>    F_0&#x3D;0\\<br>    \max_{1\leq i\leq N}<br>}<br>$$</p>
<h3 id="LCS"><a href="#LCS" class="headerlink" title="LCS"></a>LCS</h3><p>最长公共子序列。给定两个长度分别为$N$和$M$的字符串$A$和$B$，求既是$A$的子序列又是$B$的子序列的字符串长度最长是多少。  </p>
<p>$F_{i,j}$表示前缀子串$A_{1\sim i}$与$B_{1\sim j}$的“最长公共子序列”的长度。<br>$$<br>\displaylines{<br>    F_{i,j}&#x3D;\max<br>        \begin{cases}<br>            F_{i-1,j}\\<br>            F_{i,j-1}\\<br>            F_{i-1,j-1}+1 &amp; :A_i&#x3D;B_j<br>        \end{cases}\\<br>    F_{i,0}&#x3D;F_{0,j}&#x3D;0\\<br>    F_{N,M}<br>}<br>$$</p>
<h3 id="数字三角形"><a href="#数字三角形" class="headerlink" title="数字三角形"></a>数字三角形</h3><p>给定一个共有$N$行的三角矩阵$A$，其中第$i$行有$i$列。从左上角出发，每次可以向下方或右下方走一步，最终到达底部。求把经过的所有位置上的数加起来，和最大是多少。  </p>
<p>$F_{i,j}$表示从左上角走到第$i$行第$j$列，和最大是多少<br>$$<br>\displaylines{<br>    F_{i,j}&#x3D;A_{i,j}+\max<br>        \begin{cases}<br>            F_{i-1,j}\\<br>            F_{i-1,j-1} &amp; :j&gt;1<br>        \end{cases}\\<br>    F_{1,1}&#x3D;A_{1,1}\\<br>    \max_{1\leq j\leq N}{F_{N,j}}<br>}<br>$$</p>
<h2 id="背包"><a href="#背包" class="headerlink" title="背包"></a>背包</h2><h3 id="0-1背包"><a href="#0-1背包" class="headerlink" title="0&#x2F;1背包"></a>0&#x2F;1背包</h3><p>给定$N$个物品，其中第$i$个物品的体积为$V_i$，价值为$W_i$。有一容积为$M$的背包，要求选择一些物品放入背包，使得物品总体积不超过$M$的前提下，物品的价值总和最大。  </p>
<p>$F_{i,j}$表示从前$i$个物品 中选出了总体积为$j$的物品放入背包，物品的最大价值和。<br>$$<br>\displaylines{<br>    \begin{aligned}<br>        F_{i,j}&#x3D;&amp;\max<br>            \begin{cases}<br>                F_{i-1,j}\\<br>                F_{i-1,j-V_i}+W_i &amp; :j\geq V_i<br>            \end{cases}\\<br>        F_{i,j}&#x3D;&amp;-\infty,F_{0,0}&#x3D;0\\<br>        &amp;\max_{0\leq j\leq M}{F_{N,j}}<br>    \end{aligned}<br>}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xc0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;=m;j++)</span><br><span class="line">        f[i][j]-f[i<span class="number">-1</span>][j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=v[i];j&lt;=m;j++)</span><br><span class="line">        f[i][j]=<span class="built_in">max</span>(f[i][j],f[i<span class="number">-1</span>][j-v[i]]+w[i]);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="滚动数组"><a href="#滚动数组" class="headerlink" title="滚动数组"></a>滚动数组</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xc0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;=m;j++)</span><br><span class="line">        f[i&amp;<span class="number">1</span>][j]=f[(i<span class="number">-1</span>)&amp;<span class="number">1</span>][j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=v[i];j&lt;=m;j++)</span><br><span class="line">        f[i&amp;<span class="number">1</span>][j]=<span class="built_in">max</span>(f[i&amp;<span class="number">1</span>][j],f[(i<span class="number">-1</span>)&amp;<span class="number">1</span>][j-v[i]]+w[i]);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;=m;j++)</span><br><span class="line">    ans=<span class="built_in">max</span>(ans,f[n&amp;<span class="number">1</span>][j]);</span><br></pre></td></tr></table></figure>

<h4 id="一维"><a href="#一维" class="headerlink" title="一维"></a>一维</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xc0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=m;j&gt;=v[i];j--)</span><br><span class="line">        f[j]=<span class="built_in">max</span>(f[j],f[j-v[i]]+w[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;=m;j++)</span><br><span class="line">    ans=<span class="built_in">max</span>(ans,f[j]);</span><br></pre></td></tr></table></figure>

<h3 id="完全背包"><a href="#完全背包" class="headerlink" title="完全背包"></a>完全背包</h3><p>给定$N$种物品，其中第$i$种物品的体积为$V_i$，价值为$W_i$，并且有无数个。有一容积为$M$的背包，要求选择若干个物品放入背包，使得物品总体积不超过$M$的前提下，物品的价值总和最大。  </p>
<p>$F_{i,j}$表示从前$i$种物品中选出了总体积为$j$的物品放入背包，物品的最大价值和。<br>$$<br>\displaylines{<br>    \begin{aligned}<br>        F_{i,j}&#x3D;&amp;\max<br>            \begin{cases}<br>                F_{i-1,j}\\<br>                F_{i,j-V_i}+W_i&amp;:j\geq V_i<br>            \end{cases}\\<br>        F_{i,j}&#x3D;&amp;-\infty,F_{0,0}&#x3D;0\\<br>        &amp;\max_{0\leq j\leq M}{F_{N,j}}<br>    \end{aligned}<br>}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xc0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=v[i];j&lt;=m;j++)</span><br><span class="line">        f[j]=<span class="built_in">max</span>(f[j],f[j-v[i]]+w[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;=m;j++)</span><br><span class="line">    ans=<span class="built_in">max</span>(ans,f[j]);</span><br></pre></td></tr></table></figure>

<h3 id="多重背包"><a href="#多重背包" class="headerlink" title="多重背包"></a>多重背包</h3><p>给定$N$种物品，其中第$i$种物品的体积为$V_i$，价值为$W_i$，并且有$C_i$个。有一容积为$M$的背包，要求选择若干个物品放入背包，使得物品总体积不超过$M$的前提下，物品的价值总和最大。  </p>
<h4 id="直接拆分法"><a href="#直接拆分法" class="headerlink" title="直接拆分法"></a>直接拆分法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xc0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=c[i];j++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=m;k&gt;=v[i];k--)</span><br><span class="line">            f[k]=<span class="built_in">max</span>(f[k],f[k-v[i]]+w[i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;=m;i++)</span><br><span class="line">    ans=<span class="built_in">max</span>(ans,f[i]);</span><br></pre></td></tr></table></figure>

<h4 id="二进制拆分法"><a href="#二进制拆分法" class="headerlink" title="二进制拆分法"></a>二进制拆分法</h4><p>求出满足$\displaystyle\sum_{i&#x3D;1}^p2^i\leq C_i$的最大$p\in\mathbb Z$，设$\displaystyle R_i&#x3D;C_i-\sum_{i&#x3D;0}^p2^i$。  </p>
<p>把数量为$C_i$的第$i$种物品拆成$p+2$个物品，体积分别为：$2^0V_i, \ 2^1V_i,\cdots, \ 2^pV_i,R_iV_i$。  </p>
<p>这$p+2$个物品可以凑成$\forall k, \ k\in[0,C_iV_i], \ k\mid V_i$，并且不能凑成$\forall k, \ k&gt;C_iV_i$。这等价于原问题中体积为$V_i$的物品可以使用$[0,C_i]$次。 </p>
<h3 id="分组背包"><a href="#分组背包" class="headerlink" title="分组背包"></a>分组背包</h3><p>给定$N$组物品，其中第$i$组有$C_i$个物品。第$i$组的第$j$个物品的体积为$V_{i,j}$，价值为$W_{i,j}$。有一容积为$M$的背包，要求选择若干个物品放入背包，使得每组至多选择一个物品并且物品总体积不超过$M$的前提下，物品的价值总和最大。  </p>
<p>$F_{i,j}$表示从前$i$组中选出总体积为$j$的物品放入背包，物品的最大价值和。<br>$$<br>F_{i,j}&#x3D;\max<br>    \begin{cases}<br>        \displaylines{<br>            F_{i-1,j}\\<br>            \displaystyle\max_{1\leq k\leq C_i}{F_{i-1,j-V_{i,k}}+W_{i,k}}<br>        }<br>    \end{cases}\<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0xc0</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=m;j&gt;=<span class="number">0</span>;j--)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">1</span>;k&lt;=c[i];k++)</span><br><span class="line">            <span class="keyword">if</span>(j&gt;=v[i][k])</span><br><span class="line">                f[j]=<span class="built_in">max</span>(f[j],f[j-v[i][k]]+w[i][k]);</span><br></pre></td></tr></table></figure>

<h3 id="二维费用背包"><a href="#二维费用背包" class="headerlink" title="二维费用背包"></a>二维费用背包</h3><p>背包中的每种物品有两种费用。  </p>
<p>$F_{i,v,u}$表示前$i$件物品付出两种代价分别为$v$和$u$时可获得的最大价值。<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        F_{i,v,u}&#x3D;&amp;\max<br>            \begin{cases}<br>                F_{i-1,v,u}\\<br>                F_{i-1,v-A_i,u-B_i}+W_i<br>            \end{cases}\\<br>        F_{i,v,u}&#x3D;&amp;-\infty \ F_{i,v,0}&#x3D;0\\<br>        &amp;F_{V,U}<br>    }<br>\end{aligned}<br>$$</p>
<h2 id="二维偏序"><a href="#二维偏序" class="headerlink" title="二维偏序"></a>二维偏序</h2><p>$$<br>(a_j,b_j)\prec(a_i,b_i)\xlongequal{def}a_j\lesseqgtr a_i, \ b_j\lesseqgtr b_i<br>$$</p>
<h2 id="GarsiaWachs"><a href="#GarsiaWachs" class="headerlink" title="GarsiaWachs"></a>GarsiaWachs</h2><p>设序列$A_{0\cdots n-1}$，每次寻找最小满足$A_{k-1}\leq A_{k+1}$的$k$，把$A_k$与$A_{k-1}$合并，从$k$向前寻找第一个满足$A_j&gt;A_k+A_{k-1}$的$j$，把合并后的值$A_k+A_{k-1}$插入$A_j$的后面。  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> k=a.<span class="built_in">size</span>()<span class="number">-2</span>,tmp=<span class="number">0</span>,pos=<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;a.<span class="built_in">size</span>()<span class="number">-2</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(a[i]&lt;=a[i+<span class="number">2</span>])&#123;</span><br><span class="line">			k=i;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">	tmp=a[k]+a[k+<span class="number">1</span>];</span><br><span class="line">	a.<span class="built_in">erase</span>(a.<span class="built_in">begin</span>()+k);</span><br><span class="line">	a.<span class="built_in">erase</span>(a.<span class="built_in">begin</span>()+k);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=k<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="keyword">if</span>(a[i]&gt;tmp)&#123;</span><br><span class="line">			pos=i;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">	a.<span class="built_in">insert</span>(a.<span class="built_in">begin</span>()+pos+<span class="number">1</span>,tmp);</span><br><span class="line">	<span class="keyword">return</span> tmp;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	a.<span class="built_in">push_back</span>(<span class="built_in">read</span>());</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)</span><br><span class="line">	ans+=<span class="built_in">merge</span>();</span><br></pre></td></tr></table></figure>

<h2 id="悬线法"><a href="#悬线法" class="headerlink" title="悬线法"></a>悬线法</h2><h3 id="最大子矩阵-1"><a href="#最大子矩阵-1" class="headerlink" title="最大子矩阵"></a>最大子矩阵</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)&#123;</span><br><span class="line">		cin&gt;&gt;tmp;</span><br><span class="line">        <span class="keyword">switch</span>(tmp.<span class="built_in">at</span>(<span class="number">0</span>))&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;R&#x27;</span>:</span><br><span class="line">                mp[i][j]=<span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;F&#x27;</span>:</span><br><span class="line">                mp[i][j]=<span class="literal">true</span>,</span><br><span class="line">				top[i][j]=<span class="number">1</span>,<span class="comment">//向上到达最远的点的距离</span></span><br><span class="line">        		l[i][j]=r[i][j]=j;<span class="comment">//(i,j)左，右能到达的最远的点的纵坐标</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">2</span>;j&lt;=m;j++)</span><br><span class="line">        <span class="keyword">if</span>((mp[i][j]==<span class="literal">true</span>)&amp;&amp;(mp[i][j<span class="number">-1</span>]==<span class="literal">true</span>))</span><br><span class="line">            l[i][j]=l[i][j<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=m<span class="number">-1</span>;j&gt;<span class="number">0</span>;j--)</span><br><span class="line">        <span class="keyword">if</span>((mp[i][j]==<span class="literal">true</span>)&amp;&amp;(mp[i][j+<span class="number">1</span>]==<span class="literal">true</span>))</span><br><span class="line">            r[i][j]=r[i][j+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)&#123;</span><br><span class="line">        <span class="keyword">if</span>((i&gt;<span class="number">1</span>)&amp;&amp;(mp[i][j]==<span class="literal">true</span>)&amp;&amp;(mp[i<span class="number">-1</span>][j]==<span class="literal">true</span>))</span><br><span class="line">            l[i][j]=<span class="built_in">max</span>(l[i][j],l[i<span class="number">-1</span>][j]),</span><br><span class="line">            r[i][j]=<span class="built_in">min</span>(r[i][j],r[i<span class="number">-1</span>][j]),</span><br><span class="line">            top[i][j]=top[i<span class="number">-1</span>][j]+<span class="number">1</span>;</span><br><span class="line">		ans=<span class="built_in">max</span>(ans,(r[i][j]-l[i][j]+<span class="number">1</span>)*top[i][j]);</span><br><span class="line">	&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="状态压缩DP"><a href="#状态压缩DP" class="headerlink" title="状态压缩DP"></a>状态压缩DP</h2><h3 id="TSP"><a href="#TSP" class="headerlink" title="TSP"></a>TSP</h3><p>从$1$出发，求经过所有点返回$1$所走的最短路程。</p>
<p>$f_{i,j}$表示点被经过的状态对应的二进制数为$i$，且目前处于点$j$时的最短路径。<br>$$<br>f_{i,j}&#x3D;\min{f_{i\oplus 2^j,k}+w_{i,j}}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">f[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)</span><br><span class="line">		mp[i][j]=<span class="built_in">read</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">1</span>;i&lt;=((<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>);i+=<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)</span><br><span class="line">		<span class="keyword">if</span>(((i&gt;&gt;j)&amp;<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> k=<span class="number">0</span>;k&lt;n;k++)</span><br><span class="line">				<span class="keyword">if</span>((((i&gt;&gt;k)&amp;<span class="number">1</span>)==<span class="number">1</span>)&amp;&amp;(k!=j))</span><br><span class="line">					f[i][j]=<span class="built_in">min</span>(f[i][j],f[i^(<span class="number">1</span>&lt;&lt;j)][k]+mp[k][j]);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">register</span> <span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">	ans=<span class="built_in">min</span>(ans,f[(<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>][i]+mp[i][<span class="number">0</span>]);</span><br></pre></td></tr></table></figure>

<h2 id="摊还分析"><a href="#摊还分析" class="headerlink" title="摊还分析"></a>摊还分析</h2><p>摊还分析用来评价某个数据结构的一系列操作的平均代价，有时可能某个操作的代价特别高，但总体上来看也并非那么糟糕，可以形象的理解为把高代价的操作“分摊”到其他操作上去了，要求的就是均摊后的平均代价。  </p>
<p>摊还分析有三种常用的技术：<strong>聚合分析，核算法，势能法</strong>。  </p>
<p><strong>例1：栈操作：</strong><br>考虑一个空栈$S$，有三种操作：<br>1、<strong>PUSH(S,x)</strong> ：将对象$x$压入栈$S$中。<br>2、<strong>POP(S)</strong> ：将栈$S$的栈顶对象弹出，并返回该对象。对空栈调用<strong>POP</strong> 会产生一个错误。<br>3、<strong>MULTIPOP(S,k)</strong> ：循环调用<strong>POP(S)</strong> ，弹出栈顶的$k$个元素（$k&lt;n$，$n$为栈的最大容量）。  </p>
<p>其中，第三种操作的伪代码如下：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MULTIPOP(S,k)</span><br><span class="line">    while not STACK-EMPTY(S) and k&gt;0</span><br><span class="line">        POP(S)</span><br><span class="line">        k=k-1</span><br></pre></td></tr></table></figure>

<p>那么，现在需要分析：执行n次栈操作最坏情况下的时间复杂度是多少？  </p>
<p><strong>例2：二进制计数器递增</strong><br>考虑一个$k$位二进制计数器，其初值为$0$，用一个数组$A_{0\cdots k-1}$来表示，当计数器中保存的值是$x$时，$x$的最低位保存在$A_0$最高为保存在$A_{k-1}$，即：<br>$$<br>x&#x3D;\sum_{i&#x3D;0}^{k-1}{2^iA_i}<br>$$<br>只有一个操作<strong>INCREAMENT</strong> ，即计数器$+1$：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INCREMENT(A)</span><br><span class="line">    i=0</span><br><span class="line">    while i&lt;k and A[i]==1</span><br><span class="line">        A[i]=0</span><br><span class="line">        i=i+1</span><br><span class="line">    if i&lt;k</span><br><span class="line">        A[i]=1</span><br></pre></td></tr></table></figure>

<p>那么，现在需要分析：执行$n$次该操作最坏情况下的时间复杂度是多少？  </p>
<h3 id="聚合分析"><a href="#聚合分析" class="headerlink" title="聚合分析"></a>聚合分析</h3><p>利用聚合分析，我们可以证明对于任意的$n$，一个包含$n$个操作的序列花费的总时间为$T(n)$。因此，在最坏情况下，每个操作的平均代价，或称为摊还代价为$\displaystyle \frac{T(n)}{n}$，即每个操作的时间复杂度为$O(1)$。  </p>
<p><strong>例1</strong><br>单独看三个操作，前两个都是$O(1)$的，第三个是$O(n)$的。这样直观的看，最坏情况下，执行$n$次操作的代价是$O(n^2)$，但这实际上是一个松的上界。因为要想达到这个上界，就要尽量多执行第三个操作，但是栈为空以后，第三个操作就什么都不干了。  </p>
<p>我们需要对这三个操作整体分析。显然，对于一个非空的栈，可以执行的<strong>POP</strong> 操作的个数（包括后两个操作的所有<strong>POP</strong> ）与执行了<strong>PUSH</strong> 操作的个数相当，即最多$n$次。  </p>
<p>因此，$n$次操作最坏情况下执行的时间复杂度为$O(n)$，平均每次操作的代价是$O(1)$。  </p>
<p>在聚合分析中，我们将每个操作的摊还代价设定为平均代价，故三种操作的摊还代价都是$O(1)$。  </p>
<p><strong>例2</strong><br>和上一个例子类似，单独考虑每一个操作，如果原来$k$个$1$，操作一次会把$k$个位置全更改一遍，代价是$O(k)$，执行$n$次就是$O(nk)$，这是一个非常松的上界，不可能每次都遇到这种极端情况。  </p>
<p>考虑连续的$n$次操作，我们可以得知，每次调用$A_0$都会翻转，每两次调用$A_1$翻转一次，每四次调用$A_2$翻转一次，每$2^i$次调用$A_i$翻转一次。<br>因此执行$n$次操作的总代价：<br>$$<br>\sum_{i&#x3D;0}^{k-1}{\lfloor\frac{n}{2^i}\rfloor} &lt; n\sum_{i&#x3D;0}^{\infty}{\frac{1}{2^i}}&#x3D;2n<br>$$<br>故$n$次操作代价是$O(n)$，每次操作代价是$O(1)$。  </p>
<h3 id="核算法"><a href="#核算法" class="headerlink" title="核算法"></a>核算法</h3><p>用核算法进行摊还分析时，我们对不同操作赋予不同费用，赋予某些操作的费用可能多于或少于其实际代价。我们将赋予一个操作的费用称为它的<strong>摊还代价</strong> 。当一个操作的摊还代价超出其实际代价时，我们将正差额存入数据结构中的特定对象，存入的正差额称为<strong>信用</strong> 。对于后续操作中摊还分析小于实际代价的情况，信用可以用来支付负差额。因此，我们可以将一个操作的摊还代价分解为其实际代价和信用（存入的或用掉的）。不同的操作可能有不同的摊还代价。这种方法不同于聚合分析中所有操作都赋予相同摊还代价的方式。  </p>
<p>如果我们希望通过分析摊还代价来证明每个操作的平均代价的最坏情况很小，就应确保操作序列的总摊还代价给出了序列真实代价的上界。而且与聚合分析一样，这种关系必须对所有操作序列都成立。将第$i$个操作的摊还代价表示为$\hat{c_i}$，真实代价表示为$c_i$，则要求$\displaystyle \sum_{i&#x3D;1}^n{\hat{c_i}}\geq\sum_{i&#x3D;1}^n{c_i}$，数据结构中存储的信用恰好等于总摊还代价与总实际代价的差值，要求这一差值一直保持非负。比如在某个步骤，允许信用为负值（前面操作缴费不足，承诺在随后补齐账户欠费），那么当时的总摊还代价就小于总实际代价，对于到那个时刻为止的操作序列，总摊还代价就不再是总实际代价的上界了。因此，必须保证数据结构中的总信用永远为非负值。  </p>
<p><strong>例1</strong><br>先考虑每个操作的实际代价（$s$是栈中元素个数）：<br>$$<br>\begin{array}{c|c}<br>    \bf{PUSH}&amp;1\<br>    \bf{POP}&amp;1\<br>    \bf{MULTIPOP}&amp;\min(k,s)\<br>\end{array}<br>$$<br>然后我们赋予三个操作摊还代价：<br>$$<br>\begin{array}{c|c}<br>    \bf{PUSH}&amp;2\<br>    \bf{POP}&amp;0\<br>    \bf{MULTIPOP}&amp;0\<br>\end{array}<br>$$<br>假定使用￥$1$来代表$1$个单位的代价，那么每次<strong>PUSH</strong> 时，除了支付￥$1$外，我们额外支付￥$1$作为可能发生的将来<strong>POP</strong> 的预付费（信用），在<strong>POP</strong> 时直接从信用里取，那么，任意时刻，每个栈里的元素都存在对应的预付费（信用）￥$1$，一定满足当前信用为非负值，即当前摊还代价是实际代价的一个上界。  </p>
<p>因此，每次操作的摊还代价是$O(1)$，$n$次操作的摊还代价是$O(n)$。  </p>
<p><strong>例2</strong><br>我们设定置位（$0$变$1$）的摊还代价为$2$，复位（$1$变$0$）的摊还代价为$0$。  </p>
<p>与上面的例子的分析方法相同，每次操作至多有$1$个位发生置位，这时除了支付￥$1$的实际代价之外，再预付将来可能发生的复位的代价￥$1$，那么将来复位时就可以直接从信用中拿。  </p>
<p>因此，每次操作的摊还代价是$O(1)$，$n$次操作的摊还代价是$O(n)$。  </p>
<h3 id="势能分析"><a href="#势能分析" class="headerlink" title="势能分析"></a>势能分析</h3><p>势能法摊还分析并不将预付代价表示为数据结构中特定对象的信用，而是表示成“势能”，将势能释放即可用来支付未来操作的代价。我们将势能与整个数据结构而不是特定的对象相关联。  </p>
<p>势能法工作方式如下。我们将对一个初始数据结构$D_0$执行$n$个操作。对$\forall i\in[1,n],i\in\mathbb{Z}$，令$c_i$为第$i$个操作的实际代价，令$D_i$为在数据结构$D_{i-1}$上执行第$i$个操作得到的结果数据结构。势能函数$\Phi$将每个数据结构$D_i$映射到$\Phi(D_i)\in\mathbb R$，此值即为关联到数据结构$D_i$的势能，第$i$个操作的摊还代价$\hat{c_i}$用势函数$\Phi$定义为：<br>$$<br>\hat{c_i}&#x3D;c_i+\Phi(D_i)-\Phi(D_{i-1})<br>$$</p>
<p>因此，每个操作的摊还代价等于操作的实际代价加上此操作引起的势能变化。  </p>
<p>累加即可得n步操作的总摊还代价：<br>$$<br>\sum_{i&#x3D;1}^n{\hat{c_i}}&#x3D;\sum_{i&#x3D;1}^n{c_i}+\Phi(D_i)-\Phi(D_0)<br>$$</p>
<p>如果能定义一个势函数$\Phi$，使得对于$\forall n,\Phi(D_n)\geq\Phi(D_0)$，则总摊还代价$\displaystyle \sum_{i&#x3D;1}^n{\hat{c_i}}$给出了总实际代价$\displaystyle \sum_{i&#x3D;1}^n{c_i}$的一个上界。  </p>
<p>因此问题的关键在于定义一个合适的势函数$\Phi$。  </p>
<p><strong>例1</strong><br>我们定义势函数为当前栈中的元素个数，那么$\Phi(D_0)&#x3D;0$，且对于$\forall i,\Phi(D_i)\geq 0&#x3D;\Phi(D_0)$，那么任意时刻摊还代价都是实际代价的一个上界。  </p>
<p>下面分析每个操作的摊还代价。  </p>
<p>假设第$i$个操作是<strong>PUSH</strong> ，且当时栈中包含$s$个对象，那么$\Phi(D_i)-\Phi(D_{i&#x3D;1})&#x3D;(s+1)-s&#x3D;1$，<strong>PUSH</strong> 操作的摊还代价是：<br>$$<br>\hat{c_i}&#x3D;c_i+\Phi(D_i)-\Phi(D_{i-1})&#x3D;1+1&#x3D;2<br>$$</p>
<p>假设第i个操作是<strong>MULTIPOP(S,k)</strong> ，将$k’&#x3D;\min(k,s)$个对象弹出栈，对象的实际代价为$k’$，势差为$\Phi(D_i)-\Phi(D_{i-1})&#x3D;-k’$，那么该操作的弹簧代价为：<br>$$<br>\hat{c_i}&#x3D;c_i+\Phi(D_i)-\Phi(D_{i-1})&#x3D;k’-k’&#x3D;0<br>$$</p>
<p>类似地，普通的<strong>POP</strong> 操作的弹簧代价也为$0$。  </p>
<p>因此，每次操作的摊还代价是$O(1)$，$n$次操作的摊还代价是$O(n)$。  </p>
<p><strong>例2</strong><br>我们定义第$i$次操作后，势函数为当前计数器中$1$的个数$b_i$。  </p>
<p>假设第$i$次操作把$t_i$个位复位（$1$变回$0$），则实际代价至多为$t_i+1$，如果$b_i\neq 0$，则所有$k$位都复位了，因此$b_{i-1}&#x3D;t_i&#x3D;k$，若干$b_i&gt;0$，则$b_i&#x3D;b_{i-1}-t_i+1$，无论哪种情况，都满足$b_i\leq b_{i-1}-t_i+1$，势差为：<br>$$<br>\Phi(D_i)-\Phi(D_{i-1})\leq(b_{i-1}-t_i+1)-b_{i-1}&#x3D;1-t_i<br>$$</p>
<p>因此，摊还代价为：<br>$$<br>\hat{c_i}&#x3D;c_i+\Phi(D_i)-\Phi(D_i-1)\leq(t_i+1)-(1-t_i)&#x3D;2<br>$$</p>
<p>因此，每次操作的摊还代价是$O(1)$，$n$次操作的摊还代价是$O(n)$。  </p>
<p>另外，即使计数器不是从$0$开始也可以使用势能法分析。  </p>
<p>初始时有$b_0$个$1$，$n$次操作以后有$b_n$个$1$，把摊还代价的定义式移项，可得$\displaystyle \sum_{i&#x3D;1}^n{c_i}&#x3D;\sum_{i&#x3D;1}^n{\hat{c_i}}-\Phi(D_n)+\Phi(D_0)&#x3D;\sum_{i&#x3D;1}^n{2-b_n+b_0}&#x3D;2n-b_n+b_0$，由于$b_0\leq k$，因此只要$k&#x3D;O(n)$，总实际代价就是$O(n)$，即至少执行$O(k)$次即可。  </p>
<p>因此，不管计数器初值是什么，$n$次操作的总实际代价都是$O(n)$。  </p>
<h2 id="自动机"><a href="#自动机" class="headerlink" title="自动机"></a>自动机</h2><p>一个<strong>确定有限状态自动机（DFA）</strong> 是由以下五部分组成的五元组$(Q,\Sigma,\delta,s,F)$：<br>1、字符集（$\mathbb{\Sigma}$），该自动机只能输入这些字符。<br>2、状态集合（$Q$）。<br>3、起始状态（$s$），$s\in Q$。<br>4、接受状态集合（$F$），$F\subseteq Q$。<br>5、转移函数（$\delta$），$\delta$是一个接受两个参数返回一个值的函数，其中第一个参数和返回值都是一个状态，第二个参数是字符集中的一个字符。$Q\times\Sigma\rightarrow Q$，即$\delta(q,\sigma)&#x3D;q’,\ q,q’\in Q,\sigma\in\Sigma$。  </p>
<h3 id="KMP自动机"><a href="#KMP自动机" class="headerlink" title="KMP自动机"></a>KMP自动机</h3><p>基于字符串$s$的KMP自动机接受且仅接受以$s$为后缀的字符串，$F&#x3D;{\left|s\right|}$。<br>$$<br>\delta(i,c)&#x3D;<br>    \begin{cases}<br>        \displaylines{<br>            i+1 &amp; :s_{i+1}&#x3D;c\\<br>            0 &amp; :s_1\neq c, \ i&#x3D;0\\<br>            \delta(\pi(i),c) &amp; :s_{i+1}\neq c, \ i&gt;0<br>        }<br>    \end{cases}<br>$$</p>
<h2 id="主定理"><a href="#主定理" class="headerlink" title="主定理"></a>主定理</h2><table>
<thead>
<tr>
<th align="center">符号</th>
<th align="center"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">$\Theta$</td>
<td align="center">$&#x3D;$</td>
</tr>
<tr>
<td align="center">$O$</td>
<td align="center">$\leq$</td>
</tr>
<tr>
<td align="center">$o$</td>
<td align="center">$&lt;$</td>
</tr>
<tr>
<td align="center">$\Omega$</td>
<td align="center">$\geq$</td>
</tr>
<tr>
<td align="center">$\omega$</td>
<td align="center">$&gt;$</td>
</tr>
</tbody></table>
<p>将一个规模为$n$的问题，通过分治得到$a$个规模为$\displaystyle\frac{n}{b}$的子问题，每次递归带来的额外计算为$f(n)$，那么：<br>$$<br>\begin{aligned}<br>    \displaylines{<br>        \hat c&#x3D;&amp;\log_ba\\<br>        T(n)&#x3D;&amp;aT\left(\frac{n}{b}\right)+f(n)\\<br>        T(n)&#x3D;&amp;<br>        \begin{cases}<br>            \Theta\left(n^{\hat c}\right)&amp;:f(n)&#x3D;O\left(n^c\right), \ c&lt;\hat c\\<br>            \begin{cases}<br>                \Theta\left(n^{\hat c}\log^{k+1}n\right)&amp;:\exist k&gt;-1\\<br>                \Theta\left(n^{\hat c}\log\log n\right)&amp;:k&#x3D;-1\\<br>                \Theta\left(n^{\hat c}\right)&amp;:\exist k&lt;-1\\<br>            \end{cases}&amp;:f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)\\<br>            \Theta(f(n))&amp;:f(n)&#x3D;\Omega(n^c), \ c&gt;\hat c<br>           \end{cases}<br>       }<br>\end{aligned}<br>$$</p>
<hr>
<h3 id="1、当-f-n-O-n-c-c"><a href="#1、当-f-n-O-n-c-c" class="headerlink" title="1、当$f(n)&#x3D;O(n^c), \ c&lt;\hat c$时："></a>1、当$f(n)&#x3D;O(n^c), \ c&lt;\hat c$时：</h3><p>$$<br>T(n)&#x3D;\Theta(n^{\hat c})<br>$$</p>
<h4 id="例如："><a href="#例如：" class="headerlink" title="例如："></a>例如：</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        &amp;T(n)&#x3D;8T\left(\frac{n}{2}\right)+1000n^2\\<br>        &amp;\qquad\qquad\Downarrow\\<br>        &amp;a&#x3D;8, \ b&#x3D;2, \ f(n)&#x3D;1000n^2\\<br>        &amp;\qquad\qquad\Downarrow\\<br>        &amp;c&#x3D;2\rightarrow f(n)&#x3D;O(n^c)\\<br>        \therefore&amp;c&#x3D;2\\<br>        \because&amp;\hat c&#x3D;\log_ba&#x3D;\log_28&#x3D;3&gt;c\\<br>        \therefore&amp;T(n)&#x3D;\Theta\left(n^{\log_ba}\right)&#x3D;\Theta(n^3)<br>    }<br>\end{aligned}<br>$$</p>
<hr>
<h3 id="2、当-exist-k-geq-0-f-n-Theta-left-n-hat-c-log-kn-right-时："><a href="#2、当-exist-k-geq-0-f-n-Theta-left-n-hat-c-log-kn-right-时：" class="headerlink" title="2、当$\exist k\geq 0, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时："></a>2、当$\exist k\geq 0, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时：</h3><p>$$<br>T(n)&#x3D;\Theta\left(n^{\hat c}\log^{k+1}n\right)<br>$$</p>
<h4 id="例如：-1"><a href="#例如：-1" class="headerlink" title="例如："></a>例如：</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        &amp;T(n)&#x3D;2T\left(\frac{n}{2}\right)+10n\\<br>        &amp;\qquad\qquad\Downarrow\\<br>        &amp;a&#x3D;2, \ b&#x3D;2, \ f(n)&#x3D;10n\\<br>        &amp;\hat c&#x3D;\log_ba&#x3D;\log_22&#x3D;1\\<br>        &amp;\qquad\qquad\Downarrow\\<br>        &amp;k&#x3D;0\rightarrow f(n)&#x3D;O\left(n^{\hat c}\log^kn\right)\\<br>        \therefore&amp;T(n)&#x3D;\Theta\left(n^{\hat c}\log^{k+1}n\right)&#x3D;\Theta\left(n^1\log^1n\right)&#x3D;\Theta(n\log n)<br>    }<br>\end{aligned}<br>$$</p>
<h4 id="扩展："><a href="#扩展：" class="headerlink" title="扩展："></a>扩展：</h4><h5 id="当-exist-k-1-f-n-Theta-left-n-hat-c-log-kn-right-时："><a href="#当-exist-k-1-f-n-Theta-left-n-hat-c-log-kn-right-时：" class="headerlink" title="当$\exist k&gt;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时："></a>当$\exist k&gt;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时：</h5><p>$$<br>T(n)&#x3D;\Theta\left(n^{\hat c}\log^{k+1}n\right)<br>$$</p>
<h5 id="当-k-1-f-n-Theta-left-n-hat-c-log-kn-right-时："><a href="#当-k-1-f-n-Theta-left-n-hat-c-log-kn-right-时：" class="headerlink" title="当$k&#x3D;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时："></a>当$k&#x3D;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时：</h5><p>$$<br>T(n)&#x3D;\Theta\left(n^{\hat c}\log\log n\right)<br>$$</p>
<h5 id="当-exist-k"><a href="#当-exist-k" class="headerlink" title="当$\exist k&lt;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$"></a>当$\exist k&lt;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$</h5><p>$$<br>T(n)&#x3D;\Theta\left(n^{\hat c}\right)<br>$$</p>
<hr>
<h3 id="3、当-f-n-Omega-left-n-c-right-c-hat-c-时："><a href="#3、当-f-n-Omega-left-n-c-right-c-hat-c-时：" class="headerlink" title="3、当$f(n)&#x3D;\Omega\left(n^c\right), \ c&gt;\hat c$时："></a>3、当$f(n)&#x3D;\Omega\left(n^c\right), \ c&gt;\hat c$时：</h3><p>$$<br>T(n)&#x3D;\Theta\left(f(n)\right)<br>$$</p>
<h4 id="例如：-2"><a href="#例如：-2" class="headerlink" title="例如："></a>例如：</h4><p>$$<br>\begin{aligned}<br>    \displaylines{<br>        &amp;T(n)&#x3D;2T\left(\frac{n}{2}\right)+n^2\\<br>        &amp;\qquad\qquad\Downarrow\\<br>        &amp;a&#x3D;2, \ b&#x3D;2, \ f(n)&#x3D;n^2\\<br>        &amp;\qquad\qquad\Downarrow\\<br>        &amp;c&#x3D;2\rightarrow f(n)&#x3D;\Omega\left(n^c\right)\\<br>        \because&amp;\hat c&#x3D;\log_ba&#x3D;\log_22&#x3D;1&lt;c\\<br>        \therefore&amp;T(n)&#x3D;\Theta\left(n\right)&#x3D;\Theta\left(n^2\right)<br>    }<br>\end{aligned}<br>$$</p>
<hr>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h4 id="NOIP2016TGT14"><a href="#NOIP2016TGT14" class="headerlink" title="NOIP2016TGT14"></a>NOIP2016TGT14</h4><blockquote>
<p>假设某算法的时间表示为地推关系式<br>$$<br>\begin{aligned}<br>\displaylines{<br>    T(n)&#x3D;&amp;2T\left(\frac{n}{4}\right)+\sqrt n\\<br>    T(1)&#x3D;&amp;1<br>}<br>\end{aligned}<br>$$<br>则算法的时间复杂度为（C）。<br>A.$O(n)$B.$O\left(\sqrt n\right)$C.$O\left(\sqrt n\log n\right)$D.$O\left(n^2\right)$</p>
</blockquote>
<p>$$<br>\begin{aligned}<br>    \displaylines{<br>        &amp;a&#x3D;2, \ b&#x3D;4, \ f(n)&#x3D;\sqrt n&#x3D;n^{\frac{1}{2}}\\<br>        &amp;\hat c&#x3D;\log_b a&#x3D;\log_42&#x3D;\frac{1}{2}\\<br>        &amp;k&#x3D;0\rightarrow f(n)&#x3D;O\left(n^{\hat c}\log^kn\right)\\<br>        \therefore&amp;T(n)&#x3D;\Theta\left(n^{\hat c}\log^{k+1}n\right)&#x3D;\Theta\left(n^{\frac{1}{2}}\log^1n\right)&#x3D;\Theta\left(\sqrt n\log n\right)\\<br>    }<br>\end{aligned}<br>$$</p>
<h4 id="NOIP2015TGT10"><a href="#NOIP2015TGT10" class="headerlink" title="NOIP2015TGT10"></a>NOIP2015TGT10</h4><blockquote>
<p>设某算法的计算时间表示为递推关系式<br>$$<br>\begin{aligned}<br>\displaylines{<br>    T(n)&#x3D;&amp;T(n-1)+n, \ n\in\mathbb N^+\\<br>    T(0)&#x3D;&amp;1<br>}<br>\end{aligned}<br>$$<br>则该算法的时间复杂度为（D）。<br>A.$O(\log n)$B.$O(n\log n)$C.$O(n)$D.$O(n^2)$</p>
</blockquote>
<p>$$<br>\begin{aligned}<br>    \displaylines{<br>        &amp;T(n)\\<br>        &#x3D;&amp;T(n-1)+n\\<br>        &#x3D;&amp;T(n-2)+(n-1)+n\\<br>        &amp;\qquad\qquad\vdots\\<br>        &#x3D;&amp;T(0)+\sum_{i&#x3D;1}^ni\\<br>        &#x3D;&amp;1+\frac{(n+1)n}{2}\\<br>        &#x3D;&amp;O(n^2)<br>    }<br>\end{aligned}<br>$$</p>
<h4 id="NOIP2013TGT7"><a href="#NOIP2013TGT7" class="headerlink" title="NOIP2013TGT7"></a>NOIP2013TGT7</h4><blockquote>
<p>斐波那契数列的定义如下：<br>$$<br>\begin{aligned}<br>\displaylines{<br>    F_1&#x3D;&amp;1\\<br>    F_2&#x3D;&amp;1\\<br>    F_n&#x3D;&amp;F_{n-1}+F_{n-1}, \ n\geq 3<br>}<br>\end{aligned}<br>$$<br>如果用下面的函数计算斐波那契数列的第$n$项，则其时间复杂度为（D）。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="function"><span class="type">int</span> <span class="title">F</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">&gt;</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (n &lt;= <span class="number">2</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">F</span>(n - <span class="number">1</span>) + <span class="built_in">F</span>(n - <span class="number">2</span>);</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>

<p>设计算$f(i)$的次数为$g(i)$。  </p>
</blockquote>
<p>$$<br>\begin{aligned}<br>    \displaylines{<br>        \because&amp;f(n)&#x3D;&amp;f(n-1)+f(n-1)\\<br>        \therefore&amp;g(n)&#x3D;&amp;g(n-1)+g(n-2)\\<br>        \therefore&amp;g(1)&#x3D;&amp;f(1)&#x3D;1,\\<br>        &amp;g(2)&#x3D;&amp;f(2)&#x3D;1\\<br>        \because&amp;f(n)&#x3D;&amp;f(n-1)+f(n+1),\\<br>        &amp;g(n)&#x3D;&amp;g(n-1)+g(n-2)\\<br>        \therefore&amp;g(n)&#x3D;f(n)\\<br>        &amp;T(n)&#x3D;g(n)&#x3D;f(n)&#x3D;O(f(n))<br>    }<br>\end{aligned}<br>$$</p>
<h2 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h2><h3 id="常用"><a href="#常用" class="headerlink" title="常用"></a>常用</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\LaTeX</span><span class="keyword">\frac</span>&#123;x&#125;&#123;y&#125;<span class="keyword">\dfrac</span>&#123;x&#125;&#123;y&#125;<span class="keyword">\sqrt</span>[a]&#123;b&#125;<span class="keyword">\lim</span><span class="keyword">\log</span><span class="keyword">\ln</span><span class="keyword">\lg</span><span class="keyword">\sin</span><span class="keyword">\cos</span><span class="keyword">\tan</span><span class="keyword">\csc</span><span class="keyword">\\</span><span class="keyword">\sec</span><span class="keyword">\cot</span><span class="keyword">\gcd</span><span class="keyword">\arcsin</span><span class="keyword">\arccos</span><span class="keyword">\arctan</span><span class="keyword">\arg</span><span class="keyword">\det</span><span class="keyword">\sinh</span><span class="keyword">\dim</span><span class="keyword">\\</span><span class="keyword">\cosh</span><span class="keyword">\tanh</span><span class="keyword">\exp</span><span class="keyword">\ker</span><span class="keyword">\Pr</span><span class="keyword">\sup</span><span class="keyword">\coth</span><span class="keyword">\deg</span><span class="keyword">\hom</span><span class="keyword">\\</span><span class="keyword">\det</span><span class="keyword">\liminf</span><span class="keyword">\limsup</span><span class="keyword">\max</span><span class="keyword">\min</span><span class="keyword">\operatorname</span> a<span class="keyword">\overset</span>&#123;<span class="keyword">\underset</span>&#123;def&#125;&#123;&#125;&#125;&#123;=&#125;&#123;&#125;<span class="built_in">^</span>2<span class="built_in">_</span>1<span class="keyword">\!</span>a<span class="built_in">^</span>3<span class="built_in">_</span>4<span class="keyword">\mod</span> a<span class="keyword">\pmod</span> a<span class="keyword">\bmod</span> a</span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    \LaTeX\frac{x}{y}\dfrac{x}{y}\sqrt[a]{b}\lim\log\ln\lg\sin\cos\tan\csc\\<br>    \sec\cot\gcd\arcsin\arccos\arctan\arg\det\sinh\dim\\<br>    \cosh\tanh\exp\ker\Pr\sup\coth\deg\hom\\<br>    \det\liminf\limsup\max\min\operatorname a\overset{\underset{def}{}}{&#x3D;}{}^2_1!a^3_4\mod a\pmod a\bmod a<br>}<br>$$</p>
<h3 id="数学模式重音符号"><a href="#数学模式重音符号" class="headerlink" title="数学模式重音符号"></a>数学模式重音符号</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\hat</span> a<span class="keyword">\check</span> a<span class="keyword">\tilde</span> a<span class="keyword">\grave</span> a<span class="keyword">\dot</span> a<span class="keyword">\ddot</span> a<span class="keyword">\bar</span> a<span class="keyword">\vec</span> a<span class="keyword">\widehat</span> a<span class="keyword">\acute</span> a<span class="keyword">\\</span><span class="keyword">\breve</span> a<span class="keyword">\widetilde</span> a<span class="keyword">\overline</span> a<span class="keyword">\underline</span> a<span class="keyword">\widetilde</span> a<span class="keyword">\widehat</span> a<span class="keyword">\underbrace</span> a<span class="built_in">_</span>b<span class="keyword">\overbrace</span> a<span class="built_in">^</span>b<span class="keyword">\overleftarrow</span> a<span class="keyword">\overrightarrow</span> a<span class="keyword">\boxed</span> a</span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    \hat a\check a\tilde a\grave a\dot a\ddot a\bar a\vec a\widehat a\acute a\<br>    \breve a\widetilde a\overline a\underline a\widetilde a\widehat a\underbrace a_b\overbrace a^b\overleftarrow a\overrightarrow a\boxed a<br>}<br>$$</p>
<h3 id="希腊字母"><a href="#希腊字母" class="headerlink" title="希腊字母"></a>希腊字母</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\Alpha</span><span class="keyword">\alpha</span><span class="keyword">\Beta</span><span class="keyword">\beta</span><span class="keyword">\Gamma</span><span class="keyword">\gamma</span><span class="keyword">\Delta</span><span class="keyword">\delta</span><span class="keyword">\Epsilon</span><span class="keyword">\epsilon</span><span class="keyword">\varepsilon</span><span class="keyword">\Zeta</span><span class="keyword">\zeta</span><span class="keyword">\Eta</span><span class="keyword">\eta</span><span class="keyword">\Theta</span><span class="keyword">\theta</span><span class="keyword">\vartheta</span><span class="keyword">\Iota</span><span class="keyword">\iota</span><span class="keyword">\Kappa</span><span class="keyword">\kappa</span><span class="keyword">\\</span><span class="keyword">\Lambda</span><span class="keyword">\lambda</span><span class="keyword">\Mu</span><span class="keyword">\mu</span><span class="keyword">\Nu</span><span class="keyword">\nu</span><span class="keyword">\Xi</span><span class="keyword">\xi</span> Oo<span class="keyword">\Pi</span><span class="keyword">\pi</span><span class="keyword">\varpi</span><span class="keyword">\Rho</span><span class="keyword">\rho</span><span class="keyword">\varrho</span><span class="keyword">\Sigma</span><span class="keyword">\sigma</span><span class="keyword">\varsigma</span><span class="keyword">\Tau</span><span class="keyword">\tau</span><span class="keyword">\Upsilon</span><span class="keyword">\upsilon</span><span class="keyword">\\</span><span class="keyword">\Phi</span><span class="keyword">\phi</span><span class="keyword">\varphi</span><span class="keyword">\Chi</span><span class="keyword">\chi</span><span class="keyword">\Psi</span><span class="keyword">\psi</span><span class="keyword">\Omega</span><span class="keyword">\omega</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    \Alpha\alpha\Beta\beta\Gamma\gamma\Delta\delta\Epsilon\epsilon\varepsilon\Zeta\zeta\Eta\eta\Theta\theta\vartheta\Iota\iota\Kappa\kappa\\<br>    \Lambda\lambda\Mu\mu\Nu\nu\Xi\xi Oo\Pi\pi\varpi\Rho\rho\varrho\Sigma\sigma\varsigma\Tau\tau\Upsilon\upsilon\\<br>    \Phi\phi\varphi\Chi\chi\Psi\psi\Omega\omega<br>}<br>$$</p>
<h3 id="二元关系符"><a href="#二元关系符" class="headerlink" title="二元关系符"></a>二元关系符</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&gt;=<span class="keyword">\leq</span><span class="keyword">\geq</span><span class="keyword">\equiv</span><span class="keyword">\ll</span><span class="keyword">\gg</span><span class="keyword">\doteq</span><span class="keyword">\prec</span><span class="keyword">\\</span><span class="keyword">\succ</span><span class="keyword">\sim</span><span class="keyword">\preceq</span><span class="keyword">\succeq</span><span class="keyword">\simeq</span><span class="keyword">\subset</span><span class="keyword">\supset</span><span class="keyword">\approx</span><span class="keyword">\subseteq</span><span class="keyword">\supseteq</span><span class="keyword">\\</span><span class="keyword">\cong</span><span class="keyword">\sqsubset</span><span class="keyword">\sqsupset</span><span class="keyword">\Join</span><span class="keyword">\sqsubseteq</span><span class="keyword">\sqsupseteq</span><span class="keyword">\bowtie</span><span class="keyword">\in</span><span class="keyword">\ni</span><span class="keyword">\propto</span><span class="keyword">\\</span><span class="keyword">\vdash</span><span class="keyword">\dashv</span><span class="keyword">\models</span><span class="keyword">\mid</span><span class="keyword">\parallel</span><span class="keyword">\perp</span><span class="keyword">\smile</span><span class="keyword">\frown</span><span class="keyword">\asymp</span>:<span class="keyword">\\</span><span class="keyword">\lessdot</span><span class="keyword">\gtrdot</span><span class="keyword">\doteqdot</span><span class="keyword">\leqslant</span><span class="keyword">\geqslant</span><span class="keyword">\risingdotseq</span><span class="keyword">\eqslantless</span><span class="keyword">\eqslantgtr</span><span class="keyword">\fallingdotseq</span><span class="keyword">\leqq</span><span class="keyword">\\</span><span class="keyword">\geqq</span><span class="keyword">\eqcirc</span><span class="keyword">\lesssim</span><span class="keyword">\gtrsim</span><span class="keyword">\triangleq</span><span class="keyword">\lessapprox</span><span class="keyword">\gtrapprox</span><span class="keyword">\bumpeq</span><span class="keyword">\lessgtr</span><span class="keyword">\gtrless</span><span class="keyword">\\</span><span class="keyword">\Bumpeq</span><span class="keyword">\lesseqgtr</span><span class="keyword">\gtreqless</span><span class="keyword">\thicksim</span><span class="keyword">\lesseqqgtr</span><span class="keyword">\gtreqqless</span><span class="keyword">\thickapprox</span><span class="keyword">\preccurlyeq</span><span class="keyword">\succcurlyeq</span><span class="keyword">\approxeq</span><span class="keyword">\\</span><span class="keyword">\curlyeqprec</span><span class="keyword">\curlyeqsucc</span><span class="keyword">\backsim</span><span class="keyword">\precsim</span><span class="keyword">\succsim</span><span class="keyword">\backsimeq</span><span class="keyword">\precapprox</span><span class="keyword">\succapprox</span><span class="keyword">\vDash</span><span class="keyword">\subseteqq</span><span class="keyword">\\</span><span class="keyword">\supseteqq</span><span class="keyword">\Vdash</span><span class="keyword">\shortparallel</span><span class="keyword">\Supset</span><span class="keyword">\Vvdash</span><span class="keyword">\blacktriangleleft</span><span class="keyword">\sqsupset</span><span class="keyword">\backepsilon</span><span class="keyword">\vartriangleright</span><span class="keyword">\because</span><span class="keyword">\\</span><span class="keyword">\varpropto</span><span class="keyword">\blacktriangleright</span><span class="keyword">\Subset</span><span class="keyword">\between</span><span class="keyword">\trianglerighteq</span><span class="keyword">\smallfrown</span><span class="keyword">\pitchfork</span><span class="keyword">\vartriangleleft</span><span class="keyword">\shortmid</span><span class="keyword">\smallsmile</span><span class="keyword">\\</span><span class="keyword">\trianglelefteq</span><span class="keyword">\therefore</span><span class="keyword">\sqsubset</span></span><br></pre></td></tr></table></figure>

<p>‘\not’+<br>$$<br>\displaylines{<br>    &lt;&gt;&#x3D;\leq\geq\equiv\ll\gg\doteq\prec\\<br>    \succ\sim\preceq\succeq\simeq\subset\supset\approx\subseteq\supseteq\\<br>    \cong\sqsubset\sqsupset\Join\sqsubseteq\sqsupseteq\bowtie\in\ni\propto\\<br>    \vdash\dashv\models\mid\parallel\perp\smile\frown\asymp:\\<br>    \lessdot\gtrdot\doteqdot\leqslant\geqslant\risingdotseq\eqslantless\eqslantgtr\fallingdotseq\leqq\\<br>    \geqq\eqcirc\lesssim\gtrsim\triangleq\lessapprox\gtrapprox\bumpeq\lessgtr\gtrless\\<br>    \Bumpeq\lesseqgtr\gtreqless\thicksim\lesseqqgtr\gtreqqless\thickapprox\preccurlyeq\succcurlyeq\approxeq\\<br>    \curlyeqprec\curlyeqsucc\backsim\precsim\succsim\backsimeq\precapprox\succapprox\vDash\subseteqq\\<br>    \supseteqq\Vdash\shortparallel\Supset\Vvdash\blacktriangleleft\sqsupset\backepsilon\vartriangleright\because\\<br>    \varpropto\blacktriangleright\Subset\between\trianglerighteq\smallfrown\pitchfork\vartriangleleft\shortmid\smallsmile\\<br>    \trianglelefteq\therefore\sqsubset<br>}<br>$$<br>AMS否定关系符和箭头</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\nless</span><span class="keyword">\ngtr</span><span class="keyword">\varsubsetneqq</span><span class="keyword">\lneq</span><span class="keyword">\gneq</span><span class="keyword">\varsupsetneqq</span><span class="keyword">\nleq</span><span class="keyword">\ngeq</span><span class="keyword">\nsubseteqq</span><span class="keyword">\nleqslant</span><span class="keyword">\\</span><span class="keyword">\ngeqslant</span><span class="keyword">\nsupseteqq</span><span class="keyword">\lneqq</span><span class="keyword">\gneqq</span><span class="keyword">\nmid</span><span class="keyword">\lvertneqq</span><span class="keyword">\gvertneqq</span><span class="keyword">\nparallel</span><span class="keyword">\nleqq</span><span class="keyword">\ngeqq</span><span class="keyword">\\</span><span class="keyword">\nshortmid</span><span class="keyword">\lnsim</span><span class="keyword">\gnsim</span><span class="keyword">\nshortparallel</span><span class="keyword">\lnapprox</span><span class="keyword">\gnapprox</span><span class="keyword">\nsim</span><span class="keyword">\nprec</span><span class="keyword">\nsucc</span><span class="keyword">\ncong</span><span class="keyword">\\</span><span class="keyword">\npreceq</span><span class="keyword">\nsucceq</span><span class="keyword">\nvdash</span><span class="keyword">\precneqq</span><span class="keyword">\succneqq</span><span class="keyword">\nvDash</span><span class="keyword">\precnsim</span><span class="keyword">\succnsim</span><span class="keyword">\nVdash</span><span class="keyword">\precnapprox</span><span class="keyword">\\</span><span class="keyword">\succnapprox</span><span class="keyword">\nVDash</span><span class="keyword">\subsetneq</span><span class="keyword">\supsetneq</span><span class="keyword">\ntriangleleft</span><span class="keyword">\varsubsetneq</span><span class="keyword">\varsupsetneq</span><span class="keyword">\ntriangleright</span><span class="keyword">\nsubseteq</span><span class="keyword">\nsupseteq</span><span class="keyword">\\</span><span class="keyword">\ntrianglelefteq</span><span class="keyword">\subsetneqq</span><span class="keyword">\nsupseteq</span><span class="keyword">\ntrianglerighteq</span><span class="keyword">\nleftarrow</span><span class="keyword">\nrightarrow</span><span class="keyword">\nleftrightarrow</span><span class="keyword">\nLeftarrow</span><span class="keyword">\nRightarrow</span><span class="keyword">\nLeftrightarrow</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    \nless\ngtr\varsubsetneqq\lneq\gneq\varsupsetneqq\nleq\ngeq\nsubseteqq\nleqslant\\<br>    \ngeqslant\nsupseteqq\lneqq\gneqq\nmid\lvertneqq\gvertneqq\nparallel\nleqq\ngeqq\\<br>    \nshortmid\lnsim\gnsim\nshortparallel\lnapprox\gnapprox\nsim\nprec\nsucc\ncong\\<br>    \npreceq\nsucceq\nvdash\precneqq\succneqq\nvDash\precnsim\succnsim\nVdash\precnapprox\\<br>    \succnapprox\nVDash\subsetneq\supsetneq\ntriangleleft\varsubsetneq\varsupsetneq\ntriangleright\nsubseteq\nsupseteq\\<br>    \ntrianglelefteq\subsetneqq\nsupseteq\ntrianglerighteq\nleftarrow\nrightarrow\nleftrightarrow\nLeftarrow\nRightarrow\nLeftrightarrow<br>}<br>$$</p>
<h3 id="二元运算符"><a href="#二元运算符" class="headerlink" title="二元运算符"></a>二元运算符</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+-<span class="keyword">\pm</span><span class="keyword">\mp</span><span class="keyword">\triangleleft</span><span class="keyword">\cdot</span><span class="keyword">\div</span><span class="keyword">\triangleright</span><span class="keyword">\times</span><span class="keyword">\setminus</span><span class="keyword">\star</span><span class="keyword">\cup</span><span class="keyword">\\</span><span class="keyword">\cap</span><span class="keyword">\ast</span><span class="keyword">\sqcup</span><span class="keyword">\sqcap</span><span class="keyword">\circ</span><span class="keyword">\vee</span><span class="keyword">\wedge</span><span class="keyword">\bullet</span><span class="keyword">\oplus</span><span class="keyword">\ominus</span><span class="keyword">\\</span><span class="keyword">\diamond</span><span class="keyword">\odot</span><span class="keyword">\oslash</span><span class="keyword">\uplus</span><span class="keyword">\otimes</span><span class="keyword">\bigcirc</span><span class="keyword">\amalg</span><span class="keyword">\bigtriangleup</span><span class="keyword">\bigtriangledown</span><span class="keyword">\dagger</span><span class="keyword">\\</span><span class="keyword">\lhd</span><span class="keyword">\rhd</span><span class="keyword">\ddagger</span><span class="keyword">\unlhd</span><span class="keyword">\unrhd</span><span class="keyword">\wr</span><span class="keyword">\dotplus</span><span class="keyword">\centerdot</span><span class="keyword">\ltimes</span><span class="keyword">\rtimes</span><span class="keyword">\\</span><span class="keyword">\divideontimes</span><span class="keyword">\doublecup</span><span class="keyword">\doublecap</span><span class="keyword">\smallsetminus</span><span class="keyword">\veebar</span><span class="keyword">\barwedge</span><span class="keyword">\doublebarwedge</span><span class="keyword">\boxplus</span><span class="keyword">\boxminus</span><span class="keyword">\circleddash</span><span class="keyword">\\</span><span class="keyword">\boxtimes</span><span class="keyword">\boxdot</span><span class="keyword">\circledcirc</span><span class="keyword">\intercal</span><span class="keyword">\circledast</span><span class="keyword">\rightthreetimes</span><span class="keyword">\curlyvee</span><span class="keyword">\curlywedge</span><span class="keyword">\leftthreetimes</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    +-\pm\mp\triangleleft\cdot\div\triangleright\times\setminus\star\cup\\<br>    \cap\ast\sqcup\sqcap\circ\vee\wedge\bullet\oplus\ominus\\<br>    \diamond\odot\oslash\uplus\otimes\bigcirc\amalg\bigtriangleup\bigtriangledown\dagger\\<br>    \lhd\rhd\ddagger\unlhd\unrhd\wr\dotplus\centerdot\ltimes\rtimes\\<br>    \divideontimes\doublecup\doublecap\smallsetminus\veebar\barwedge\doublebarwedge\boxplus\boxminus\circleddash\\<br>    \boxtimes\boxdot\circledcirc\intercal\circledast\rightthreetimes\curlyvee\curlywedge\leftthreetimes<br>}<br>$$</p>
<h3 id="“大”运算符"><a href="#“大”运算符" class="headerlink" title="“大”运算符"></a>“大”运算符</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\sum</span><span class="keyword">\bigcup</span><span class="keyword">\bigvee</span><span class="keyword">\prod</span><span class="keyword">\bigcap</span><span class="keyword">\bigwedge</span><span class="keyword">\coprod</span><span class="keyword">\bigsqcup</span><span class="keyword">\biguplus</span><span class="keyword">\int</span><span class="keyword">\\</span><span class="keyword">\oint</span><span class="keyword">\iint</span><span class="keyword">\oiint</span><span class="keyword">\iiint</span><span class="keyword">\oiiint</span><span class="keyword">\bigodot</span><span class="keyword">\bigoplus</span><span class="keyword">\bigotimes</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    \sum\bigcup\bigvee\prod\bigcap\bigwedge\coprod\bigsqcup\biguplus\int\\<br>    \oint\iint\oiint\iiint\oiiint\bigodot\bigoplus\bigotimes<br>}<br>$$</p>
<h3 id="箭头"><a href="#箭头" class="headerlink" title="箭头"></a>箭头</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\leftarrow</span><span class="keyword">\longleftarrow</span><span class="keyword">\rightarrow</span><span class="keyword">\longrightarrow</span><span class="keyword">\leftrightarrow</span><span class="keyword">\longleftrightarrow</span><span class="keyword">\Leftarrow</span><span class="keyword">\Longleftarrow</span><span class="keyword">\Rightarrow</span><span class="keyword">\Longrightarrow</span><span class="keyword">\\</span><span class="keyword">\Leftrightarrow</span><span class="keyword">\longleftrightarrow</span><span class="keyword">\mapsto</span><span class="keyword">\longmapsto</span><span class="keyword">\hookleftarrow</span><span class="keyword">\hookrightarrow</span><span class="keyword">\leftharpoonup</span><span class="keyword">\rightharpoonup</span><span class="keyword">\leftharpoondown</span><span class="keyword">\rightharpoondown</span><span class="keyword">\\</span><span class="keyword">\rightleftharpoons</span><span class="keyword">\iff</span><span class="keyword">\uparrow</span><span class="keyword">\downarrow</span><span class="keyword">\updownarrow</span><span class="keyword">\Uparrow</span><span class="keyword">\Downarrow</span><span class="keyword">\Updownarrow</span><span class="keyword">\nearrow</span><span class="keyword">\searrow</span><span class="keyword">\\</span><span class="keyword">\swarrow</span><span class="keyword">\nwarrow</span><span class="keyword">\leadsto</span><span class="keyword">\dashleftarrow</span><span class="keyword">\dashrightarrow</span><span class="keyword">\leftleftarrows</span><span class="keyword">\rightrightarrows</span><span class="keyword">\leftrightarrows</span><span class="keyword">\rightleftarrows</span><span class="keyword">\Lleftarrow</span><span class="keyword">\\</span><span class="keyword">\Rrightarrow</span><span class="keyword">\twoheadleftarrow</span><span class="keyword">\twoheadrightarrow</span><span class="keyword">\leftarrowtail</span><span class="keyword">\rightarrowtail</span><span class="keyword">\leftrightharpoons</span><span class="keyword">\rightleftharpoons</span><span class="keyword">\Lsh</span><span class="keyword">\Rsh</span><span class="keyword">\looparrowleft</span><span class="keyword">\\</span><span class="keyword">\looparrowright</span><span class="keyword">\curvearrowleft</span><span class="keyword">\curvearrowright</span><span class="keyword">\circlearrowleft</span><span class="keyword">\circlearrowright</span><span class="keyword">\multimap</span><span class="keyword">\upuparrows</span><span class="keyword">\downdownarrows</span><span class="keyword">\upharpoonleft</span><span class="keyword">\upharpoonright</span><span class="keyword">\\</span><span class="keyword">\downharpoonright</span><span class="keyword">\rightsquigarrow</span><span class="keyword">\leftrightsquigarrow</span><span class="keyword">\xleftarrow</span>[b] a<span class="keyword">\xrightarrow</span>[b] a<span class="keyword">\xLeftarrow</span> a<span class="keyword">\xRightarrow</span> x<span class="keyword">\xleftrightarrow</span> a<span class="keyword">\xLeftrightarrow</span> a</span><br></pre></td></tr></table></figure>

<p>‘\n’+<br>$$<br>\displaylines{<br>    \leftarrow\longleftarrow\rightarrow\longrightarrow\leftrightarrow\longleftrightarrow\Leftarrow\Longleftarrow\Rightarrow\Longrightarrow\\<br>    \Leftrightarrow\longleftrightarrow\mapsto\longmapsto\hookleftarrow\hookrightarrow\leftharpoonup\rightharpoonup\leftharpoondown\rightharpoondown\\<br>    \rightleftharpoons\iff\uparrow\downarrow\updownarrow\Uparrow\Downarrow\Updownarrow\nearrow\searrow\\<br>    \swarrow\nwarrow\leadsto\dashleftarrow\dashrightarrow\leftleftarrows\rightrightarrows\leftrightarrows\rightleftarrows\Lleftarrow\\<br>    \Rrightarrow\twoheadleftarrow\twoheadrightarrow\leftarrowtail\rightarrowtail\leftrightharpoons\rightleftharpoons\Lsh\Rsh\looparrowleft\\<br>    \looparrowright\curvearrowleft\curvearrowright\circlearrowleft\circlearrowright\multimap\upuparrows\downdownarrows\upharpoonleft\upharpoonright\\<br>    \downharpoonright\rightsquigarrow\leftrightsquigarrow\xleftarrow[b] a\xrightarrow[b] a\xLeftarrow a\xRightarrow x\xleftrightarrow a\xLeftrightarrow a<br>}<br>$$</p>
<h3 id="定界符"><a href="#定界符" class="headerlink" title="定界符"></a>定界符</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">()<span class="keyword">\uparrow</span><span class="keyword">\lbrack</span><span class="keyword">\rbrack</span><span class="keyword">\downarrow</span><span class="keyword">\lbrace</span><span class="keyword">\rbrace</span><span class="keyword">\updownarrow</span><span class="keyword">\langle</span><span class="keyword">\\</span><span class="keyword">\rangle</span><span class="keyword">\vert</span><span class="keyword">\lfloor</span><span class="keyword">\rfloor</span><span class="keyword">\lceil</span>/<span class="keyword">\backslash</span><span class="keyword">\Updownarrow</span><span class="keyword">\Uparrow</span><span class="keyword">\Downarrow</span><span class="keyword">\\</span><span class="keyword">\Vert</span><span class="keyword">\rceil</span><span class="keyword">\ulcorner</span><span class="keyword">\urcorner</span><span class="keyword">\llcorner</span><span class="keyword">\lrcorner</span><span class="keyword">\lvert</span><span class="keyword">\rvert</span><span class="keyword">\lVert</span><span class="keyword">\rVert</span><span class="keyword">\tbinom</span>&#123;a&#125;&#123;b&#125;<span class="keyword">\left</span>(<span class="keyword">\right</span>)<span class="keyword">\left</span>[<span class="keyword">\right</span>]</span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    ()\uparrow\lbrack\rbrack\downarrow\lbrace\rbrace\updownarrow\langle\\<br>    \rangle\vert\lfloor\rfloor\lceil&#x2F;\backslash\Updownarrow\Uparrow\Downarrow\\<br>    \Vert\rceil\ulcorner\urcorner\llcorner\lrcorner\lvert\rvert\lVert\rVert\tbinom{a}{b}\left(\right)\left[\right]<br>}<br>$$</p>
<h3 id="大定界符"><a href="#大定界符" class="headerlink" title="大定界符"></a>大定界符</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\lgroup</span> a<span class="keyword">\rgroup</span> a<span class="keyword">\lmoustache</span> a<span class="keyword">\rmoustache</span> a</span><br></pre></td></tr></table></figure>

<p>$$<br>\lgroup a\rgroup a\lmoustache a\rmoustache a<br>$$</p>
<h3 id="其他符号"><a href="#其他符号" class="headerlink" title="其他符号"></a>其他符号</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\dots</span><span class="keyword">\cdots</span><span class="keyword">\vdots</span><span class="keyword">\ddots</span><span class="keyword">\hbar</span><span class="keyword">\imath</span><span class="keyword">\jmath</span><span class="keyword">\ell</span><span class="keyword">\Re</span><span class="keyword">\Im</span><span class="keyword">\\</span><span class="keyword">\aleph</span><span class="keyword">\wp</span><span class="keyword">\forall</span><span class="keyword">\exists</span><span class="keyword">\mho</span><span class="keyword">\partial</span>&#x27;<span class="keyword">\prime</span><span class="keyword">\emptyset</span><span class="keyword">\infty</span><span class="keyword">\\</span><span class="keyword">\nabla</span><span class="keyword">\triangle</span><span class="keyword">\Box</span><span class="keyword">\Diamond</span><span class="keyword">\bot</span><span class="keyword">\top</span><span class="keyword">\angle</span><span class="keyword">\surd</span><span class="keyword">\diamondsuit</span><span class="keyword">\heartsuit</span><span class="keyword">\\</span><span class="keyword">\clubsuit</span><span class="keyword">\spadesuit</span><span class="keyword">\neg</span><span class="keyword">\flat</span><span class="keyword">\natural</span><span class="keyword">\sharp</span><span class="keyword">\hbar</span><span class="keyword">\hslash</span><span class="keyword">\Bbbk</span><span class="keyword">\square</span><span class="keyword">\\</span><span class="keyword">\blacksquare</span><span class="keyword">\circledS</span><span class="keyword">\vartriangle</span><span class="keyword">\blacktriangle</span><span class="keyword">\complement</span><span class="keyword">\triangledown</span><span class="keyword">\blacktriangledown</span><span class="keyword">\Game</span><span class="keyword">\lozenge</span><span class="keyword">\blacklozenge</span><span class="keyword">\\</span><span class="keyword">\bigstar</span><span class="keyword">\angle</span><span class="keyword">\measuredangle</span><span class="keyword">\diagup</span><span class="keyword">\diagdown</span><span class="keyword">\backprime</span><span class="keyword">\nexists</span><span class="keyword">\Finv</span><span class="keyword">\varnothing</span><span class="keyword">\eth</span><span class="keyword">\\</span><span class="keyword">\sphericalangle</span><span class="keyword">\mho</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    \dots\cdots\vdots\ddots\hbar\imath\jmath\ell\Re\Im\\<br>    \aleph\wp\forall\exists\mho\partial’\prime\emptyset\infty\\<br>    \nabla\triangle\Box\Diamond\bot\top\angle\surd\diamondsuit\heartsuit\\<br>    \clubsuit\spadesuit\neg\flat\natural\sharp\hbar\hslash\Bbbk\square\\<br>    \blacksquare\circledS\vartriangle\blacktriangle\complement\triangledown\blacktriangledown\Game\lozenge\blacklozenge\\<br>    \bigstar\angle\measuredangle\diagup\diagdown\backprime\nexists\Finv\varnothing\eth\\<br>    \sphericalangle\mho<br>}<br>$$</p>
<h3 id="非数学符号"><a href="#非数学符号" class="headerlink" title="非数学符号"></a>非数学符号</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\dag</span><span class="keyword">\copyright</span><span class="keyword">\ddag</span><span class="keyword">\pounds</span><span class="keyword">\%</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\dag\copyright\ddag\pounds%<br>$$</p>
<h3 id="希腊和希伯来字母"><a href="#希腊和希伯来字母" class="headerlink" title="希腊和希伯来字母"></a>希腊和希伯来字母</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\digamma</span><span class="keyword">\varkappa</span><span class="keyword">\beth</span><span class="keyword">\gimel</span><span class="keyword">\daleth</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\digamma\varkappa\beth\gimel\daleth<br>$$</p>
<h3 id="数字字母"><a href="#数字字母" class="headerlink" title="数字字母"></a>数字字母</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ABCDE abcde 1234<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathrm</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathit</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathnormal</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathcal</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathscr</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathfrak</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathbb</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathbf</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathtt</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathsf</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\text</span>&#123;ABCDE abcde 1234&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\scriptstyle</span><span class="keyword">\text</span>&#123;ABCDE abcde 1234&#125;</span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    ABCDE abcde 1234\\<br>    \mathrm{ABCDE abcde 1234}\\<br>    \mathit{ABCDE abcde 1234}\\<br>    \mathnormal{ABCDE abcde 1234}\\<br>    \mathcal{ABCDE abcde 1234}\\<br>    \mathscr{ABCDE abcde 1234}\\<br>    \mathfrak{ABCDE abcde 1234}\\<br>    \mathbb{ABCDE abcde 1234}\\<br>    \mathbf{ABCDE abcde 1234}\\<br>    \mathtt{ABCDE abcde 1234}\\<br>    \mathsf{ABCDE abcde 1234}\\<br>    \text{ABCDE abcde 1234}\\<br>    \scriptstyle\text{ABCDE abcde 1234}<br>}<br>$$</p>
<h3 id="约去符-删除线"><a href="#约去符-删除线" class="headerlink" title="约去符 删除线"></a>约去符 删除线</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\cancel</span> a<span class="keyword">\bcancel</span> a<span class="keyword">\xcancel</span> a</span><br></pre></td></tr></table></figure>

<p>$$<br>\cancel a\bcancel a\xcancel a<br>$$</p>
<h3 id="矩阵"><a href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;matrix&#125;</span><br><span class="line">    0<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>0<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>0<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;matrix&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;pmatrix&#125;</span><br><span class="line">    0<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>0<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>0<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;pmatrix&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;bmatrix&#125;</span><br><span class="line">    0<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>0<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>0<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;bmatrix&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;Bmatrix&#125;</span><br><span class="line">    0<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>0<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>0<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;Bmatrix&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;vmatrix&#125;</span><br><span class="line">    0<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>0<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>0<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;vmatrix&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;Vmatrix&#125;</span><br><span class="line">    0<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>1<span class="built_in">&amp;</span>0<span class="keyword">\\</span></span><br><span class="line">    1<span class="built_in">&amp;</span>0<span class="built_in">&amp;</span>1<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;Vmatrix&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;array&#125;&#123;c|lcr&#125;</span><br><span class="line">    <span class="keyword">\downarrow</span> <span class="built_in">&amp;</span>a<span class="built_in">&amp;</span>b<span class="built_in">&amp;</span>c<span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\hline</span></span><br><span class="line">    R<span class="built_in">_</span>1<span class="built_in">&amp;</span>c<span class="built_in">&amp;</span>b<span class="built_in">&amp;</span>a<span class="keyword">\\</span></span><br><span class="line">    R<span class="built_in">_</span>2<span class="built_in">&amp;</span>b<span class="built_in">&amp;</span>c<span class="built_in">&amp;</span>c<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;array&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;cases&#125;</span><br><span class="line">    a<span class="built_in">_</span>1x+b<span class="built_in">_</span>1y+c<span class="built_in">_</span>1z=d<span class="built_in">_</span>1<span class="keyword">\\</span></span><br><span class="line">    a<span class="built_in">_</span>2x+b<span class="built_in">_</span>2y+c<span class="built_in">_</span>2z=d<span class="built_in">_</span>2<span class="keyword">\\</span></span><br><span class="line">    a<span class="built_in">_</span>3x+b<span class="built_in">_</span>3y+c<span class="built_in">_</span>3z=d<span class="built_in">_</span>3<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;cases&#125;<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;aligned&#125;</span><br><span class="line">    a<span class="built_in">_</span>1x+b<span class="built_in">_</span>1y+c<span class="built_in">_</span>1z=d<span class="built_in">_</span>1<span class="keyword">\\</span></span><br><span class="line">    a<span class="built_in">_</span>2x+b<span class="built_in">_</span>2y+c<span class="built_in">_</span>2z=d<span class="built_in">_</span>2<span class="keyword">\\</span></span><br><span class="line">    a<span class="built_in">_</span>3x+b<span class="built_in">_</span>3y+c<span class="built_in">_</span>3z=d<span class="built_in">_</span>3<span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;aligned&#125;</span><br></pre></td></tr></table></figure>

<p>$$<br>\displaylines{<br>    \begin{matrix}<br>        0&amp;1&amp;1\\<br>        1&amp;1&amp;0\\<br>        1&amp;0&amp;1\\<br>    \end{matrix}<br>    \begin{pmatrix}<br>        0&amp;1&amp;1\\<br>        1&amp;1&amp;0\\<br>        1&amp;0&amp;1\\<br>    \end{pmatrix}<br>    \begin{bmatrix}<br>        0&amp;1&amp;1\\<br>        1&amp;1&amp;0\\<br>        1&amp;0&amp;1\\<br>    \end{bmatrix}<br>    \begin{Bmatrix}<br>        0&amp;1&amp;1\\<br>        1&amp;1&amp;0\\<br>        1&amp;0&amp;1\\<br>    \end{Bmatrix}\\<br>    \begin{vmatrix}<br>        0&amp;1&amp;1\\<br>        1&amp;1&amp;0\\<br>        1&amp;0&amp;1\\<br>    \end{vmatrix}<br>    \begin{Vmatrix}<br>        0&amp;1&amp;1\\<br>        1&amp;1&amp;0\\<br>        1&amp;0&amp;1\\<br>    \end{Vmatrix}<br>    \begin{array}{c|lcr}<br>        \downarrow &amp;a&amp;b&amp;c\\<br>        \hline<br>        R_1&amp;c&amp;b&amp;a\\<br>        R_2&amp;b&amp;c&amp;c\\<br>    \end{array}<br>    \begin{cases}<br>        a_1x+b_1y+c_1z&#x3D;d_1\\<br>        a_2x+b_2y+c_2z&#x3D;d_2\\<br>        a_3x+b_3y+c_3z&#x3D;d_3\\<br>    \end{cases}\\<br>    \begin{aligned}<br>        a_1x+b_1y+c_1z&#x3D;d_1\\<br>        a_2x+b_2y+c_2z&#x3D;d_2\\<br>        a_3x+b_3y+c_3z&#x3D;d_3\\<br>    \end{aligned}<br>}<br>$$</p>
<h2 id="读入优化"><a href="#读入优化" class="headerlink" title="读入优化"></a>读入优化</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">read</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span> ch=<span class="built_in">getchar</span>(),last=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	<span class="keyword">while</span>((ch&lt;<span class="string">&#x27;0&#x27;</span>)||(ch&gt;<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">		last=ch,</span><br><span class="line">		ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>((ch&gt;=<span class="string">&#x27;0&#x27;</span>)&amp;&amp;(ch&lt;=<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">		ans=(ans&lt;&lt;<span class="number">3</span>)+(ans&lt;&lt;<span class="number">1</span>)+ch-<span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">		ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(last==<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">		ans=-ans;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="Fread"><a href="#Fread" class="headerlink" title="Fread"></a>Fread</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> n=<span class="number">21</span>;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">1</span>&lt;&lt;n],*inf=buf;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> <span class="title">read</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> <span class="type">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span> last=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	<span class="keyword">while</span>((*inf&lt;<span class="string">&#x27;0&#x27;</span>)||(*inf&gt;<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">		last=*inf,</span><br><span class="line">		inf++;</span><br><span class="line">	<span class="keyword">while</span>((*inf&gt;=<span class="string">&#x27;0&#x27;</span>)&amp;&amp;(*inf&lt;=<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">		ans=ans*<span class="number">10</span>+*inf-<span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">		inf++;</span><br><span class="line">	<span class="keyword">if</span>(last==<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">		ans=-ans;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;*.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line"><span class="built_in">fread</span>(buf,<span class="number">1</span>,<span class="number">1</span>&lt;&lt;n,stdin);</span><br></pre></td></tr></table></figure>

<h2 id="pb-ds"><a href="#pb-ds" class="headerlink" title="pb_ds"></a>pb_ds</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br></pre></td></tr></table></figure>

<h3 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/pb_ds/hash_policy.hpp&gt;</span></span></span><br><span class="line">cc_hash_table&lt;string,<span class="type">int</span>&gt;;</span><br><span class="line">gp_hash_table&lt;string,<span class="type">int</span>&gt;;</span><br></pre></td></tr></table></figure>

<h3 id="heap"><a href="#heap" class="headerlink" title="heap"></a>heap</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/pb_ds/priority_queue.hpp&gt;</span></span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>,greater&lt;<span class="type">int</span>&gt;,pairing_heap_tag/binary_heap_tag/binomial_heap_tag/rc_binomial_heap_tag/thin_heap_tag/无&gt;;</span><br><span class="line">	<span class="built_in">push</span>();</span><br><span class="line">	<span class="built_in">top</span>();</span><br><span class="line">	<span class="built_in">size</span>();</span><br><span class="line">	<span class="built_in">empty</span>();</span><br><span class="line">	<span class="built_in">clear</span>();</span><br><span class="line">	<span class="built_in">pop</span>();</span><br><span class="line">	<span class="built_in">join</span>(priority_queue &amp;other);<span class="comment">//合并两个堆,other会被清空</span></span><br><span class="line">	<span class="built_in">split</span>(Pred prd,priority_queue &amp;other);<span class="comment">//分离出两个堆</span></span><br><span class="line">	<span class="built_in">modify</span>(point_iterator it,<span class="type">const</span> key);<span class="comment">//修改一个节点的值</span></span><br></pre></td></tr></table></figure>

<h3 id="rb-tree"><a href="#rb-tree" class="headerlink" title="rb-tree"></a>rb-tree</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/pb_ds/tree_policy.hpp&gt;</span></span></span><br><span class="line">tree&lt;<span class="type">int</span>,null_type/</span><br><span class="line">null_mapped_type,rb_tree_tag/splay_tree_tag,tree_order_statistics_node_update&gt;<span class="comment">//关键字类型 无映射 从小到大排序 红黑树 结点更新</span></span><br><span class="line">	<span class="built_in">insert</span>();</span><br><span class="line">	<span class="built_in">erase</span>();</span><br><span class="line">	<span class="built_in">lower_bound</span>();<span class="comment">//前驱</span></span><br><span class="line">	<span class="built_in">upper_bound</span>();<span class="comment">//后继</span></span><br><span class="line">	<span class="built_in">join</span>(b);<span class="comment">//b并入a 前提是两棵树的key的取值范围不相交</span></span><br><span class="line">	<span class="built_in">split</span>(v,b);<span class="comment">//key 小于等于 v 的元素属于a，其余的属于b</span></span><br><span class="line">	<span class="comment">//需填写tree_order_statistics_node_update </span></span><br><span class="line">	<span class="built_in">order_of_key</span>();<span class="comment">//求k在树中是第几大</span></span><br><span class="line">	<span class="built_in">find_by_order</span>();<span class="comment">//求树中的第k大</span></span><br></pre></td></tr></table></figure>

<h3 id="trie"><a href="#trie" class="headerlink" title="trie"></a>trie</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/pb_ds/trie_policy.hpp&gt;</span></span></span><br><span class="line">trie&lt;string,null_type,trie_string_access_traits&lt;&gt;,pat_trie_tag,trie_prefix_search_node_update&gt;;</span><br><span class="line">	<span class="built_in">insert</span>();</span><br><span class="line">	<span class="built_in">erase</span>();</span><br><span class="line">	<span class="built_in">join</span>(trie&amp; b);</span><br></pre></td></tr></table></figure>

<h3 id="pair"><a href="#pair" class="headerlink" title="pair"></a>pair</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;::iterator,::iterator&gt;range=.<span class="built_in">prefix_range</span>(.<span class="built_in">length</span>());</span><br><span class="line"><span class="keyword">for</span>(::iterator it=range.first;it!=range.second;it++)</span><br><span class="line">	cout&lt;&lt;*it&lt;&lt;endl;</span><br></pre></td></tr></table></figure>

<h2 id="位运算"><a href="#位运算" class="headerlink" title="位运算"></a>位运算</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">abs</span><span class="params">(<span class="type">const</span> <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n^(n&gt;&gt;<span class="number">31</span>))-(n&gt;&gt;<span class="number">31</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">max</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b&amp;((a-b)&gt;&gt;<span class="number">31</span>)|a&amp;(~(a-b)&gt;&gt;<span class="number">31</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">min</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a&amp;((a-b)&gt;&gt;<span class="number">31</span>)|b&amp;(~(a-b)&gt;&gt;<span class="number">31</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">ave</span><span class="params">(<span class="type">const</span> <span class="type">int</span> x,<span class="type">const</span> <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (x&amp;y)+((x^y&gt;&gt;<span class="number">1</span>));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="模拟退火"><a href="#模拟退火" class="headerlink" title="模拟退火"></a>模拟退火</h2><p>$$<br>\begin{aligned}<br>    \Delta E&#x3D;&amp;E_{t+1}-E_t\geq 0\<br>    P(\Delta E)&#x3D;&amp;<br>    \begin{cases}<br>        1&amp;:E_{t+1}&lt;E_t\<br>        e^{\frac{-\Delta E}{T}}&amp;:E_{t+1}\geq E_t<br>    \end{cases}<br>\end{aligned}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> T0=<span class="number">3000</span>,Tk=<span class="number">1e-13</span>,D=<span class="number">0.996</span>,lim=<span class="number">0.85</span>;</span><br><span class="line"><span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sa</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	t=T0,</span><br><span class="line">	ansx=tmpx,</span><br><span class="line">	ansy=tmpy;</span><br><span class="line">	<span class="keyword">while</span>(t&gt;=Tk)&#123;</span><br><span class="line">		dx=tmpx+((<span class="built_in">rand</span>()*<span class="number">2</span>)-RAND_MAX)*t,</span><br><span class="line">		dy=tmpy+((<span class="built_in">rand</span>()*<span class="number">2</span>)-RAND_MAX)*t,</span><br><span class="line">		dw=<span class="built_in">calc</span>(dx,dy),</span><br><span class="line">		d=dw-answ;</span><br><span class="line">		<span class="keyword">if</span>(d&gt;<span class="number">0</span>)</span><br><span class="line">			tmpx=ansx=dx,</span><br><span class="line">			tmpy=ansy=dy,</span><br><span class="line">			answ=dw;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">exp</span>(d/t)*(<span class="type">double</span>)RAND_MAX&gt;(<span class="type">double</span>)<span class="built_in">rand</span>())</span><br><span class="line">				ansx=dx,</span><br><span class="line">				ansy=dy;</span><br><span class="line">		t*=D;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="卡时"><a href="#卡时" class="headerlink" title="卡时"></a>卡时</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> lim=<span class="number">0.95</span>;</span><br><span class="line"><span class="type">time_t</span> begin,end;</span><br><span class="line">begin=<span class="built_in">clock</span>();</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">	end=<span class="built_in">clock</span>();</span><br><span class="line">	<span class="keyword">if</span>((<span class="type">double</span>)(end-begin)/CLOCKS_PER_SEC&gt;=lim)</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="built_in">sa</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><table>
<thead>
<tr>
<th align="left">时间复杂度</th>
<th align="left">$1s$内稳过的数据范围</th>
<th align="left">$1s$内的极限范围（不保险）</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="left">$O(1)$</td>
<td align="left">$\infty$</td>
<td align="left">$\infty$</td>
<td align="left">数学、贪心</td>
</tr>
<tr>
<td align="left">$O(\log n)$</td>
<td align="left">$\infty$</td>
<td align="left">$\infty$</td>
<td align="left">矩阵乘法</td>
</tr>
<tr>
<td align="left">$O(n)$</td>
<td align="left">$\leq 5\times 10^7$</td>
<td align="left">$\leq 10^8$</td>
<td align="left">数学、贪心</td>
</tr>
<tr>
<td align="left">$O(n\log n)$</td>
<td align="left">$\leq 5\times 10^5$</td>
<td align="left">$\leq 10^6$</td>
<td align="left">二分答案、二分查找、快速排序、归并算法</td>
</tr>
<tr>
<td align="left">$O(n\log^2n)$</td>
<td align="left">$\leq 10^5$</td>
<td align="left">$\leq 3\times 10^5$</td>
<td align="left">三分</td>
</tr>
<tr>
<td align="left">$O(n\sqrt n\log n)$</td>
<td align="left">$\leq 6\times 10^4$</td>
<td align="left">$\leq 10^5$</td>
<td align="left">莫队</td>
</tr>
<tr>
<td align="left">$O(n\sqrt n)$</td>
<td align="left">$\leq 10^4$</td>
<td align="left">$\leq 6\times 10^4$</td>
<td align="left">莫队、根号算法的筛</td>
</tr>
<tr>
<td align="left">$O(n^2)$</td>
<td align="left">$\leq 5\times 10^3$</td>
<td align="left">$\leq 10^4$</td>
<td align="left">动态规划、图论</td>
</tr>
<tr>
<td align="left">$O(n^2\log\log n)$</td>
<td align="left">$\leq 5\times 10^2$</td>
<td align="left">$\leq 10^4$</td>
<td align="left">二分套二分、三分、树链剖分、LCT</td>
</tr>
<tr>
<td align="left">$O(n^3)$</td>
<td align="left">$\leq 3\times 10^2$</td>
<td align="left">$\leq 5\times 10^2$</td>
<td align="left">搜索、Floyd</td>
</tr>
<tr>
<td align="left">$O(n^4)$</td>
<td align="left">$\leq 50$</td>
<td align="left">$\leq 150$</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">$O(2^n)$</td>
<td align="left">$\leq 25$</td>
<td align="left">$\leq 27$</td>
<td align="left">状态压缩DP、搜索</td>
</tr>
<tr>
<td align="left">$O(n!)$</td>
<td align="left">$\leq 11$</td>
<td align="left">$\leq 11$（稳过）</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">$O(n^n)$</td>
<td align="left">$\leq 8$</td>
<td align="left">$\leq 8$（稳过）</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">$O(\infty)$</td>
<td align="left">N&#x2F;A</td>
<td align="left">N&#x2F;A</td>
<td align="left">猴子排序</td>
</tr>
</tbody></table>
<p>一般情况下，$256M$内存的话，int数组最多可以开到$6\times 10^7$，$1s$可以跑$10^8$次，一般常数下$5\times 10^7$左右。</p>
<h2 id="对拍"><a href="#对拍" class="headerlink" title="对拍"></a>对拍</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">color 0A</span><br><span class="line">set i=0</span><br><span class="line">:loop</span><br><span class="line">	set /a i=%i%+1</span><br><span class="line">	cls</span><br><span class="line">	echo Test #%i%:</span><br><span class="line">	rand.exe</span><br><span class="line">	b.exe</span><br><span class="line">	a.exe</span><br><span class="line">	fc res1.out res2.out</span><br><span class="line">	if not errorlevel 1 goto loop</span><br><span class="line">	color 0C &amp; pause</span><br></pre></td></tr></table></figure>

<h3 id="rand"><a href="#rand" class="headerlink" title="rand"></a>rand</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">rnd</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (<span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>)|<span class="built_in">rand</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="shuffle"><a href="#shuffle" class="headerlink" title="shuffle"></a>shuffle</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="built_in">shuffle</span>(a+<span class="number">1</span>,a+n+<span class="number">1</span>,<span class="built_in">default_random_engine</span>(chrono::system_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>()));</span><br></pre></td></tr></table></figure>

<h2 id="int128"><a href="#int128" class="headerlink" title="__int128"></a>__int128</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int128 <span class="title">read</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">	__int128 tans=<span class="number">0</span>;</span><br><span class="line">	<span class="type">char</span> ch=<span class="built_in">getchar</span>(),last=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	<span class="keyword">while</span>((ch&lt;<span class="string">&#x27;0&#x27;</span>)||(ch&gt;<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">		ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>((ch&gt;=<span class="string">&#x27;0&#x27;</span>)&amp;&amp;(ch&lt;=<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">		tans=tans*<span class="number">10</span>+ch-<span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">		ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(last==<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">    	tans=-tans;</span><br><span class="line">	<span class="keyword">return</span> tans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(__int128 k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(k&lt;<span class="number">0</span>)&#123;</span><br><span class="line">    	<span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">        k=-k;</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="keyword">if</span>(k&gt;<span class="number">9</span>)</span><br><span class="line">		<span class="built_in">print</span>(k/<span class="number">10</span>);</span><br><span class="line">	<span class="built_in">putchar</span>(k%<span class="number">10</span>+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">void</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="priority-queue"><a href="#priority-queue" class="headerlink" title="priority_queue"></a>priority_queue</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;<span class="type">int</span>&gt;<span class="comment">//大根堆 </span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;,greater&lt;<span class="type">int</span>&gt; &gt;q;<span class="comment">//小根堆</span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;,less&lt;<span class="type">int</span>&gt; &gt;q;<span class="comment">//大根堆 </span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="type">int</span> x;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="title">data</span><span class="params">(<span class="type">int</span> a)</span></span>&#123;</span><br><span class="line">		x=a;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">inline</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> data &amp;a)<span class="type">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> x&lt;a.x;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;data&gt;q;<span class="comment">//大根堆</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">data</span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> <span class="type">int</span> a,<span class="type">const</span> <span class="type">int</span> b)</span><span class="type">const</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> a&lt;b;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;,data&gt;q;<span class="comment">//大根堆 </span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://monoceros406.github.io">Monoceros406</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://monoceros406.github.io/2023/10/15/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/">https://monoceros406.github.io/2023/10/15/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://monoceros406.github.io" target="_blank">The Blog of Monoceros406</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/15/MySQL%E7%AC%94%E8%AE%B0/" title="MySQL笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL笔记</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/15/LaTeX%E7%AC%94%E8%AE%B0/" title="LaTeX笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">LaTeX笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/12/02/LeetCode%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" title="LeetCode快速入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-02</div><div class="title">LeetCode快速入门</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Monoceros406</div><div class="author-info__description">Windows系统安全爱好者</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">326</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">30</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Monoceros406"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Monoceros406" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:monoceros406@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://monoceros406.github.io/atom.xml" target="_blank" title=""><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">哪里排版出锅了请告诉我QwQ  QQ:1295625063</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">算法竞赛笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="toc-number">1.1.</span> <span class="toc-text">快速幂</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BE%9F%E9%80%9F%E4%B9%98"><span class="toc-number">1.2.</span> <span class="toc-text">龟速乘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F"><span class="toc-number">1.3.</span> <span class="toc-text">快速排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%AE%E5%88%86"><span class="toc-number">1.4.</span> <span class="toc-text">差分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%BB%E6%95%A3%E5%8C%96"><span class="toc-number">1.5.</span> <span class="toc-text">离散化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BC%80%E5%92%8C"><span class="toc-number">1.6.</span> <span class="toc-text">前缀和</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%B2%BE%E5%BA%A6"><span class="toc-number">1.7.</span> <span class="toc-text">高精度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%AB%E9%98%9F%E7%AE%97%E6%B3%95"><span class="toc-number">1.8.</span> <span class="toc-text">莫队算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%9D%97"><span class="toc-number">1.9.</span> <span class="toc-text">分块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%BA%E5%8F%96%E6%B3%95"><span class="toc-number">1.10.</span> <span class="toc-text">尺取法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E9%95%BF%E5%AD%90%E5%8C%BA%E9%97%B4%E5%92%8C"><span class="toc-number">1.10.1.</span> <span class="toc-text">最长子区间和</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E5%88%86%E6%B3%95"><span class="toc-number">1.11.</span> <span class="toc-text">三分法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%B3%B0%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC"><span class="toc-number">1.11.1.</span> <span class="toc-text">单峰函数极值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%85%AC%E5%9B%A0%E6%95%B0-%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0"><span class="toc-number">1.12.</span> <span class="toc-text">最大公因数+最小公倍数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E7%90%86"><span class="toc-number">1.12.1.</span> <span class="toc-text">定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%9D%E7%AB%A0%E7%AE%97%E6%9C%AF%C2%B7%E6%9B%B4%E7%9B%B8%E5%87%8F%E6%8D%9F%E6%9C%AF"><span class="toc-number">1.12.2.</span> <span class="toc-text">九章算术·更相减损术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="toc-number">1.12.3.</span> <span class="toc-text">欧几里得算法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lucas%E5%AE%9A%E7%90%86"><span class="toc-number">1.13.</span> <span class="toc-text">Lucas定理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="toc-number">1.14.</span> <span class="toc-text">中国剩余定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B"><span class="toc-number">1.14.1.</span> <span class="toc-text">算法流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A0%E6%95%B0%E7%AD%9B"><span class="toc-number">1.15.</span> <span class="toc-text">素数筛</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Eratosthenes%E7%AD%9B%E6%B3%95"><span class="toc-number">1.15.1.</span> <span class="toc-text">Eratosthenes筛法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E7%AD%9B"><span class="toc-number">1.15.2.</span> <span class="toc-text">线性筛</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83"><span class="toc-number">1.16.</span> <span class="toc-text">乘法逆元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%B1%82%E9%80%86%E5%85%83"><span class="toc-number">1.16.1.</span> <span class="toc-text">扩展欧几里得求逆元</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E6%B1%82%E9%80%86%E5%85%83"><span class="toc-number">1.16.2.</span> <span class="toc-text">线性求逆元</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82%E6%B1%82%E9%80%86%E5%85%83"><span class="toc-number">1.16.3.</span> <span class="toc-text">快速幂求逆元</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E6%96%AF-%E7%BA%A6%E6%97%A6%E6%B6%88%E5%85%83%E6%B3%95"><span class="toc-number">1.17.</span> <span class="toc-text">高斯-约旦消元法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bezout%E5%AE%9A%E7%90%86"><span class="toc-number">1.18.</span> <span class="toc-text">Bézout定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E5%B9%BF"><span class="toc-number">1.18.1.</span> <span class="toc-text">推广</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="toc-number">1.19.</span> <span class="toc-text">线性同余方程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E7%90%86-1"><span class="toc-number">1.19.1.</span> <span class="toc-text">定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E6%95%B4%E6%95%B0%E8%A7%A3%EF%BC%9A"><span class="toc-number">1.19.2.</span> <span class="toc-text">最小整数解：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E4%BD%99%E5%9F%BA%E6%9C%AC%E6%80%A7%E8%B4%A8"><span class="toc-number">1.19.3.</span> <span class="toc-text">同余基本性质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%85%83%E4%B8%80%E6%AC%A1%E4%B8%8D%E5%AE%9A%E6%96%B9%E7%A8%8B"><span class="toc-number">1.20.</span> <span class="toc-text">二元一次不定方程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95"><span class="toc-number">1.21.</span> <span class="toc-text">矩阵乘法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E9%80%9F%E9%80%92%E6%8E%A8"><span class="toc-number">1.21.1.</span> <span class="toc-text">加速递推</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%9A%E5%BC%88%E8%AE%BA-SG%E5%87%BD%E6%95%B0"><span class="toc-number">1.22.</span> <span class="toc-text">博弈论+SG函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-number">1.22.1.</span> <span class="toc-text">定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E5%B9%B3%E7%BB%84%E5%90%88%E6%B8%B8%E6%88%8FICG"><span class="toc-number">1.22.1.1.</span> <span class="toc-text">公平组合游戏ICG</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E5%90%91%E5%9B%BE%E6%B8%B8%E6%88%8F"><span class="toc-number">1.22.1.2.</span> <span class="toc-text">有向图游戏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mex%E8%BF%90%E7%AE%97"><span class="toc-number">1.22.1.3.</span> <span class="toc-text">Mex运算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SG%E5%87%BD%E6%95%B0"><span class="toc-number">1.22.1.4.</span> <span class="toc-text">SG函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E5%90%91%E5%9B%BE%E6%B8%B8%E6%88%8F%E7%9A%84%E5%92%8C"><span class="toc-number">1.22.1.5.</span> <span class="toc-text">有向图游戏的和</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E7%90%86-2"><span class="toc-number">1.22.1.6.</span> <span class="toc-text">定理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NIM%E5%8D%9A%E5%BC%88"><span class="toc-number">1.22.2.</span> <span class="toc-text">NIM博弈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A8%81%E4%BD%90%E5%A4%AB%E5%8D%9A%E5%BC%88"><span class="toc-number">1.22.3.</span> <span class="toc-text">威佐夫博弈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B4%E4%BB%80%E5%8D%9A%E5%A5%95"><span class="toc-number">1.22.4.</span> <span class="toc-text">巴什博奕</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%8D%9A%E5%BC%88"><span class="toc-number">1.22.5.</span> <span class="toc-text">斐波那契博弈</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF%E5%9F%BA%E6%9C%AC%E5%AE%9A%E7%90%86"><span class="toc-number">1.23.</span> <span class="toc-text">算术基本定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E8%AE%BA"><span class="toc-number">1.23.1.</span> <span class="toc-text">推论</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E6%95%B0"><span class="toc-number">1.24.</span> <span class="toc-text">因数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E9%99%A4%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="toc-number">1.24.1.</span> <span class="toc-text">整除的性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%95%E9%99%A4%E6%B3%95"><span class="toc-number">1.24.2.</span> <span class="toc-text">试除法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%A8%E5%9B%A0%E6%95%B0%E5%88%86%E8%A7%A3"><span class="toc-number">1.24.2.1.</span> <span class="toc-text">质因数分解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E7%BA%A6%E6%95%B0%E9%9B%86%E5%90%88"><span class="toc-number">1.24.2.2.</span> <span class="toc-text">正约数集合</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%80%8D%E6%95%B0%E6%B3%95"><span class="toc-number">1.24.3.</span> <span class="toc-text">倍数法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E8%AE%BA-1"><span class="toc-number">1.24.4.</span> <span class="toc-text">推论</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-number">1.25.</span> <span class="toc-text">欧拉函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E7%AD%9B"><span class="toc-number">1.25.1.</span> <span class="toc-text">欧拉筛</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8"><span class="toc-number">1.25.2.</span> <span class="toc-text">性质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86"><span class="toc-number">1.26.</span> <span class="toc-text">欧拉定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86"><span class="toc-number">1.26.1.</span> <span class="toc-text">费马小定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E8%AE%BA-2"><span class="toc-number">1.26.2.</span> <span class="toc-text">推论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8C%E4%BD%99%E7%B1%BB%E4%B8%8E%E5%89%A9%E4%BD%99%E7%B3%BB"><span class="toc-number">1.26.3.</span> <span class="toc-text">同余类与剩余系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%88%97%E7%BB%84%E5%90%88"><span class="toc-number">1.27.</span> <span class="toc-text">排列组合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%95%B0%E6%80%A7%E8%B4%A8"><span class="toc-number">1.27.1.</span> <span class="toc-text">组合数性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A8%E8%BE%89%E6%81%92%E7%AD%89%E5%BC%8F"><span class="toc-number">1.27.2.</span> <span class="toc-text">杨辉恒等式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86"><span class="toc-number">1.27.3.</span> <span class="toc-text">二项式定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E9%9B%86"><span class="toc-number">1.27.4.</span> <span class="toc-text">多重集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%86%E6%8E%92%E5%88%97"><span class="toc-number">1.27.5.</span> <span class="toc-text">圆排列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E6%8E%92%E9%97%AE%E9%A2%98"><span class="toc-number">1.27.6.</span> <span class="toc-text">错排问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Catalan%E6%95%B0%E5%88%97"><span class="toc-number">1.27.7.</span> <span class="toc-text">Catalan数列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A8%E8%AE%BA-3"><span class="toc-number">1.27.7.1.</span> <span class="toc-text">推论</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E5%9B%9B%E5%B9%B3%E6%96%B9%E5%92%8C%E5%AE%9A%E7%90%86"><span class="toc-number">1.27.8.</span> <span class="toc-text">拉格朗日四平方和定理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86"><span class="toc-number">1.28.</span> <span class="toc-text">容斥原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E6%9D%83%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.28.1.</span> <span class="toc-text">加权形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mobius%E5%87%BD%E6%95%B0"><span class="toc-number">1.28.2.</span> <span class="toc-text">Mŏbíus函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jordan%E7%AD%9B%E6%B3%95%E5%85%AC%E5%BC%8F"><span class="toc-number">1.28.3.</span> <span class="toc-text">Jordan筛法公式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sylvester%E5%85%AC%E5%BC%8F"><span class="toc-number">1.28.4.</span> <span class="toc-text">Sylvester公式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%B7%E6%89%98%E5%B1%95%E5%BC%80"><span class="toc-number">1.29.</span> <span class="toc-text">康托展开</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%86%E5%BA%B7%E6%89%98%E5%B1%95%E5%BC%80"><span class="toc-number">1.29.1.</span> <span class="toc-text">逆康托展开</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prufer%E5%BA%8F%E5%88%97"><span class="toc-number">1.30.</span> <span class="toc-text">Prüfer序列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%A0%91%E5%BB%BA%E7%AB%8BPrufer%E5%BA%8F%E5%88%97"><span class="toc-number">1.30.1.</span> <span class="toc-text">对树建立Prüfer序列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E6%9E%84%E9%80%A0"><span class="toc-number">1.30.1.1.</span> <span class="toc-text">线性构造</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8Prufer%E5%BA%8F%E5%88%97%E9%87%8D%E5%BB%BA%E6%A0%91"><span class="toc-number">1.30.2.</span> <span class="toc-text">用Prüfer序列重建树</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E9%87%8D%E5%BB%BA"><span class="toc-number">1.30.2.1.</span> <span class="toc-text">线性重建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-1"><span class="toc-number">1.30.3.</span> <span class="toc-text">性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E8%BF%9E%E9%80%9A%E6%96%B9%E6%A1%88%E6%95%B0"><span class="toc-number">1.30.4.</span> <span class="toc-text">图连通方案数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cayley%E5%85%AC%E5%BC%8F"><span class="toc-number">1.30.5.</span> <span class="toc-text">Cayley公式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E7%A9%BA%E9%97%B4"><span class="toc-number">1.31.</span> <span class="toc-text">线性空间</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%9F%BA"><span class="toc-number">1.31.1.</span> <span class="toc-text">线性基</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-2"><span class="toc-number">1.31.1.1.</span> <span class="toc-text">性质</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0"><span class="toc-number">1.31.1.2.</span> <span class="toc-text">构造</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%BC%82%E6%88%96%E6%9C%80%E5%A4%A7%E5%80%BC"><span class="toc-number">1.31.1.3.</span> <span class="toc-text">查询异或最大值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E5%8F%AF%E5%BC%82%E6%88%96%E5%87%BA%E7%9A%84%E6%95%B0%E7%9A%84%E4%B8%AA%E6%95%B0"><span class="toc-number">1.31.1.4.</span> <span class="toc-text">求可异或出的数的个数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="toc-number">1.32.</span> <span class="toc-text">不等式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%87%E5%80%BC%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="toc-number">1.32.1.</span> <span class="toc-text">均值不等式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cauchy%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="toc-number">1.32.2.</span> <span class="toc-text">Cauchy不等式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%96%E7%AD%89%E6%9D%A1%E4%BB%B6%EF%BC%9A"><span class="toc-number">1.32.2.1.</span> <span class="toc-text">取等条件：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A8%E8%AE%BA-4"><span class="toc-number">1.32.2.2.</span> <span class="toc-text">推论</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%88%97%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="toc-number">1.32.3.</span> <span class="toc-text">排列不等式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%92%8C%E5%BC%8F"><span class="toc-number">1.33.</span> <span class="toc-text">和式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%92%8C%E5%BC%8F%E5%A4%84%E7%90%86"><span class="toc-number">1.33.1.</span> <span class="toc-text">和式处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%B0%E5%8A%A8%E6%B3%95"><span class="toc-number">1.33.2.</span> <span class="toc-text">扰动法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%B1%82%E5%92%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.33.3.</span> <span class="toc-text">交换求和顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E8%A7%92%E6%B1%82%E5%92%8C"><span class="toc-number">1.33.4.</span> <span class="toc-text">三角求和</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%A2%E5%85%83"><span class="toc-number">1.33.5.</span> <span class="toc-text">换元</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E9%99%8D%E5%B9%82"><span class="toc-number">1.33.6.</span> <span class="toc-text">下降幂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E9%A1%B9%E5%BC%8F%E7%B3%BB%E6%95%B0"><span class="toc-number">1.33.7.</span> <span class="toc-text">二项式系数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0"><span class="toc-number">1.34.</span> <span class="toc-text">生成函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%A2%E5%BC%8F%E5%B9%82%E7%BA%A7%E6%95%B0"><span class="toc-number">1.34.1.</span> <span class="toc-text">形式幂级数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E5%AF%BC"><span class="toc-number">1.34.2.</span> <span class="toc-text">求导</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E5%87%BD%E6%95%B0%E6%B1%82%E5%AF%BC"><span class="toc-number">1.34.3.</span> <span class="toc-text">复杂函数求导</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E4%BB%A3%E7%AE%97%E5%AD%90"><span class="toc-number">1.34.4.</span> <span class="toc-text">替代算子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%B9%82%E7%BA%A7%E6%95%B0"><span class="toc-number">1.34.5.</span> <span class="toc-text">常见幂级数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E5%B7%AE%E5%88%86"><span class="toc-number">1.35.</span> <span class="toc-text">高阶差分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-1%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92"><span class="toc-number">1.36.</span> <span class="toc-text">0&#x2F;1分数规划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E6%B3%95"><span class="toc-number">1.36.1.</span> <span class="toc-text">二分法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E6%95%B0"><span class="toc-number">1.37.</span> <span class="toc-text">导数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E5%88%99%E8%BF%90%E7%AE%97"><span class="toc-number">1.37.1.</span> <span class="toc-text">四则运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%9B%E9%A1%BF-%E8%8E%B1%E5%B8%83%E5%B0%BC%E8%8C%A8%E5%85%AC%E5%BC%8F"><span class="toc-number">1.37.2.</span> <span class="toc-text">牛顿-莱布尼茨公式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#l%E2%80%99Hopital%E2%80%99s%E6%B3%95%E5%88%99"><span class="toc-number">1.37.3.</span> <span class="toc-text">l’Hôpital’s法则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97"><span class="toc-number">1.38.</span> <span class="toc-text">斐波那契数列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%A2%E5%8D%A1%E6%96%AF%E6%95%B0%E5%88%97"><span class="toc-number">1.38.1.</span> <span class="toc-text">卢卡斯数列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E9%A1%B9%E5%85%AC%E5%BC%8F"><span class="toc-number">1.38.2.</span> <span class="toc-text">通项公式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.38.3.</span> <span class="toc-text">矩阵形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%80%8D%E5%A2%9E%E6%B3%95"><span class="toc-number">1.38.4.</span> <span class="toc-text">快速倍增法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-3"><span class="toc-number">1.38.5.</span> <span class="toc-text">性质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%88%97"><span class="toc-number">1.39.</span> <span class="toc-text">数列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%89%E5%B7%AE%E6%95%B0%E5%88%97%EF%BC%88A-P-%EF%BC%89"><span class="toc-number">1.39.1.</span> <span class="toc-text">等差数列（A.P.）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E9%A1%B9%E5%85%AC%E5%BC%8F-1"><span class="toc-number">1.39.1.1.</span> <span class="toc-text">通项公式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%B7%AE%E4%B8%AD%E9%A1%B9"><span class="toc-number">1.39.1.2.</span> <span class="toc-text">等差中项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D-n-%E9%A1%B9%E5%92%8C"><span class="toc-number">1.39.1.3.</span> <span class="toc-text">前$n$项和</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-4"><span class="toc-number">1.39.1.4.</span> <span class="toc-text">性质</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%89%E6%AF%94%E6%95%B0%E5%88%97%EF%BC%88G-P-%EF%BC%89"><span class="toc-number">1.39.2.</span> <span class="toc-text">等比数列（G.P.）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E6%AF%94%E4%B8%AD%E9%A1%B9"><span class="toc-number">1.39.2.1.</span> <span class="toc-text">等比中项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E9%A1%B9%E5%85%AC%E5%BC%8F-2"><span class="toc-number">1.39.2.2.</span> <span class="toc-text">通项公式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D-n-%E9%A1%B9%E5%92%8C-1"><span class="toc-number">1.39.2.3.</span> <span class="toc-text">前$n$项和</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-5"><span class="toc-number">1.39.2.4.</span> <span class="toc-text">性质</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E7%8E%87%E4%B8%8E%E6%95%B0%E5%AD%A6%E6%9C%9F%E6%9C%9B"><span class="toc-number">1.40.</span> <span class="toc-text">概率与数学期望</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="toc-number">1.40.1.</span> <span class="toc-text">定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-6"><span class="toc-number">1.40.1.1.</span> <span class="toc-text">性质</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AE%9A%E4%B9%89"><span class="toc-number">1.40.1.2.</span> <span class="toc-text">古典定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E5%AE%9A%E4%B9%89"><span class="toc-number">1.40.1.3.</span> <span class="toc-text">统计定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E7%90%86%E5%8C%96%E5%AE%9A%E4%B9%89"><span class="toc-number">1.40.1.4.</span> <span class="toc-text">公理化定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97"><span class="toc-number">1.40.1.5.</span> <span class="toc-text">计算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8B%AC%E7%AB%8B%E6%80%A7"><span class="toc-number">1.40.2.</span> <span class="toc-text">独立性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%8B%AC%E7%AB%8B%E6%80%A7"><span class="toc-number">1.40.2.1.</span> <span class="toc-text">随机事件的独立性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%8F%98%E9%87%8F%E7%9A%84%E7%8B%AC%E7%AB%8B%E6%80%A7"><span class="toc-number">1.40.2.2.</span> <span class="toc-text">随机变量的独立性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="toc-number">1.40.3.</span> <span class="toc-text">事件的计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%96%E6%A8%A1%E8%BF%90%E7%AE%97"><span class="toc-number">1.41.</span> <span class="toc-text">取模运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%A7%E8%B4%A8"><span class="toc-number">1.41.1.</span> <span class="toc-text">基本性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E6%B3%95%E5%88%99"><span class="toc-number">1.41.2.</span> <span class="toc-text">运算法则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%E5%AE%9A%E7%90%86"><span class="toc-number">1.41.3.</span> <span class="toc-text">重要定理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%A6%E4%B9%9D%E9%9F%B6%E7%AE%97%E6%B3%95"><span class="toc-number">1.42.</span> <span class="toc-text">秦九韶算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%81%8F%E5%AF%BC%E6%95%B0"><span class="toc-number">1.43.</span> <span class="toc-text">偏导数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E5%81%8F%E5%AF%BC%E6%95%B0"><span class="toc-number">1.43.1.</span> <span class="toc-text">高阶偏导数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%AF%E5%81%8F%E5%AF%BC"><span class="toc-number">1.43.1.1.</span> <span class="toc-text">纯偏导</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E5%81%8F%E5%AF%BC"><span class="toc-number">1.43.1.2.</span> <span class="toc-text">混合偏导</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lagrange%E4%B9%98%E6%95%B0%E6%B3%95"><span class="toc-number">1.44.</span> <span class="toc-text">Lagrange乘数法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E5%85%83%E5%87%BD%E6%95%B0%E6%9E%81%E5%80%BC"><span class="toc-number">1.44.1.</span> <span class="toc-text">多元函数极值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Lagrange%E4%B9%98%E6%95%B0%E6%B3%95-1"><span class="toc-number">1.44.2.</span> <span class="toc-text">Lagrange乘数法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%AF%E5%88%86"><span class="toc-number">1.45.</span> <span class="toc-text">积分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%B7%E4%BC%A6%E5%85%AC%E5%BC%8F"><span class="toc-number">1.46.</span> <span class="toc-text">海伦公式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A9%86%E7%BD%97%E6%91%A9%E7%AC%88%E5%A4%9A%E5%85%AC%E5%BC%8F"><span class="toc-number">1.46.1.</span> <span class="toc-text">婆罗摩笈多公式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Floyd"><span class="toc-number">1.47.</span> <span class="toc-text">Floyd</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E7%8E%AF"><span class="toc-number">1.47.1.</span> <span class="toc-text">最小环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E7%BB%A7%E7%82%B9%E8%AE%A1%E6%95%B0"><span class="toc-number">1.47.2.</span> <span class="toc-text">中继点计数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kruskal"><span class="toc-number">1.48.</span> <span class="toc-text">Kruskal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dijkstra"><span class="toc-number">1.49.</span> <span class="toc-text">Dijkstra</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%BB%E6%8E%A5%E7%9F%A9%E9%98%B5"><span class="toc-number">1.49.1.</span> <span class="toc-text">邻接矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF%E8%AE%A1%E6%95%B0"><span class="toc-number">1.49.2.</span> <span class="toc-text">最短路计数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E8%BE%93%E5%87%BA"><span class="toc-number">1.49.3.</span> <span class="toc-text">路径输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A1%E7%9F%AD%E8%B7%AF%E5%BE%84"><span class="toc-number">1.49.4.</span> <span class="toc-text">次短路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prim"><span class="toc-number">1.50.</span> <span class="toc-text">Prim</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E4%BC%98%E5%8C%96"><span class="toc-number">1.50.1.</span> <span class="toc-text">堆优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SPFA"><span class="toc-number">1.51.</span> <span class="toc-text">SPFA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E8%B4%9F%E7%8E%AF"><span class="toc-number">1.51.1.</span> <span class="toc-text">判负环</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SLF%E4%BC%98%E5%8C%96"><span class="toc-number">1.52.</span> <span class="toc-text">SLF优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LLL%E4%BC%98%E5%8C%96"><span class="toc-number">1.53.</span> <span class="toc-text">LLL优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kosaraju"><span class="toc-number">1.54.</span> <span class="toc-text">Kosaraju</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tarjan"><span class="toc-number">1.55.</span> <span class="toc-text">Tarjan</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%90%91%E5%9B%BE%E5%89%B2%E8%BE%B9"><span class="toc-number">1.55.1.</span> <span class="toc-text">无向图割边</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%B2%E8%BE%B9%E5%88%A4%E5%AE%9A%E5%AE%9A%E7%90%86"><span class="toc-number">1.55.1.1.</span> <span class="toc-text">割边判定定理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%90%91%E5%9B%BE%E5%89%B2%E7%82%B9"><span class="toc-number">1.55.2.</span> <span class="toc-text">无向图割点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%B2%E7%82%B9%E5%88%A4%E5%AE%9A%E6%B3%95%E5%88%99"><span class="toc-number">1.55.2.1.</span> <span class="toc-text">割点判定法则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LCA"><span class="toc-number">1.55.3.</span> <span class="toc-text">LCA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Johnson"><span class="toc-number">1.56.</span> <span class="toc-text">Johnson</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%B1%82%E5%9B%BE"><span class="toc-number">1.57.</span> <span class="toc-text">分层图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%AE%E5%88%86%E7%BA%A6%E6%9D%9F%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.58.</span> <span class="toc-text">差分约束系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SPFA%E6%9C%80%E9%95%BF%E8%B7%AF%E5%BE%84"><span class="toc-number">1.58.1.</span> <span class="toc-text">SPFA最长路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84"><span class="toc-number">1.59.</span> <span class="toc-text">树的直径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E5%90%91%E5%9B%BE%E5%8F%8C%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F"><span class="toc-number">1.60.</span> <span class="toc-text">无向图双连通分量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E7%90%86-3"><span class="toc-number">1.60.0.1.</span> <span class="toc-text">定理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e-DCC"><span class="toc-number">1.60.1.</span> <span class="toc-text">e-DCC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-DCC"><span class="toc-number">1.60.2.</span> <span class="toc-text">v-DCC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%A9%E7%82%B9"><span class="toc-number">1.61.</span> <span class="toc-text">缩点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#e-DCC-1"><span class="toc-number">1.61.1.</span> <span class="toc-text">e-DCC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-DCC-1"><span class="toc-number">1.61.2.</span> <span class="toc-text">v-DCC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hierholzer"><span class="toc-number">1.62.</span> <span class="toc-text">Hierholzer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%9B%BE%E5%88%A4%E5%AE%9A"><span class="toc-number">1.62.1.</span> <span class="toc-text">欧拉图判定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E8%B7%AF%E5%AD%98%E5%9C%A8%E6%80%A7%E5%88%A4%E5%AE%9A"><span class="toc-number">1.62.2.</span> <span class="toc-text">欧拉路存在性判定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E5%90%91%E5%9B%BE%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F"><span class="toc-number">1.63.</span> <span class="toc-text">有向图强连通分量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SCC"><span class="toc-number">1.63.1.</span> <span class="toc-text">SCC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F%E5%88%A4%E5%AE%9A%E6%B3%95%E5%88%99"><span class="toc-number">1.63.1.1.</span> <span class="toc-text">强连通分量判定法则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%A9%E7%82%B9-1"><span class="toc-number">1.63.2.</span> <span class="toc-text">缩点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE"><span class="toc-number">1.64.</span> <span class="toc-text">二分图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-%E6%8E%A8%E8%AE%BA"><span class="toc-number">1.64.0.1.</span> <span class="toc-text">性质&amp;推论</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE%E5%88%A4%E5%AE%9A"><span class="toc-number">1.64.1.</span> <span class="toc-text">二分图判定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95"><span class="toc-number">1.64.2.</span> <span class="toc-text">匈牙利算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%93%E8%89%B2"><span class="toc-number">1.64.2.1.</span> <span class="toc-text">染色</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8C%E4%BD%99%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="toc-number">1.65.</span> <span class="toc-text">同余最短路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E5%9B%BE"><span class="toc-number">1.66.</span> <span class="toc-text">建图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E8%BE%B9%E5%BB%BA%E5%9B%BE"><span class="toc-number">1.66.1.</span> <span class="toc-text">按边建图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E6%9F%A5%E9%9B%86"><span class="toc-number">1.67.</span> <span class="toc-text">并查集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E6%9D%83%E5%B9%B6%E6%9F%A5%E9%9B%86"><span class="toc-number">1.67.1.</span> <span class="toc-text">带权并查集</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84"><span class="toc-number">1.68.</span> <span class="toc-text">树状数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84"><span class="toc-number">1.68.1.</span> <span class="toc-text">二维树状数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%86%E5%BA%8F%E5%AF%B9"><span class="toc-number">1.68.2.</span> <span class="toc-text">逆序对</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BA%E9%97%B4%E7%A7%8D%E7%B1%BB%E6%95%B0"><span class="toc-number">1.68.3.</span> <span class="toc-text">区间种类数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%91"><span class="toc-number">1.69.</span> <span class="toc-text">线段树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%912"><span class="toc-number">1.70.</span> <span class="toc-text">线段树2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%91%E4%BC%98%E5%8C%96%E5%BB%BA%E8%BE%B9"><span class="toc-number">1.71.</span> <span class="toc-text">线段树优化建边</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F%E7%BA%BF"><span class="toc-number">1.72.</span> <span class="toc-text">扫描线</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A6%E5%81%8F%E6%A0%91"><span class="toc-number">1.73.</span> <span class="toc-text">左偏树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ST%E8%A1%A8"><span class="toc-number">1.74.</span> <span class="toc-text">ST表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8F%82%E6%9C%B5%E8%8E%89%E6%A0%91"><span class="toc-number">1.75.</span> <span class="toc-text">珂朵莉树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vector%E5%B9%B3%E8%A1%A1%E6%A0%91"><span class="toc-number">1.76.</span> <span class="toc-text">vector平衡树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E6%8C%81%E4%B9%85%E6%95%B0%E7%BB%84"><span class="toc-number">1.77.</span> <span class="toc-text">可持久数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E5%8F%89%E5%A0%86"><span class="toc-number">1.78.</span> <span class="toc-text">二叉堆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E9%A1%B6%E5%A0%86"><span class="toc-number">1.79.</span> <span class="toc-text">对顶堆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Huffman%E6%A0%91"><span class="toc-number">1.80.</span> <span class="toc-text">Huffman树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86"><span class="toc-number">1.81.</span> <span class="toc-text">树链剖分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LCA-1"><span class="toc-number">1.81.1.</span> <span class="toc-text">LCA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%B0%83%E6%A0%88"><span class="toc-number">1.82.</span> <span class="toc-text">单调栈</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%AD%90%E7%9F%A9%E9%98%B5"><span class="toc-number">1.82.1.</span> <span class="toc-text">最大子矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97"><span class="toc-number">1.83.</span> <span class="toc-text">单调队列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3-%E5%8C%BA%E9%97%B4%E6%9C%80%E5%B0%8F"><span class="toc-number">1.83.1.</span> <span class="toc-text">滑动窗口-区间最小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%AD%90%E5%BA%8F%E5%92%8C"><span class="toc-number">1.83.2.</span> <span class="toc-text">最大子序和</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E6%A0%91"><span class="toc-number">1.84.</span> <span class="toc-text">笛卡尔树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%BF%E7%BD%AA%E7%BE%8A%E6%A0%91"><span class="toc-number">1.85.</span> <span class="toc-text">替罪羊树</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E9%87%8D"><span class="toc-number">1.85.1.</span> <span class="toc-text">可重</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pb-ds-tree-%E5%B9%B3%E8%A1%A1%E6%A0%91"><span class="toc-number">1.86.</span> <span class="toc-text">pb_ds tree 平衡树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trie"><span class="toc-number">1.87.</span> <span class="toc-text">Trie</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%D4%96-Hash"><span class="toc-number">1.88.</span> <span class="toc-text">Ԗ-Hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KMP%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="toc-number">1.89.</span> <span class="toc-text">KMP模式匹配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95"><span class="toc-number">1.90.</span> <span class="toc-text">最小表示法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7DP"><span class="toc-number">1.91.</span> <span class="toc-text">线性DP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LIS"><span class="toc-number">1.91.1.</span> <span class="toc-text">LIS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LCS"><span class="toc-number">1.91.2.</span> <span class="toc-text">LCS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E4%B8%89%E8%A7%92%E5%BD%A2"><span class="toc-number">1.91.3.</span> <span class="toc-text">数字三角形</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E5%8C%85"><span class="toc-number">1.92.</span> <span class="toc-text">背包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-1%E8%83%8C%E5%8C%85"><span class="toc-number">1.92.1.</span> <span class="toc-text">0&#x2F;1背包</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E6%95%B0%E7%BB%84"><span class="toc-number">1.92.1.1.</span> <span class="toc-text">滚动数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E7%BB%B4"><span class="toc-number">1.92.1.2.</span> <span class="toc-text">一维</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E5%85%A8%E8%83%8C%E5%8C%85"><span class="toc-number">1.92.2.</span> <span class="toc-text">完全背包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E8%83%8C%E5%8C%85"><span class="toc-number">1.92.3.</span> <span class="toc-text">多重背包</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E6%8B%86%E5%88%86%E6%B3%95"><span class="toc-number">1.92.3.1.</span> <span class="toc-text">直接拆分法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%8B%86%E5%88%86%E6%B3%95"><span class="toc-number">1.92.3.2.</span> <span class="toc-text">二进制拆分法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E8%83%8C%E5%8C%85"><span class="toc-number">1.92.4.</span> <span class="toc-text">分组背包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E8%B4%B9%E7%94%A8%E8%83%8C%E5%8C%85"><span class="toc-number">1.92.5.</span> <span class="toc-text">二维费用背包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E5%81%8F%E5%BA%8F"><span class="toc-number">1.93.</span> <span class="toc-text">二维偏序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GarsiaWachs"><span class="toc-number">1.94.</span> <span class="toc-text">GarsiaWachs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%82%AC%E7%BA%BF%E6%B3%95"><span class="toc-number">1.95.</span> <span class="toc-text">悬线法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%AD%90%E7%9F%A9%E9%98%B5-1"><span class="toc-number">1.95.1.</span> <span class="toc-text">最大子矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9DP"><span class="toc-number">1.96.</span> <span class="toc-text">状态压缩DP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TSP"><span class="toc-number">1.96.1.</span> <span class="toc-text">TSP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%91%8A%E8%BF%98%E5%88%86%E6%9E%90"><span class="toc-number">1.97.</span> <span class="toc-text">摊还分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%88%86%E6%9E%90"><span class="toc-number">1.97.1.</span> <span class="toc-text">聚合分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E7%AE%97%E6%B3%95"><span class="toc-number">1.97.2.</span> <span class="toc-text">核算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%BF%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">1.97.3.</span> <span class="toc-text">势能分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="toc-number">1.98.</span> <span class="toc-text">自动机</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#KMP%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="toc-number">1.98.1.</span> <span class="toc-text">KMP自动机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E5%AE%9A%E7%90%86"><span class="toc-number">1.99.</span> <span class="toc-text">主定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%BD%93-f-n-O-n-c-c"><span class="toc-number">1.99.1.</span> <span class="toc-text">1、当$f(n)&#x3D;O(n^c), \ c&lt;\hat c$时：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%A6%82%EF%BC%9A"><span class="toc-number">1.99.1.1.</span> <span class="toc-text">例如：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%BD%93-exist-k-geq-0-f-n-Theta-left-n-hat-c-log-kn-right-%E6%97%B6%EF%BC%9A"><span class="toc-number">1.99.2.</span> <span class="toc-text">2、当$\exist k\geq 0, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%A6%82%EF%BC%9A-1"><span class="toc-number">1.99.2.1.</span> <span class="toc-text">例如：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%EF%BC%9A"><span class="toc-number">1.99.2.2.</span> <span class="toc-text">扩展：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BD%93-exist-k-1-f-n-Theta-left-n-hat-c-log-kn-right-%E6%97%B6%EF%BC%9A"><span class="toc-number">1.99.2.2.1.</span> <span class="toc-text">当$\exist k&gt;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BD%93-k-1-f-n-Theta-left-n-hat-c-log-kn-right-%E6%97%B6%EF%BC%9A"><span class="toc-number">1.99.2.2.2.</span> <span class="toc-text">当$k&#x3D;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$时：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BD%93-exist-k"><span class="toc-number">1.99.2.2.3.</span> <span class="toc-text">当$\exist k&lt;-1, \ f(n)&#x3D;\Theta\left(n^{\hat c}\log^kn\right)$</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%BD%93-f-n-Omega-left-n-c-right-c-hat-c-%E6%97%B6%EF%BC%9A"><span class="toc-number">1.99.3.</span> <span class="toc-text">3、当$f(n)&#x3D;\Omega\left(n^c\right), \ c&gt;\hat c$时：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%A6%82%EF%BC%9A-2"><span class="toc-number">1.99.3.1.</span> <span class="toc-text">例如：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-number">1.99.4.</span> <span class="toc-text">例题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NOIP2016TGT14"><span class="toc-number">1.99.4.1.</span> <span class="toc-text">NOIP2016TGT14</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NOIP2015TGT10"><span class="toc-number">1.99.4.2.</span> <span class="toc-text">NOIP2015TGT10</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NOIP2013TGT7"><span class="toc-number">1.99.4.3.</span> <span class="toc-text">NOIP2013TGT7</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Markdown"><span class="toc-number">1.100.</span> <span class="toc-text">Markdown</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8"><span class="toc-number">1.100.1.</span> <span class="toc-text">常用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E6%A8%A1%E5%BC%8F%E9%87%8D%E9%9F%B3%E7%AC%A6%E5%8F%B7"><span class="toc-number">1.100.2.</span> <span class="toc-text">数学模式重音符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%8C%E8%85%8A%E5%AD%97%E6%AF%8D"><span class="toc-number">1.100.3.</span> <span class="toc-text">希腊字母</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB%E7%AC%A6"><span class="toc-number">1.100.4.</span> <span class="toc-text">二元关系符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.100.5.</span> <span class="toc-text">二元运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%9C%E5%A4%A7%E2%80%9D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.100.6.</span> <span class="toc-text">“大”运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%AD%E5%A4%B4"><span class="toc-number">1.100.7.</span> <span class="toc-text">箭头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E7%95%8C%E7%AC%A6"><span class="toc-number">1.100.8.</span> <span class="toc-text">定界符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%AE%9A%E7%95%8C%E7%AC%A6"><span class="toc-number">1.100.9.</span> <span class="toc-text">大定界符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%AC%A6%E5%8F%B7"><span class="toc-number">1.100.10.</span> <span class="toc-text">其他符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%95%B0%E5%AD%A6%E7%AC%A6%E5%8F%B7"><span class="toc-number">1.100.11.</span> <span class="toc-text">非数学符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%8C%E8%85%8A%E5%92%8C%E5%B8%8C%E4%BC%AF%E6%9D%A5%E5%AD%97%E6%AF%8D"><span class="toc-number">1.100.12.</span> <span class="toc-text">希腊和希伯来字母</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8D"><span class="toc-number">1.100.13.</span> <span class="toc-text">数字字母</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E5%8E%BB%E7%AC%A6-%E5%88%A0%E9%99%A4%E7%BA%BF"><span class="toc-number">1.100.14.</span> <span class="toc-text">约去符 删除线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5"><span class="toc-number">1.100.15.</span> <span class="toc-text">矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%85%A5%E4%BC%98%E5%8C%96"><span class="toc-number">1.101.</span> <span class="toc-text">读入优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Fread"><span class="toc-number">1.101.1.</span> <span class="toc-text">Fread</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pb-ds"><span class="toc-number">1.102.</span> <span class="toc-text">pb_ds</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hash"><span class="toc-number">1.102.1.</span> <span class="toc-text">hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#heap"><span class="toc-number">1.102.2.</span> <span class="toc-text">heap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rb-tree"><span class="toc-number">1.102.3.</span> <span class="toc-text">rb-tree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trie"><span class="toc-number">1.102.4.</span> <span class="toc-text">trie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pair"><span class="toc-number">1.102.5.</span> <span class="toc-text">pair</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97"><span class="toc-number">1.103.</span> <span class="toc-text">位运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E9%80%80%E7%81%AB"><span class="toc-number">1.104.</span> <span class="toc-text">模拟退火</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%A1%E6%97%B6"><span class="toc-number">1.104.1.</span> <span class="toc-text">卡时</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6"><span class="toc-number">1.105.</span> <span class="toc-text">时间复杂度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E6%8B%8D"><span class="toc-number">1.106.</span> <span class="toc-text">对拍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rand"><span class="toc-number">1.106.1.</span> <span class="toc-text">rand</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shuffle"><span class="toc-number">1.107.</span> <span class="toc-text">shuffle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#int128"><span class="toc-number">1.108.</span> <span class="toc-text">__int128</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#priority-queue"><span class="toc-number">1.109.</span> <span class="toc-text">priority_queue</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/08/Linux%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8-%E6%96%87%E4%BB%B6I-O/" title="Linux编程入门-文件I/O">Linux编程入门-文件I/O</a><time datetime="2025-06-08T00:27:36.000Z" title="发表于 2025-06-08 08:27:36">2025-06-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/02/%E5%9F%BA%E7%A1%80%E5%8A%B3%E5%8A%A8%E6%B3%95%E5%85%A5%E9%97%A8/" title="基础劳动法入门">基础劳动法入门</a><time datetime="2025-06-02T13:12:09.000Z" title="发表于 2025-06-02 21:12:09">2025-06-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/01/C-%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8-FTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8ELibevent%E5%88%9D%E6%8E%A2/" title="C++后端开发入门-FTP服务器与Libevent初探">C++后端开发入门-FTP服务器与Libevent初探</a><time datetime="2025-06-01T02:37:07.000Z" title="发表于 2025-06-01 10:37:07">2025-06-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/31/C-%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8B/" title="C++后端开发入门-HTTP服务器编程">C++后端开发入门-HTTP服务器编程</a><time datetime="2025-05-31T12:36:58.000Z" title="发表于 2025-05-31 20:36:58">2025-05-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/31/C-%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8-%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A8%A1%E5%9E%8B%E7%BC%96%E7%A8%8B/" title="C++后端开发入门-服务器模型编程">C++后端开发入门-服务器模型编程</a><time datetime="2025-05-31T02:14:48.000Z" title="发表于 2025-05-31 10:14:48">2025-05-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Monoceros406</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="docsearch-wrap"><div id="docsearch" style="display:none"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css/dist/style.min.css"/><script src="https://cdn.jsdelivr.net/npm/@docsearch/js/dist/umd/index.min.js"></script><script>(() => {
  docsearch(Object.assign({
    appId: '',
    apiKey: '',
    indexName: '',
    container: '#docsearch',
  }, null))

  const handleClick = () => {
    document.querySelector('.DocSearch-Button').click()
  }

  const searchClickFn = () => {
    btf.addEventListenerPjax(document.querySelector('#search-button > .search'), 'click', handleClick)
  }

  searchClickFn()
  window.addEventListener('pjax:complete', searchClickFn)
})()</script></div></div></body></html>